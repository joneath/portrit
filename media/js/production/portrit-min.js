jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return 1>(b/=e/2)?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return 1>(b/=e/2)?d/2*b*b*b+c:
d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return 1>(b/=e/2)?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return 1>(b/=e/2)?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/
e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return 0==b?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return 0==b?c:b==e?c+d:1>(b/=e/2)?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*
b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return 1>(b/=e/2)?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var a=1.70158,f=0,g=d;if(0==b)return c;if(1==(b/=e))return c+d;f||(f=0.3*e);g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g);return-(g*Math.pow(2,10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f))+c},easeOutElastic:function(a,b,c,d,e){var a=1.70158,f=0,g=d;if(0==b)return c;if(1==
(b/=e))return c+d;f||(f=0.3*e);g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*b)*Math.sin((b*e-a)*2*Math.PI/f)+d+c},easeInOutElastic:function(a,b,c,d,e){var a=1.70158,f=0,g=d;if(0==b)return c;if(2==(b/=e/2))return c+d;f||(f=e*0.3*1.5);g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g);return 1>b?-0.5*g*Math.pow(2,10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f)+c:0.5*g*Math.pow(2,-10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f)+d+c},easeInBack:function(a,b,c,d,e,f){void 0==
f&&(f=1.70158);return d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){void 0==f&&(f=1.70158);return d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){void 0==f&&(f=1.70158);return 1>(b/=e/2)?d/2*b*b*(((f*=1.525)+1)*b-f)+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+0.75)+c:b<2.5/2.75?
d*(7.5625*(b-=2.25/2.75)*b+0.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+0.984375)+c},easeInOutBounce:function(a,b,c,d,e){return b<e/2?0.5*jQuery.easing.easeInBounce(a,2*b,0,d,e)+c:0.5*jQuery.easing.easeOutBounce(a,2*b-e,0,d,e)+0.5*d+c}});
(function(a){function b(a,c,b){c="("+b.replace(d,"\\$1")+")";return a.replace(RegExp(c,"gi"),"<strong>$1</strong>")}function c(c,d){this.el=a(c);this.el.attr("autocomplete","off");this.suggestions=[];this.data=[];this.badQueries=[];this.selectedIndex=-1;this.currentValue=this.el.val();this.intervalId=0;this.cachedResponse=[];this.onChangeInterval=null;this.ignoreValueChange=!1;this.serviceUrl=d.serviceUrl;this.isLocal=!1;this.options={autoSubmit:!1,minChars:1,maxHeight:300,deferRequestBy:0,width:0,
highlight:!0,params:{},fnFormatResult:b,delimiter:null,mobile:!1,zIndex:9999};this.initialize();this.setOptions(d)}var d=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");a.fn.autocomplete=function(b){return new c(this.get(0)||a("<input />"),b)};c.prototype={killerFn:null,initialize:function(){var c,b,d;c=this;b=Math.floor(1048576*Math.random()).toString(16);d="Autocomplete_"+b;this.killerFn=function(b){0===a(b.target).parents(".autocomplete").size()&&(c.killSuggestions(),c.disableKillerFn())};
if(!this.options.width)this.options.width=this.el.width();this.mainContainerId="AutocompleteContainter_"+b;a('<div id="'+this.mainContainerId+'" style="position:absolute;z-index:9999;"><div class="autocomplete-w1"><div class="autocomplete" id="'+d+'" style="display:none; width:300px;"></div></div></div>').appendTo("body");this.container=a("#"+d);this.fixPosition();window.opera?this.el.keypress(function(a){c.onKeyPress(a)}):this.el.keydown(function(a){c.onKeyPress(a)});this.el.keyup(function(a){c.onKeyUp(a)});
this.el.blur(function(){c.enableKillerFn()});this.el.focus(function(){c.fixPosition()})},setOptions:function(c){var b=this.options;a.extend(b,c);if(b.lookup&&(this.isLocal=!0,a.isArray(b.lookup)))b.lookup={suggestions:b.lookup,data:[]};a("#"+this.mainContainerId).css({zIndex:b.zIndex});this.container.css({maxHeight:b.maxHeight+"px",width:b.width})},clearCache:function(){this.cachedResponse=[];this.badQueries=[]},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1},fixPosition:function(){var c=
this.el.offset();if(mobile)b=this.el.parent().position().top+this.el.height()+60,c=c.left-10;else var b=this.el.parent().position().top+this.el.height()+87,c=c.left-14;a("#"+this.mainContainerId).css({top:b+this.el.innerHeight()+"px",left:c+"px"})},enableKillerFn:function(){a(document).bind("click",this.killerFn)},disableKillerFn:function(){a(document).unbind("click",this.killerFn)},killSuggestions:function(){var a=this;this.stopKillSuggestions();this.intervalId=window.setInterval(function(){a.hide();
a.stopKillSuggestions()},300)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},onKeyPress:function(a){if(!this.disabled&&this.enabled){switch(a.keyCode){case 27:this.el.val(this.currentValue);this.hide();break;case 9:case 13:if(-1===this.selectedIndex){this.hide();return}this.select(this.selectedIndex);if(9===a.keyCode)return;break;case 38:this.moveUp();break;case 40:this.moveDown();break;default:return}a.stopImmediatePropagation();a.preventDefault()}},onKeyUp:function(a){if(!this.disabled){switch(a.keyCode){case 38:case 40:return}clearInterval(this.onChangeInterval);
if(this.currentValue!==this.el.val())if(0<this.options.deferRequestBy){var c=this;this.onChangeInterval=setInterval(function(){c.onValueChange()},this.options.deferRequestBy)}else this.onValueChange()}},onValueChange:function(){clearInterval(this.onChangeInterval);this.currentValue=this.el.val();var a=this.getQuery(this.currentValue);this.selectedIndex=-1;this.ignoreValueChange?this.ignoreValueChange=!1:""===a||a.length<this.options.minChars?this.hide():this.getSuggestions(a)},getQuery:function(c){var b;
b=this.options.delimiter;if(!b)return a.trim(c);c=c.split(b);return a.trim(c[c.length-1])},getSuggestionsLocal:function(a){var c,b,d,j,k;b=this.options.lookup;d=b.suggestions.length;c={suggestions:[],data:[]};a=a.toLowerCase();for(k=0;k<d;k++)j=b.suggestions[k],0===j.toLowerCase().indexOf(a)&&(c.suggestions.push(j),c.data.push(b.data[k]));return c},getSuggestions:function(c){var b,d;if((b=this.isLocal?this.getSuggestionsLocal(c):this.cachedResponse[c])&&a.isArray(b.suggestions))this.suggestions=b.suggestions,
this.data=b.data,this.suggest();else if(!this.isBadQuery(c))d=this,d.options.params.query=c,a.get(this.serviceUrl,d.options.params,function(a){d.processResponse(a)},"text")},isBadQuery:function(a){for(var c=this.badQueries.length;c--;)if(0===a.indexOf(this.badQueries[c]))return!0;return!1},hide:function(){this.enabled=!1;this.selectedIndex=-1;this.container.hide()},suggest:function(){if(0===this.suggestions.length)this.hide();else{var c,b,d,h,j,k,i,o;c=this;b=this.suggestions.length;h=this.options.fnFormatResult;
j=this.getQuery(this.currentValue);i=function(a){return function(){c.activate(a)}};o=function(a){return function(){c.select(a)}};this.container.hide().empty();for(k=0;k<b;k++)d=this.suggestions[k],d=a((c.selectedIndex===k?'<div class="selected"':"<div")+' title="'+d+'">'+h(d,this.data[k],j)+"</div>"),d.mouseover(i(k)),d.click(o(k)),this.container.append(d);this.enabled=!0;this.container.show()}},processResponse:function(c){var b;try{b=eval("("+c+")")}catch(d){return}if(!a.isArray(b.data))b.data=[];
this.options.noCache||(this.cachedResponse[b.query]=b,0===b.suggestions.length&&this.badQueries.push(b.query));if(b.query===this.getQuery(this.currentValue))this.suggestions=b.suggestions,this.data=b.data,this.suggest()},activate:function(c){var b,d;b=this.container.children();-1!==this.selectedIndex&&b.length>this.selectedIndex&&a(b.get(this.selectedIndex)).removeClass();this.selectedIndex=c;-1!==this.selectedIndex&&b.length>this.selectedIndex&&(d=b.get(this.selectedIndex),a(d).addClass("selected"));
return d},deactivate:function(a,c){a.className="";if(this.selectedIndex===c)this.selectedIndex=-1},select:function(a){var c;if(c=this.suggestions[a])this.el.val(c),this.options.autoSubmit&&(c=this.el.parents("form"),0<c.length&&c.get(0).submit()),this.ignoreValueChange=!0,this.hide(),this.onSelect(a)},moveUp:function(){if(-1!==this.selectedIndex)0===this.selectedIndex?(this.container.children().get(0).className="",this.selectedIndex=-1,this.el.val(this.currentValue)):this.adjustScroll(this.selectedIndex-
1)},moveDown:function(){this.selectedIndex!==this.suggestions.length-1&&this.adjustScroll(this.selectedIndex+1)},adjustScroll:function(a){var c,b,d;c=this.activate(a).offsetTop;b=this.container.scrollTop();d=b+this.options.maxHeight-25;c<b?this.container.scrollTop(c):c>d&&this.container.scrollTop(c-this.options.maxHeight+25);this.el.val(this.getValue(this.suggestions[a]))},onSelect:function(c){var b,d;b=this.options.onSelect;d=this.suggestions[c];c=this.data[c];this.el.val(this.getValue(d));a.isFunction(b)&&
b(d,c,this.el)},getValue:function(a){var c,b;c=this.options.delimiter;if(!c)return a;b=this.currentValue;c=b.split(c);return 1===c.length?a:b.substr(0,b.length-c[c.length-1].length)+a}}})(jQuery);
(function(){function a(a,h){var j;this.wrapper="object"==typeof a?a:document.getElementById(a);this.wrapper.style.overflow="hidden";this.scroller=this.wrapper.children[0];this.scroller.style.cssText+="-webkit-transition-property:-webkit-transform;-webkit-transform-origin:0 0;-webkit-transform:"+i+"0,0"+o;this.scroller.style.cssText+="-webkit-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-webkit-transition-duration:0;";this.options={hScroll:!0,vScroll:!0,bounce:b,bounceLock:!1,momentum:b,
lockDirection:!0,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:e,fadeScrollbar:d&&b||!c,hideScrollbar:d||!c,scrollbarClass:"",onScrollStart:null,onScrollEnd:null};for(j in h)this.options[j]=h[j];this.options.hScrollbar=this.options.hScroll&&this.options.hScrollbar;this.options.vScrollbar=this.options.vScroll&&this.options.vScrollbar;this.refresh();this._bind(f,window);this._bind(g)}a.prototype={x:0,y:0,handleEvent:function(a){switch(a.type){case g:this._start(a);break;case h:this._move(a);break;case j:case k:this._end(a);
break;case "webkitTransitionEnd":this._transitionEnd(a);break;case f:this._resize()}},_scrollbar:function(a){var c=document,b;if(this[a+"Scrollbar"]){if(!this[a+"ScrollbarWrapper"]){b=c.createElement("div");this.options.scrollbarClass?b.className=this.options.scrollbarClass+a.toUpperCase():b.style.cssText="position:absolute;z-index:100;"+("h"==a?"height:7px;bottom:1px;left:2px;right:7px":"width:7px;bottom:7px;top:2px;right:1px");b.style.cssText+="pointer-events:none;-webkit-transition-property:opacity;-webkit-transition-duration:"+
(this.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(this.options.hideScrollbar?"0":"1");this.wrapper.appendChild(b);this[a+"ScrollbarWrapper"]=b;b=c.createElement("div");if(!this.options.scrollbarClass)b.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-webkit-background-clip:padding-box;-webkit-box-sizing:border-box;"+("h"==a?"height:100%;-webkit-border-radius:4px 3px;":"width:100%;-webkit-border-radius:3px 4px;");b.style.cssText+=
"pointer-events:none;-webkit-transition-property:-webkit-transform;-webkit-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-webkit-transition-duration:0;-webkit-transform:"+i+"0,0"+o;this[a+"ScrollbarWrapper"].appendChild(b);this[a+"ScrollbarIndicator"]=b}"h"==a?(this.hScrollbarSize=this.hScrollbarWrapper.clientWidth,this.hScrollbarIndicatorSize=m.max(m.round(this.hScrollbarSize*this.hScrollbarSize/this.scrollerW),8),this.hScrollbarIndicator.style.width=this.hScrollbarIndicatorSize+"px",
this.hScrollbarMaxScroll=this.hScrollbarSize-this.hScrollbarIndicatorSize,this.hScrollbarProp=this.hScrollbarMaxScroll/this.maxScrollX):(this.vScrollbarSize=this.vScrollbarWrapper.clientHeight,this.vScrollbarIndicatorSize=m.max(m.round(this.vScrollbarSize*this.vScrollbarSize/this.scrollerH),8),this.vScrollbarIndicator.style.height=this.vScrollbarIndicatorSize+"px",this.vScrollbarMaxScroll=this.vScrollbarSize-this.vScrollbarIndicatorSize,this.vScrollbarProp=this.vScrollbarMaxScroll/this.maxScrollY);
this._indicatorPos(a,!0)}else if(this[a+"ScrollbarWrapper"])this[a+"ScrollbarIndicator"].style.webkitTransform="",this[a+"ScrollbarWrapper"].parentNode.removeChild(this[a+"ScrollbarWrapper"]),this[a+"ScrollbarWrapper"]=null,this[a+"ScrollbarIndicator"]=null},_resize:function(){var a=this;setTimeout(function(){a.refresh()},0)},_pos:function(a,c){this.x=this.hScroll?a:0;this.y=this.vScroll?c:0;this.scroller.style.webkitTransform=i+this.x+"px,"+this.y+"px"+o;this._indicatorPos("h");this._indicatorPos("v")},
_indicatorPos:function(a,c){var b="h"==a?this.x:this.y;if(this[a+"Scrollbar"])b*=this[a+"ScrollbarProp"],0>b?(b=this.options.fixedScrollbar?0:b+3*b,9>this[a+"ScrollbarIndicatorSize"]+b&&(b=-this[a+"ScrollbarIndicatorSize"]+8)):b>this[a+"ScrollbarMaxScroll"]&&(b=this.options.fixedScrollbar?this[a+"ScrollbarMaxScroll"]:b+3*(b-this[a+"ScrollbarMaxScroll"]),9>this[a+"ScrollbarIndicatorSize"]+this[a+"ScrollbarMaxScroll"]-b&&(b=this[a+"ScrollbarIndicatorSize"]+this[a+"ScrollbarMaxScroll"]-8)),this[a+"ScrollbarWrapper"].style.webkitTransitionDelay=
"0",this[a+"ScrollbarWrapper"].style.opacity=c&&this.options.hideScrollbar?"0":"1",this[a+"ScrollbarIndicator"].style.webkitTransform=i+("h"==a?b+"px,0":"0,"+b+"px")+o},_transitionTime:function(a){a+="ms";this.scroller.style.webkitTransitionDuration=a;if(this.hScrollbar)this.hScrollbarIndicator.style.webkitTransitionDuration=a;if(this.vScrollbar)this.vScrollbarIndicator.style.webkitTransitionDuration=a},_start:function(a){var b=c?a.changedTouches[0]:a,d;this.moved=!1;a.preventDefault();this.moved=
!1;this.returnTime=this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;this._transitionTime(0);if(this.options.momentum&&(d=new WebKitCSSMatrix(window.getComputedStyle(this.scroller,null).webkitTransform),d.m41!=this.x||d.m42!=this.y))this._unbind("webkitTransitionEnd"),this._pos(d.m41,d.m42);this.scroller.style.webkitTransitionTimingFunction="cubic-bezier(0.33,0.66,0.66,1)";if(this.hScrollbar)this.hScrollbarIndicator.style.webkitTransitionTimingFunction="cubic-bezier(0.33,0.66,0.66,1)";
if(this.vScrollbar)this.vScrollbarIndicator.style.webkitTransitionTimingFunction="cubic-bezier(0.33,0.66,0.66,1)";this.startX=this.x;this.startY=this.y;this.pointX=b.pageX;this.pointY=b.pageY;this.startTime=a.timeStamp;this.options.onScrollStart&&this.options.onScrollStart.call(this);this._bind(h);this._bind(j);this._bind(k)},_move:function(a){if(!(c&&1<a.touches.length)){var b=c?a.changedTouches[0]:a,d=b.pageX-this.pointX,e=b.pageY-this.pointY,f=this.x+d,g=this.y+e;a.preventDefault();this.pointX=
b.pageX;this.pointY=b.pageY;if(0<f||f<this.maxScrollX)f=this.options.bounce?this.x+d/2.4:0<=f||0<=this.maxScrollX?0:this.maxScrollX;if(0<g||g<this.maxScrollY)g=this.options.bounce?this.y+e/2.4:0<=g||0<=this.maxScrollY?0:this.maxScrollY;if(4>this.absDistX&&4>this.absDistY)this.distX+=d,this.distY+=e,this.absDistX=m.abs(this.distX),this.absDistY=m.abs(this.distY);else{if(this.options.lockDirection)if(this.absDistX>this.absDistY+3)g=this.y,e=0;else if(this.absDistY>this.absDistX+3)f=this.x,d=0;this.moved=
!0;this._pos(f,g);this.dirX=0<d?-1:0>d?1:0;this.dirY=0<e?-1:0>e?1:0;if(300<a.timeStamp-this.startTime)this.startTime=a.timeStamp,this.startX=this.x,this.startY=this.y}}},_end:function(a){if(!(c&&0!=a.touches.length)){var b=c?a.changedTouches[0]:a,d,e,f={dist:0,time:0},g={dist:0,time:0},i=a.timeStamp-this.startTime;d=this.x;e=this.y;this._unbind(h);this._unbind(j);this._unbind(k);if(this.moved){if(300>i&&this.options.momentum){f=d?this._momentum(d-this.startX,i,-this.x,this.scrollerW-this.wrapperW+
this.x,this.options.bounce?this.wrapperW:0):f;g=e?this._momentum(e-this.startY,i,-this.y,0>this.maxScrollY?this.scrollerH-this.wrapperH+this.y:0,this.options.bounce?this.wrapperH:0):g;d=this.x+f.dist;e=this.y+g.dist;if(0<this.x&&0<d||this.x<this.maxScrollX&&d<this.maxScrollX)f={dist:0,time:0};if(0<this.y&&0<e||this.y<this.maxScrollY&&e<this.maxScrollY)g={dist:0,time:0}}f.dist||g.dist?(a=m.max(m.max(f.time,g.time),10),this.scrollTo(d,e,a)):this._resetPos(200)}else{if(c){this.doubleTapTimer=null;for(d=
b.target;1!=d.nodeType;)d=d.parentNode;e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,a.view,1,b.screenX,b.screenY,b.clientX,b.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null);e._fake=!0;d.dispatchEvent(e)}this._resetPos()}}},_resetPos:function(a){var c=this.x,b=this.y;if(0<=this.x)c=0;else if(this.x<this.maxScrollX)c=this.maxScrollX;if(0<=this.y||0<this.maxScrollY)b=0;else if(this.y<this.maxScrollY)b=this.maxScrollY;if(c==this.x&&b==this.y){if(this.moved)this.options.onScrollEnd&&
this.options.onScrollEnd.call(this),this.moved=!1;if(this.hScrollbar&&this.options.hideScrollbar)this.hScrollbarWrapper.style.webkitTransitionDelay="300ms",this.hScrollbarWrapper.style.opacity="0";if(this.vScrollbar&&this.options.hideScrollbar)this.vScrollbarWrapper.style.webkitTransitionDelay="300ms",this.vScrollbarWrapper.style.opacity="0"}else{if(a){this.scroller.style.webkitTransitionTimingFunction="cubic-bezier(0.33,0.0,0.33,1)";if(this.hScrollbar)this.hScrollbarIndicator.style.webkitTransitionTimingFunction=
"cubic-bezier(0.33,0.0,0.33,1)";if(this.vScrollbar)this.vScrollbarIndicator.style.webkitTransitionTimingFunction="cubic-bezier(0.33,0.0,0.33,1)"}this.scrollTo(c,b,a||0)}},_transitionEnd:function(a){a&&a.stopPropagation();this._unbind("webkitTransitionEnd");this._resetPos(this.returnTime);this.returnTime=0},_momentum:function(a,c,b,d,e){var c=m.abs(a)/c,f=c*c/0.0012,g=0,g=0;if(0<a&&f>b)g=e/(6/(6.0E-4*(f/c))),b+=g,this.returnTime=800/e*g+100,c=c*b/f,f=b;else if(0>a&&f>d)g=e/(6/(6.0E-4*(f/c))),d+=g,
this.returnTime=800/e*g+100,c=c*d/f,f=d;return{dist:f*(0>a?-1:1),time:m.round(c/6.0E-4)}},_offset:function(a,c){var b=-a.offsetLeft,d=-a.offsetTop;if(!c)return{x:b,y:d};for(;a=a.offsetParent;)b-=a.offsetLeft,d-=a.offsetTop;return{x:b,y:d}},_bind:function(a,c){(c||this.scroller).addEventListener(a,this,!1)},_unbind:function(a,c){(c||this.scroller).removeEventListener(a,this,!1)},destroy:function(){this.vScrollbar=this.hScrollbar=!1;this._scrollbar("h");this._scrollbar("v");this.scroller.style.webkitTransform=
"";this._unbind("webkitTransitionEnd");this._unbind(f);this._unbind(g);this._unbind(h);this._unbind(j);this._unbind(k)},refresh:function(){this.wrapperW=this.wrapper.clientWidth;this.wrapperH=this.wrapper.clientHeight;this.scrollerW=this.scroller.offsetWidth;this.scrollerH=this.scroller.offsetHeight;this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH;this.dirY=this.dirX=0;this._transitionTime(0);this.hScroll=this.options.hScroll&&0>this.maxScrollX;this.vScroll=
this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);this.hScrollbar=this.hScroll&&this.options.hScrollbar;this.vScrollbar=this.vScroll&&this.options.vScrollbar&&this.scrollerH>this.wrapperH;this._scrollbar("h");this._scrollbar("v");this._resetPos()},scrollTo:function(a,c,b,d){var e=this;d&&(a=e.x-a,c=e.y-c);b=!b||m.round(e.x)==m.round(a)&&m.round(e.y)==m.round(c)?0:b;e.moved=!0;b&&e._bind("webkitTransitionEnd");e._transitionTime(b);e._pos(a,c);b||setTimeout(function(){e._transitionEnd()},
0)},scrollToElement:function(a,c){var b;if(a=a.nodeType?a:this.scroller.querySelector(a))b=this._offset(a),b.x=0<b.x?0:b.x<this.maxScrollX?this.maxScrollX:b.x,b.y=0<b.y?0:b.y<this.maxScrollY?this.maxScrollY:b.y,c=void 0===c?m.max(2*m.abs(b.x),2*m.abs(b.y)):c,this.scrollTo(b.x,b.y,c)}};var b="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,c="ontouchstart"in window,d=/iphone|ipad/gi.test(navigator.appVersion),e=/android/gi.test(navigator.appVersion),f="onorientationchange"in window?"orientationchange":
"resize",g=c?"touchstart":"mousedown",h=c?"touchmove":"mousemove",j=c?"touchend":"mouseup",k=c?"touchcancel":"mouseup",i="translate"+(b?"3d(":"("),o=b?",0)":")",m=Math;"undefined"!==typeof exports?exports.iScroll=a:window.iScroll=a})();
var isIphone=!1,isTierIphone=!1,isTierRichCss=!1,isTierGenericMobile=!1,engineWebKit="webkit",deviceAndroid="android",deviceIphone="iphone",deviceIpod="ipod",deviceIpad="ipad",deviceMacPpc="macintosh",deviceNuvifone="nuvifone",deviceSymbian="symbian",deviceS60="series60",deviceS70="series70",deviceS80="series80",deviceS90="series90",deviceWinMob="windows ce",deviceWindows="windows",deviceIeMob="iemobile",devicePpc="ppc",enginePie="wm5 pie",deviceBB="blackberry",vndRIM="vnd.rim",deviceBBStorm="blackberry95",
deviceBBBold="blackberry97",deviceBBTour="blackberry96",deviceBBCurve="blackberry89",devicePalm="palm",deviceWebOS="webos",engineBlazer="blazer",engineXiino="xiino",deviceKindle="kindle",vndwap="vnd.wap",wml="wml",deviceBrew="brew",deviceDanger="danger",deviceHiptop="hiptop",devicePlaystation="playstation",deviceNintendoDs="nitro",deviceNintendo="nintendo",deviceWii="wii",deviceXbox="xbox",deviceArchos="archos",engineOpera="opera",engineNetfront="netfront",engineUpBrowser="up.browser",engineOpenWeb=
"openweb",deviceMidp="midp",uplink="up.link",engineTelecaQ="teleca q",devicePda="pda",mini="mini",mobile="mobile",mobi="mobi",maemo="maemo",maemoTablet="tablet",linux="linux",qtembedded="qt embedded",mylocom2="com2",manuSonyEricsson="sonyericsson",manuericsson="ericsson",manuSamsung1="sec-sgh",manuSony="sony",manuHtc="htc",svcDocomo="docomo",svcKddi="kddi",svcVodafone="vodafone",uagent=navigator.userAgent.toLowerCase();
function DetectIphone(){return-1<uagent.search(deviceIphone)?DetectIpad()||DetectIpod()?!1:!0:!1}function DetectIpod(){return-1<uagent.search(deviceIpod)?!0:!1}function DetectIpad(){return-1<uagent.search(deviceIpad)&&DetectWebkit()?!0:!1}function DetectIphoneOrIpod(){return-1<uagent.search(deviceIphone)||-1<uagent.search(deviceIpod)?!0:!1}function DetectAndroid(){return-1<uagent.search(deviceAndroid)?!0:!1}function DetectAndroidWebKit(){return DetectAndroid()&&DetectWebkit()?!0:!1}
function DetectWebkit(){return-1<uagent.search(engineWebKit)?!0:!1}function DetectS60OssBrowser(){return DetectWebkit()?-1<uagent.search(deviceS60)||-1<uagent.search(deviceSymbian)?!0:!1:!1}function DetectSymbianOS(){return-1<uagent.search(deviceSymbian)||-1<uagent.search(deviceS60)||-1<uagent.search(deviceS70)||-1<uagent.search(deviceS80)||-1<uagent.search(deviceS90)?!0:!1}
function DetectWindowsMobile(){return-1<uagent.search(deviceWinMob)||-1<uagent.search(deviceIeMob)||-1<uagent.search(enginePie)?!0:-1<uagent.search(devicePpc)&&!(-1<uagent.search(deviceMacPpc))?!0:-1<uagent.search(manuHtc)&&-1<uagent.search(deviceWindows)?!0:!1}function DetectBlackBerry(){return-1<uagent.search(deviceBB)?!0:-1<uagent.search(vndRIM)?!0:!1}function DetectBlackBerryTouch(){return-1<uagent.search(deviceBBStorm)?!0:!1}
function DetectBlackBerryHigh(){return DetectBlackBerry()?DetectBlackBerryTouch()||-1<uagent.search(deviceBBBold)||-1<uagent.search(deviceBBTour)||-1<uagent.search(deviceBBCurve)?!0:!1:!1}function DetectBlackBerryLow(){return DetectBlackBerry()?DetectBlackBerryHigh()?!1:!0:!1}function DetectPalmOS(){return-1<uagent.search(devicePalm)||-1<uagent.search(engineBlazer)||-1<uagent.search(engineXiino)?DetectPalmWebOS()?!1:!0:!1}function DetectPalmWebOS(){return-1<uagent.search(deviceWebOS)?!0:!1}
function DetectGarminNuvifone(){return-1<uagent.search(deviceNuvifone)?!0:!1}function DetectSmartphone(){return DetectIphoneOrIpod()?!0:DetectS60OssBrowser()?!0:DetectSymbianOS()?!0:DetectWindowsMobile()?!0:DetectAndroid()?!0:DetectBlackBerry()?!0:DetectPalmWebOS()?!0:DetectPalmOS()?!0:DetectGarminNuvifone()?!0:!1}function DetectArchos(){return-1<uagent.search(deviceArchos)?!0:!1}function DetectBrewDevice(){return-1<uagent.search(deviceBrew)?!0:!1}
function DetectDangerHiptop(){return-1<uagent.search(deviceDanger)||-1<uagent.search(deviceHiptop)?!0:!1}function DetectMaemoTablet(){return-1<uagent.search(maemo)?!0:-1<uagent.search(maemoTablet)&&uagent.search(linux)?!0:!1}function DetectSonyMylo(){return-1<uagent.search(manuSony)?-1<uagent.search(qtembedded)||-1<uagent.search(mylocom2)?!0:!1:!1}function DetectOperaMobile(){return-1<uagent.search(engineOpera)?-1<uagent.search(mini)||-1<uagent.search(mobi)?!0:!1:!1}
function DetectSonyPlaystation(){return uagent.search(devicePlaystation)?!0:!1}function DetectNintendo(){return-1<uagent.search(deviceNintendo)||-1<uagent.search(deviceWii)||-1<uagent.search(deviceNintendoDs)?!0:!1}function DetectXbox(){return uagent.search(deviceXbox)?!0:!1}function DetectGameConsole(){return DetectSonyPlaystation()?!0:DetectNintendo()?!0:DetectXbox()?!0:!1}function DetectKindle(){return-1<uagent.search(deviceKindle)?!0:!1}
function DetectMobileQuick(){return DetectIpad()?!1:DetectSmartphone()?!0:-1<uagent.search(deviceMidp)||DetectBrewDevice()?!0:DetectOperaMobile()?!0:-1<uagent.search(engineNetfront)?!0:-1<uagent.search(engineUpBrowser)?!0:-1<uagent.search(engineOpenWeb)?!0:DetectDangerHiptop()?!0:DetectMaemoTablet()?!0:DetectArchos()?!0:-1<uagent.search(devicePda)?!0:-1<uagent.search(mobile)?!0:DetectKindle()?!0:!1}
function DetectMobileLong(){return DetectMobileQuick()?!0:DetectGameConsole()?!0:DetectSonyMylo()?!0:-1<uagent.search(manuSamsung1)||-1<uagent.search(manuSonyEricsson)||-1<uagent.search(manuericsson)?!0:-1<uagent.search(svcDocomo)?!0:-1<uagent.search(svcKddi)?!0:-1<uagent.search(svcVodafone)?!0:!1}function DetectTierIphone(){return DetectIphoneOrIpod()?!0:DetectAndroid()?!0:DetectAndroidWebKit()?!0:DetectPalmWebOS()?!0:DetectGarminNuvifone()?!0:DetectMaemoTablet()?!0:!1}
function DetectTierRichCss(){return DetectMobileQuick()?DetectTierIphone()?!1:DetectWebkit()?!0:DetectS60OssBrowser()?!0:DetectBlackBerryHigh()?!0:DetectWindowsMobile()?!0:-1<uagent.search(engineTelecaQ)?!0:!1:!1}function DetectTierOtherPhones(){return DetectMobileLong()?DetectTierIphone()?!1:DetectTierRichCss()?!1:!0:!1}
(function(a){var b,c;b=function(c){var b=this,f=c.is("form")?c:c.find("form").first(),g=f.find("input:file").first(),h={namespace:"file_upload",cssClass:"file_upload",dragDropSupport:!0,dropZone:c,url:f.attr("action"),method:f.attr("method"),fieldName:g.attr("name"),multipart:!0,multiFileRequest:!1,formData:function(){return f.serializeArray()},withCredentials:!1,forceIframeUpload:!1},j={},k={},i={},o=/^http(s)?:\/\//,m=function(a,c){var b=0;this.complete=function(){b+=1;b===c&&a()}},l=function(){return"undefined"!==
typeof XMLHttpRequest&&"undefined"!==typeof File&&(!h.multipart||"undefined"!==typeof FormData||"undefined"!==typeof FileReader)},n=function(){a.each(j,function(c,b){a(document).unbind(c,b)});a.each(k,function(a,c){h.dropZone.unbind(a,c)});a.each(i,function(a,c){g.unbind(a,c)})},p=function(a,c,b,d){if("function"===typeof d.onProgress)b.upload.onprogress=function(e){d.onProgress(e,a,c,b,d)};if("function"===typeof d.onLoad)b.onload=function(e){d.onLoad(e,a,c,b,d)};if("function"===typeof d.onAbort)b.onabort=
function(e){d.onAbort(e,a,c,b,d)};if("function"===typeof d.onError)b.onerror=function(e){d.onError(e,a,c,b,d)}},q=function(c){if("function"===typeof c.formData)return c.formData();if(a.isArray(c.formData))return c.formData;if(c.formData){var b=[];a.each(c.formData,function(a,c){b.push({name:a,value:c})});return b}return[]},r=function(c,b,d){var e=new FormData,f;a.each(q(d),function(a,c){e.append(c.name,c.value)});for(f=0;f<c.length;f+=1)e.append(d.fieldName,c[f]);b.send(e)},s=function(a,c){var b=
new FileReader;b.onload=function(b){a.content=b.target.result;c()};b.readAsBinaryString(a)},u=function(c,b,d){var e="";a.each(d,function(a,b){e+="--"+c+'\r\nContent-Disposition: form-data; name="'+unescape(encodeURIComponent(b.name))+'"\r\n\r\n'+unescape(encodeURIComponent(b.value))+"\r\n"});a.each(b,function(a,b){e+="--"+c+'\r\nContent-Disposition: form-data; name="'+unescape(encodeURIComponent(h.fieldName))+'"; filename="'+unescape(encodeURIComponent(b.name))+'"\r\nContent-Type: '+b.type+"\r\n\r\n"+
b.content+"\r\n"});return e+="--"+c+"--\r\n"},t=function(a,c,b){var d="----MultiPartFormBoundary"+(new Date).getTime(),e,f;c.setRequestHeader("Content-Type","multipart/form-data; boundary="+d);e=new m(function(){c.sendAsBinary(u(d,a,q(b)))},a.length);for(f=0;f<a.length;f+=1)s(a[f],e.complete)},v=function(c,b,d,e){var f;f=e.url;if(o.test(f)){var g=location.host,h=location.protocol.length+2,j=f.indexOf(g,h),g=j+g.length;f=(j===h||j===f.indexOf("@",h)+1)&&(f.length===g||-1!==a.inArray(f.charAt(g),["/",
"?","#"]))?!0:!1}else f=!0;p(c,b,d,e);d.open(e.method,e.url,!0);if(f)d.setRequestHeader("X-Requested-With","XMLHttpRequest");else if(e.withCredentials)d.withCredentials=!0;e.multipart?(c="number"===typeof b?[c[b]]:c,"undefined"!==typeof FormData?r(c,d,e):"undefined"!==typeof FileReader?t(c,d,e):a.error("Browser does neither support FormData nor FileReader interface")):(e=c[b],f&&d.setRequestHeader("X-File-Name",unescape(encodeURIComponent(e.name))),d.setRequestHeader("Content-Type",e.type),d.send(e))},
w=function(c,b,d){var e=new XMLHttpRequest,f=a.extend({},h);"function"===typeof h.initUpload?h.initUpload(c,b,d,e,f,function(){v(b,d,e,f)}):v(b,d,e,f)},x=function(a,c){var b;if(h.multiFileRequest)w(a,c);else for(b=0;b<c.length;b+=1)w(a,c,b)},z=function(c,b){var d=q(b);f.find(":input").not(":disabled").attr("disabled",!0).addClass(b.namespace+"_disabled");a.each(d,function(c,d){a('<input type="hidden"/>').attr("name",d.name).val(d.value).addClass(b.namespace+"_form_data").insertBefore(g)});c.insertAfter(g)},
A=function(a,c){a.remove();f.find("."+c.namespace+"_disabled").removeAttr("disabled").removeClass(c.namespace+"_disabled");f.find("."+c.namespace+"_form_data").remove()},y=function(a,c,b){c.unbind("abort").bind("abort",function(d){c.readyState=0;c.unbind("load").attr("src","javascript".concat(":false;"));if("function"===typeof b.onAbort)b.onAbort(d,[{name:a.val(),type:null,size:null}],0,c,b)}).unbind("load").bind("load",function(d){c.readyState=4;if("function"===typeof b.onLoad)b.onLoad(d,[{name:a.val(),
type:null,size:null}],0,c,b)});f.attr("action",b.url).attr("target",c.attr("name"));z(a,b);c.readyState=2;f.get(0).submit();A(a,b)},B=function(c,b){var d=a('<iframe src="javascript:false;" style="display:none" name="iframe_'+h.namespace+"_"+(new Date).getTime()+'"></iframe>'),e=a.extend({},h);d.readyState=0;d.abort=function(){d.trigger("abort")};d.bind("load",function(){d.unbind("load");"function"===typeof h.initUpload?h.initUpload(c,[{name:b.val(),type:null,size:null}],0,d,e,function(){y(b,d,e)}):
y(b,d,e)}).appendTo(f)};this.onDocumentDragOver=function(a){if("function"===typeof h.onDocumentDragOver&&!1===h.onDocumentDragOver(a))return!1;a.preventDefault()};this.onDocumentDrop=function(a){if("function"===typeof h.onDocumentDrop&&!1===h.onDocumentDrop(a))return!1;a.preventDefault()};this.onDragOver=function(a){if("function"===typeof h.onDragOver&&!1===h.onDragOver(a))return!1;var c=a.originalEvent.dataTransfer;if(c)c.dropEffect=c.effectAllowed="copy";a.preventDefault()};this.onDrop=function(a){if("function"===
typeof h.onDrop&&!1===h.onDrop(a))return!1;var c=a.originalEvent.dataTransfer;c&&c.files&&l()&&x(a,c.files);a.preventDefault()};this.onChange=function(c){if("function"===typeof h.onChange&&!1===h.onChange(c))return!1;!h.forceIframeUpload&&c.target.files&&l()?x(c,c.target.files):B(c,a(c.target));c=g.clone(!0);a("<form/>").append(c).get(0).reset();g.replaceWith(c);g=c};this.init=function(f){f&&a.extend(h,f);if(c.data(h.namespace))a.error('FileUpload with namespace "'+h.namespace+'" already assigned to this element');
else{c.data(h.namespace,b).addClass(h.cssClass);h.dropZone.addClass(h.cssClass);if(h.dragDropSupport){if("function"===typeof h.onDocumentDragEnter)j["dragenter."+h.namespace]=h.onDocumentDragEnter;if("function"===typeof h.onDocumentDragLeave)j["dragleave."+h.namespace]=h.onDocumentDragLeave;j["dragover."+h.namespace]=b.onDocumentDragOver;j["drop."+h.namespace]=b.onDocumentDrop;a(document).bind(j);if("function"===typeof h.onDragEnter)k["dragenter."+h.namespace]=h.onDragEnter;if("function"===typeof h.onDragLeave)k["dragleave."+
h.namespace]=h.onDragLeave;k["dragover."+h.namespace]=b.onDragOver;k["drop."+h.namespace]=b.onDrop;h.dropZone.bind(k)}i["change."+h.namespace]=b.onChange;g.bind(i)}};this.destroy=function(){n();c.removeData(h.namespace).removeClass(h.cssClass);h.dropZone.removeClass(h.cssClass)}};c={init:function(c){return this.each(function(){(new b(a(this))).init(c)})},destroy:function(c){return this.each(function(){c=c?c:"file_upload";var b=a(this).data(c);b?b.destroy():a.error('No FileUpload with namespace "'+
c+'" assigned to this element')})}};a.fn.fileUpload=function(b){if(c[b])return c[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof b||!b)return c.init.apply(this,arguments);a.error("Method "+b+" does not exist on jQuery.fileUpload")}})(jQuery);
$(document).ready(function(){$("#back").click(function(){window.history.back()});$("#home, #logo_link").bind("click",function(){selected_photo=selected_user="";window.location.href="/#!/";$(".stream_nav").removeClass("selected");$("#active_stream_view").addClass("selected")});$("#give_feedback a").live("click",show_feedback);$("#feedback_cont").bind("click",function(){return!1});$("#submit_feedback").bind("click",function(){var a=$("#feedback_message").val();""!=a?$.post("/submit_feedback/",{message:a},
function(){$("#feedback_message").val("");$("#feedback_cont_wrap").hide();$("#feedback_reponse").show()}):$("#error_text").text("We need at least a few letters to know how you feel.")});$(document).bind("keyup",function(a){var b=a.keyCode;if(13===b){if(search_active)return a.stopPropagation(),search_select(),!1}else if(38===b){if(search_active)return a.stopPropagation(),search_keyboard_press("up"),!1}else if(40===b){if(search_active)return a.stopPropagation(),search_keyboard_press("down"),!1}else 39===
b?"nom_detail"==view_active?$(".next_photo_img").click():"gallery"==view_active&&$("#gallery_next").click():37===b?"nom_detail"==view_active?$(".prev_photo_img").click():"gallery"==view_active&&$("#gallery_prev").click():27===b&&hide_search_view()});$("#search_cont").bind("click",function(a){a.stopPropagation()});$("#search_control").live("click",function(a){a.stopPropagation();$("#close_search").removeClass().addClass("close_img "+close_size);show_search_view()});$("#close_search").bind("click",
function(){hide_search_view()});$("#logout").bind("click",function(){FB.logout(function(){void 0!==window.sessionStorage&&(sessionStorage.clear(),sessionStorage.clear());window.location.href="/"});$("#cont").fadeOut("fast",function(){$(this).html("");$("#cont").fadeIn("fast").append('<div id="logout_cont"><div id="loader"><img src="http://portrit.s3.amazonaws.com/img/album-loader-dark.gif"/></div><h1>Logging out. Hold on to your butts!</h1></div>')})})});var ENV="LOCAL",HOST="http://192.168.2.113:8080/";
if("test.portrit.com"==window.location.hostname)ENV="TEST",HOST="http://test.portrit.com/";else if("portrit.com"==window.location.hostname||"www.portrit.com"==window.location.hostname)ENV="PRODUCTION",HOST="http://www.portrit.com/";var window_href=window.location.href;if(0<window_href.indexOf("?ref=nf"))window.location.href=window_href.replace("?ref=nf","");
function render_login_cont(){disable_search=!0;0==$("#login_content").length&&$("#login_cont").append('<div id="login_header"><img id="login_logo" src="http://portrit.s3.amazonaws.com/img/logo_blank.png"/></div><div id="login_content"><div id="login_top_cont"><div id="tagline_top"><div id="iphone"><a target="_blank" href="http://itunes.apple.com/us/app/portrit/id435873942?mt=8&ls=1"><img src="http://portrit.s3.amazonaws.com/img/iphone_asset.png"/></a></div><div id="tagline_text"><h2>Let\'s find the best photos.</h2><p id="tagline_main">Snap, nominate, vote, and earn wherever you go with the Portrit iPhone app.</p></div><div id="app_row"><a target="_blank" href="http://itunes.apple.com/us/app/portrit/id435873942?mt=8&ls=1"><h3>Download the <strong>free</strong> app.</h3></a><a target="_blank" href="http://itunes.apple.com/us/app/portrit/id435873942?mt=8&ls=1"><img style="height: 53px; width: 153px;" src="http://portrit.s3.amazonaws.com/img/app_store_badge.png"/></a></div><div class="clear"></div></div><div id="login_right_cont" style="background-image: -webkit-gradient(linear, left bottom, left top, color-stop(0.06, rgb(209,209,209)), color-stop(0.53, rgb(242,242,242)));"><h2>Try the Web App.</h2><a id="login" class="fb_button fb_button_large"><span class="fb_button_text">Login with Facebook</span></a><p style="text-align:center;">Simply click Login with Facebook.</p></div><div class="clear"></div></div><div id="login_bottom_cont"><div id="login_points_cont"><div id="point_1" class="login_points"><div class="point_header"><h3>Nominate</h3></div><div class="clear"></div><div class="login_points_cont"><div class="login_points_bottom"><h4>Nominate your friend\'s rockin\' pics.</h4><p>Choose from 10 categories that best describe the photo.</p></div></div></div><div id="point_2" class="login_points"><div class="point_header"><h3>Vote</h3></div><div class="clear"></div><div class="login_points_cont"><div class="login_points_bottom"><h4>Give your vote to the best.</h4><p>Love it, vote it up. Hate it, vote it down.</p></div></div></div><div id="point_3" class="login_points"><div class="point_header"><h3>Earn</h3></div><div class="clear"></div><div class="login_points_cont"><div class="login_points_bottom"><h4>Earn trophies for your amazing photos.</h4><p>Quickly discover the best photos out there, determined by your friends.</p></div></div></div><div class="clear"></div></div><div id="inactive_trophy_cont"><ul><li class="active" id="hot_cont" name="Hot"><div class="trophy_img medium hot"></div><h3 class="nom_cat_hot_text">Hot</h3></li><li class="active" id="lol_cont" name="LOL"><div class="trophy_img medium lol"></div><h3 class="nom_cat_lol_text">LOL</h3></li><li class="active" id="artsy_cont" name="Artsy"><div class="trophy_img medium artsy"></div><h3 class="nom_cat_artsy_text">Artsy</h3></li><li class="active" id="fail_cont" name="Fail"><div class="trophy_img medium fail"></div><h3 class="nom_cat_fail_text">Fail</h3></li><li class="active" id="party_animal_cont" name="Party Animal"><div class="trophy_img medium party_animal"></div><h3 class="nom_cat_party_animal_text">Party Animal</h3></li><li class="active" id="cute_cont" name="Cute"><div class="trophy_img medium cute"></div><h3 class="nom_cat_cute_text">Cute</h3></li><li class="active" id="wtf_cont" name="WTF"><div class="trophy_img medium wtf"></div><h3 class="nom_cat_wtf_text">WTF</h3></li><li class="active" id="creepy_cont" name="Creepy"><div class="trophy_img medium creepy"></div><h3 class="nom_cat_creepy_text">Creepy</h3></li><li class="active" id="awesome_cont" name="Awesome"><div class="trophy_img medium awesome"></div><h3 class="nom_cat_awesome_text">Awesome</h3></li><li class="active" id="yummy_cont" name="Yummy"><div class="trophy_img medium yummy"></div><h3 class="nom_cat_yummy_text">Yummy</h3></li></ul></div><div id="landing_photo_cont"><h2></h2><div id="landing_photos_loading" style="display:none;"><img src="http://portrit.s3.amazonaws.com/img/ajax-loader-light.gif"/></div><div id="landing_photos_target"></div></div><div class="clear"></div></div><div class="clear"></div></div>');var a=
"hot,lol,artsy,fail,party_animal,cute,wtf,creepy,awesome,yummy".split(","),b={hot:"Hot",lol:"LOL",artsy:"Artsy",fail:"Fail",party_animal:"Party Animal",cute:"Cute",wtf:"WTF",creepy:"Creepy",awesome:"Awesome",yummy:"Yummy"},c=Math.floor(Math.random()*(a.length-1));$("#"+a[c]+"_cont").addClass("hover_lock");load_landing_cat_photos(b[a[c]]);$("#landing_photo_cont > h2").text("Top "+b[a[c]]+" Photos");$("#inactive_trophy_cont li").bind("click",function(){!1==$(this).hasClass("hover_lock")&&($("#inactive_trophy_cont li").removeClass("hover_lock"),
$(this).addClass("hover_lock"),cat=$(this).attr("name"),$("#landing_photo_cont > h2").text("Top "+cat+" Photos"),load_landing_cat_photos(cat));return!1});$("#login").bind("click",login_user);$("#landing_photo_cont .top_cat_photo").live("click",function(){$("#landing_photo_cont .top_cat_photo").die("click");window.location.href=$("a",this).attr("href");init_public_view();return!1})}var landing_photo_timeout=null;
function load_landing_cat_photos(a){$("#landing_photo_cont > div#landing_photos_target").children().fadeOut("fast",function(){$(this).remove();$("#landing_photos_loading").show()});var b=36;mobile&&!tablet&&(b=20);$.getJSON("/api/get_community_top_nominations_cat/",{cat:a,page_size:b,landing:!0},function(a){clearInterval(landing_photo_timeout);landing_photo_timeout=setInterval(function(){if(0==$("#landing_photo_cont > div#landing_photos_target").children().length){clearInterval(landing_photo_timeout);
var d="",e=0,e=b-a.length;$("#landing_photo_cont > div#landing_photos_target").append('<p class="tooltip"></p>');for(var f=0;f<a.length;f++)d='<div style="display: none;" class="top_cat_photo" name="'+a[f].nominatee_username+'"><a href="/#!/community/active/'+a[f].id+'/"><img src="'+a[f].photo.crop_small+'"/></a></div>',$("#landing_photo_cont > div#landing_photos_target").append(d);for(f=0;f<e;f++)d='<div style="display: none;"></div>',$("#landing_photo_cont > div#landing_photos_target").append(d);
$("#landing_photo_cont > div#landing_photos_target").children().fadeIn("fast");$("#landing_photos_loading").hide()}},50)})}function login_user(){if(void 0!==window.sessionStorage)try{sessionStorage.removeItem("me"),sessionStorage.removeItem("friends")}catch(a){}FB.login(handleSessionResponse,{scope:"publish_stream,offline_access,email"})}var watch_hashtag_interval=null,public_view=!1;
function handleSessionResponse(a){clearTimeout(fb_server_timeout);clearInterval(watch_hashtag_interval);$("#content_loading").remove();var b=window.location.href,c=b.replace("?","#!/");b!=c?window.location.href=c:a.authResponse?(public_view=!1,global_hash_tag=window.location.hash,fb_session=a.authResponse,fb_session.access_token=fb_session.accessToken,$("#login_cont").remove(),$("#wrapper").css({background:"none"}),$("#login").unbind("click"),$(".footer_hover").unbind("click"),$("#add_new_comment, .flag_photo, #nominate").die("mouseover mouseout"),
$("#header").removeClass().show(),$("#public_header").hide(),$("#general_header").show(),$("#login_loader").show(),$("#profile_wrap").remove(),watch_hashtag_interval=setInterval(watch_hashtag,75),login_fb_user()):(view_active="login",0<getUrlVars().length?(clearInterval(watch_hashtag),init_public_view()):(render_login_cont(),attach_login_handlers(),$("#header").hide()),mobile&&$("div#login_header").css({"padding-bottom":"0px"}),$(".footer_hover").bind("click",function(){window.location.href=$(this).attr("href");
init_public_view();$(".footer_hover").unbind("click");return!1}))}function attach_login_handlers(){$(".top_cat_photo").live("mouseover mouseout",function(a){"mouseover"==a.type?show_tooltip(this):hide_tooltip(this)})}if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a,b){null==b?b=0:0>b&&(b=Math.max(0,this.length+b));var c=0,d=0;for(c=b,d=this.length;c<d;c++)if(this[c]===a)return c;return-1};
Array.prototype.find_elm=function(a,b){null==b?b=0:0>b&&(b=Math.max(0,this.length+b));var c=0,d=0;for(c=b,d=this.length;c<d;c++)if(this[c]==a)return c;return-1};Array.prototype.remove=function(a,b){var c=this.slice((b||a)+1||this.length);this.length=0>a?this.length+a:a;return this.push.apply(this,c)};var is_array=function(a){return a&&"object"===typeof a&&"number"===typeof a.length&&"function"===typeof a.splice&&!a.propertyIsEnumerable("length")};
function getUrlVars(){for(var a=[],b=window.location.hash.split("/"),c=null,d=0;d<b.length;d++)c=b[d],void 0!=c&&""!=c&&"#!"!=c&&"#"!=c&&a.push(c);return a}function capitaliseFirstLetter(a){return a.charAt(0).toUpperCase()+a.slice(1)}function get_cat_under(a){return a.replace(" ","_").toLowerCase()}
function getScrollXY(){var a=0,b=0;if("number"==typeof window.pageYOffset)b=window.pageYOffset,a=window.pageXOffset;else if(document.body&&(document.body.scrollLeft||document.body.scrollTop))b=document.body.scrollTop,a=document.body.scrollLeft;else if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop))b=document.documentElement.scrollTop,a=document.documentElement.scrollLeft;return[a,b]}
function parseURL(a){var b={href:a},a=a.replace("//","/").split("/");b.protocol=a[0];b.host=a[1];a[1]=a[1].split(":");b.hostname=a[1][0];b.port=1<a[1].length?a[1][1]:"";a.splice(0,2);b.pathname="/"+a.join("/");b.pathname=b.pathname.split("#");b.hash=1<b.pathname.length?"#"+b.pathname[1]:"";b.pathname=b.pathname[0];b.pathname=b.pathname.split("?");b.search=1<b.pathname.length?"?"+b.pathname[1]:"";b.pathname=b.pathname[0];return b}
Date.prototype.setISO8601=function(a){var a=a.match(RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),b=0,c=new Date(a[1],0,1);a[3]&&c.setMonth(a[3]-1);a[5]&&c.setDate(a[5]);a[7]&&c.setHours(a[7]);a[8]&&c.setMinutes(a[8]);a[10]&&c.setSeconds(a[10]);a[12]&&c.setMilliseconds(1E3*Number("0."+a[12]));a[14]&&(b=60*Number(a[16])+Number(a[17]),b*="-"==a[15]?1:-1);b-=c.getTimezoneOffset();time=Number(c)+6E4*b;this.setTime(Number(time))};
function isValidEmailAddress(a){return RegExp(/^[a-zA-Z0-9\._%-]+@[A-Z0-9\.-]+\.[a-zA-Z]{2,4}(?:(?:[,][a-zA-Z0-9\._%-]+@[a-zA-Z0-9\.-]+))?$/i).test(a)}function isEmpty(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}
function secondsToHms(a){var a=Number(a),b=Math.floor(a/86400),c=Math.floor(a/3600),d=Math.floor(a%3600/60),a=Math.floor(a%3600%60);return 1<b?b+" days ago":1==b?b+" day ago":1<c?c+" hours ago":1==c?c+" hour ago":1<d?d+" minutes ago":1==d?d+" minute ago":10<=a?a+" seconds ago":"Right now"}function getGetOrdinal(a){var b=["th","st","nd","rd"],c=a%100;return a+(b[(c-20)%10]||b[c]||b[0])}function alphaNumericCheck(a){return/^[0-9A-Za-z]+$/.test(a)?!0:!1}
var reEscape=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g"),selected_user="",selected_photo="",view_active="",tablet=mobile=!1,fb_session=null,disable_search=!1,global_hash_tag="#!",search_string="",search_active=!1,friends={},stream_view=null,view_active="",fb_server_timeout=null;close_size="normal";me=null;
if(!0===DetectMobileQuick()){var meta_html="",mobile=!0;close_size="mobile";meta_html="undefined"!==typeof _gaq?'<link rel="stylesheet" href="http://portrit.s3.amazonaws.com/styles/production/mobile-21.css"/><meta id="viewport_meta" name="viewport" content="width=520, user-scalable=no"/><link rel="shortcut icon" href="http://portrit.s3.amazonaws.com/img/favicon.ico"><link rel="apple-touch-icon" href="http://portrit.s3.amazonaws.com/img/appicon@2x.png"/><link rel="apple-touch-icon-precomposed" href="http://portrit.s3.amazonaws.com/img/appicon@2x.png"/>':'<link rel="stylesheet" href="/site_media/styles/trunk/mobile.css"/><meta id="viewport_meta" name="viewport" content="width=520, user-scalable=no"/><link rel="shortcut icon" href="/site_media/img/favicon.ico"><link rel="apple-touch-icon" href="/site_media/img/icon128.png"/><link rel="apple-touch-icon-precomposed" href="/site_media/img/icon128.png"/>';
$("head").append(meta_html);var window_width=520;$("body, html, #header, #cont, #wrapper").css({margin:"0 auto","min-width":window_width,width:window_width,"max-width":window_width});0!=window.orientation?(window_width=720,$("#viewport_meta").attr("content","width=520, user-scalable=no, target-densityDpi=160")):(window_width=520,$("#viewport_meta").attr("content","width=520, user-scalable=no, target-densityDpi=260"))}else!0===DetectIpad()&&(close_size="mobile",tablet=mobile=!0);
mobile&&(setTimeout(function(){$("#footer").css({position:"relative","z-index":99})},500),setTimeout(function(){$("#footer").css({position:"relative","z-index":99})},1E3));function find_friend(a,b){for(var c=-1,d=0;d<b.length;d++)b[d].id===a&&(c=d);return c}
function render_about(){$("#context_cont").append('<h1 id="about_title">About</h1><div id="about_right_cont"><div id="find_us"><h3>Find us on the tubes</h3><ul><li><a target="_blank" href="http://itunes.apple.com/us/app/portrit/id435873942?mt=8&amp;ls=1"><img style="height: 53px; width: 153px;" src="http://portrit.s3.amazonaws.com/img/app_store_badge.png"></a></li><li><h4>Blog</h4><a target="_blank" href="http://blog.portrit.com">Posterous</a></li><li><h4>Twitter</h4><a target="_blank" href="http://twitter.com/#!/portrit">@portrit</a></li></ul></div><div id="facebook_frame"><iframe src="http://www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2Fapps%2Fapplication.php%3Fid%3D126374870731237&amp;width=292&amp;connections=10&amp;stream=true&amp;header=true&amp;height=587" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:292px; height:587px;" allowTransparency="true"></iframe></div></div><div id="about_left_cont"><img src="http://portrit.s3.amazonaws.com/img/about_graphic.jpg"/><p style="margin-top: 10px;">Portrit is a new way of sharing and discovering the best photos out there. Share your Party Animal, Artsy, Fail, WTF, etc. moments with your friends. Compete with your friends and the world to find who\'s got the best photos. Earn trophies for your amazing photos. Select from 10 nomination categories that best describe your photos. On Portrit, you and your friends filter the lame photos from the awesome ones.</p><p>Co-founded by Jonathan Eatherly and Jerry Lin in 2010.</p></div><div class="clear"></div>');"undefined"!==
typeof _gaq&&_gaq.push(["_trackEvent","About","Shown",""])}
function render_contact(){$("#contact_nav li").live("click",function(){var a=$(this).attr("name");"contact"===a?($("#contact_explain").text("Comments? Love us? Hate us? Found a bug and what to share? Dont hold back, give it to us real."),$("#bug_form_cont").hide(),$("#contact_form_cont").show(),$("#contact_nav li").css({opacity:"0.7"}),$(this).css({opacity:"1.0"})):"bug"===a&&($("#contact_explain").text("Found a problem with the site? Please use the form below to describe the issue in as much detail as possible so we know how to reproduce it."),$("#contact_form_cont").hide(),
$("#bug_form_cont").show(),$("#contact_nav li").css({opacity:"0.7"}),$(this).css({opacity:"1.0"}))});$("#contact_form .button, #bug_form .button").live("click",function(){var a=this,b=$(this).parent().parent();if("contact_form"==$(b).attr("id")){var b=!1,c=$("#contact_email").val(),d=$("#contact_reason").val(),e=$("#contact_message_cont textarea").val();isValidEmailAddress(c)?$("#contact_email_cont .invalid_data").remove():(b=!0,$("#contact_email_cont .invalid_data").remove(),$("#contact_email").after('<div class="invalid_data"></div>'));
1>d||6<d?(b=!0,$("#contact_reason_cont .invalid_data").remove(),$("#contact_reason").after('<div class="invalid_data"></div>')):$("#contact_reason_cont .invalid_data").remove();""==e?(b=!0,$("#contact_message_cont .invalid_data").remove(),$("#contact_message_cont > textarea").after('<div class="invalid_data"></div>')):$("#contact_message_cont .invalid_data").remove();b||($(a).hide(),$("#contact_form .submit_cont").append('<img class="submit_pending" src="http://portrit.s3.amazonaws.com/img/ajax-loader-light.gif"/>'),
$.post("/contact_portrit/",{email:c,reason:d,message:e},function(){$(".submit_pending").remove();$(a).show();$("#contact_form .submit_pending").remove();$("#contact_email").val("");$("#contact_reason").val("");$("#contact_message_cont textarea").val("");$("#contact_form .submit_cont").append('<h2 style="margin-botton: 5px; margin-top: 10px;">Thanks for your message. We will get to it soon.</h2>');$(".submit_cont h2").animate({opacity:0},8E3,function(){$(this).remove()})}))}else if("bug_form"==$(b).attr("id")){var b=
!1,c=$("#bug_email").val(),d=$("#bug_where").val(),e=$("#bug_what").val(),f=$("#bug_op").val(),g=$("#bug_browser").val();isValidEmailAddress(c)?$("#bug_email_cont .invalid_data").remove():(b=!0,$("#bug_email_cont .invalid_data").remove(),$("#bug_email").after('<div class="invalid_data"></div>'));""==d?(b=!0,$("#bug_where_cont .invalid_data").remove(),$("#bug_where").after('<div class="invalid_data"></div>')):$("#bug_where_cont .invalid_data").remove();""==e?(b=!0,$("#bug_what_cont .invalid_data").remove(),
$("#bug_what").after('<div class="invalid_data"></div>')):$("#bug_what_cont .invalid_data").remove();""==f?(b=!0,$("#bug_op_cont .invalid_data").remove(),$("#bug_op").after('<div class="invalid_data"></div>')):$("#bug_op_cont .invalid_data").remove();""==g?(b=!0,$("#bug_browser_cont .invalid_data").remove(),$("#bug_browser").after('<div class="invalid_data"></div>')):$("#bug_browser_cont .invalid_data").remove();b||($(a).hide(),$("#bug_form .submit_cont").append('<img class="submit_pending" src="http://portrit.s3.amazonaws.com/img/ajax-loader-light.gif"/>'),
$.post("/submit_bug_report/",{email:c,where:d,message:e,os:f,browser:g},function(){$("#bug_form .submit_pending").remove();$(a).show();$("#bug_email").val("");$("#bug_where").val("");$("#bug_what").val("");$("#bug_op").val("");$("#bug_browser").val("");$("#bug_form .submit_cont").append("<h2>Thanks for your report. It's people like you that keep this place nice.</h2>");$(".submit_cont h2").animate({opacity:0},5E3,function(){$(this).remove()})}))}return!1});$("#context_cont").append('<div id="contact_header"><h1 id="contact_title">Tell Us What\'s Up</h1><p id="contact_explain">Comments? Love us? Hate us? Found a bug and want to share? Dont hold back, give it to us real.</p><p>Don\'t like contact forms? Email us at <a href="mailto:contact@portrit.com">contact@portrit.com</a></p></div><div id="contact_nav"><ul><li id="tab_contact" name="contact" style="opacity: 1.0;" onclick="void(0)"><span>Send us a Message</span></li><li name="bug" id="tab_bug" onclick="void(0)"><span>File a Bug Report</span></li></div><div class="clear"></div><div id="contact_form_cont"><form action="" method="POST" id="contact_form"><div id="contact_email_cont"><label for="contact_email">Your email address</label><input type="text" id="contact_email"/><div class="clear"></div></div><div id="contact_reason_cont"><label for="contact_reason">Reason for contacting us</label><select id="contact_reason" name="contact_reason"><option value>Please choose one (required)</option><option value="1">Portrit support & help</option><option value="2">General feedback</option><option value="3">Report abuse or Terms of Use violation</option><option value="4">Partnership opportunities</option><option value="5">Press Inquiry</option><option value="6">Advertise with Portrit</option></select><div class="clear"></div></div><div id="contact_message_cont"><label for="contact_message">Message</label><textarea name="contact_message"></textarea><div class="clear"></div></div><div class="submit_cont"><span class="button sick">Send Message</span></div></form></div><div id="bug_form_cont" style="display:none;"><form action="" method="POST" id="bug_form"><div id="bug_email_cont"><label for="bug_email">Your email address</label><input type="text" id="bug_email"/><div class="clear"></div></div><div id="bug_where_cont"><label for="bug_where">Where?</label><input id="bug_where" type="text" name="bug_where"/><div class="clear"></div></div><div id="bug_what_cont"><label for="bug_what">What Happened?</label><textarea id="bug_what" name="bug_what"/><div class="clear"></div></div><div id="bug_op_cont"><label for="bug_op">Operating System</label><input id="bug_op" type="text" name="bug_op"/><div class="clear"></div></div><div id="bug_browser_cont"><label for="bug_browser">Web Browser</label><input id="bug_browser" type="text" name="bug_browser"/><div class="clear"></div></div><div class="submit_cont"><span class="button sick">Submit Report</span></div></form></div><div class="clear"></div>');
"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Contact","Shown",""])}
function render_terms(){$("#context_cont").append('<h1 id="terms_title">Terms of Use</h1><p>The following Terms of Use outline your obligations when using the Portrit website. You can also review our Privacy Policy, which outlines our obligations and practices towards handling any personal information that you may provide to us.</p><h2 class="terms_sub_title">1. Acceptance of Terms</h2><p>The web pages available at portrit.com, and all linked pages ("Site"), as well as the Portrit iOS app ("App"), are owned and operated by Portrit, Inc. ("Portrit"), a Oregon corporation, and is accessed by you under the Terms of Use described below ("Terms of Use").<br/><br/>Please read these terms of use carefully before using Portrit or its services. By accessing Portrit or using any part of the Site you agree to become bound by these terms and conditions. If you do not agree to all the terms and conditions, then you may not access Portrit, or use the content or any services offered. Portrit\'s acceptance is expressly conditioned upon your assent to all these terms and conditions, to the exclusion of all other terms; if these terms and conditions are considered an offer by Portrit, acceptance is expressly limited to these terms.</p><h2 class="terms_sub_title">2. Modifications of the Terms of Use</h2><p>Portrit reserves the right, at its sole discretion, to modify or replace the Terms of Use at any time. If the alterations constitute a material change to the Terms of Use, Portrit will notify you by posting an announcement on the Site. What constitutes a "material change" will be determined at Portrit\'s sole discretion, in good faith and using common sense and reasonable judgment. You shall be responsible for reviewing and becoming familiar with any such modifications. Use of the Services by you following such notification constitutes your acceptance of the terms and conditions of the Terms of Use as modified.</p><h2 class="terms_sub_title">3. Description of the Service</h2><p>Subject to full compliance with the Terms of Use, Portrit may offer to provide certain services and content, as described more fully on the Site, ("Services"). Services shall include, but not be limited to, any service and content Portrit performs for you, as well as the offering of any materials displayed, transmitted or performed on the Site or through the Services (including, but not limited to text, user comments, information, photographs, images, illustrations, audio clips and video clips, also known as the "Content"). Portrit may change, suspend or discontinue the Services for any reason, at any time, including the availability of any feature. Portrit may also impose limits on certain features and services or restrict your access to parts or all of the Services without notice or liability.</p><h2 class="terms_sub_title">4. Portrit Privacy Policy</h2><p>Portrit\'s current privacy policy is available at <a href="http://portrit.com/#!/privacy/">portrit.com/#!/privacy/</a> (the "Privacy Policy"), which is incorporated by this reference.</p><h2 class="terms_sub_title">5. Indemnity</h2><p>You will indemnify and hold harmless Portrit, its parents, subsidiaries, affiliates, customers, vendors, officers and employees from any liability, damage or cost (including reasonable attorneys. fees and cost) from (i) any claim or demand made by any third party due to or arising out of your access to the Site, use of the Services, violation of the Terms of Use by you, or the infringement by you, or any third party using your account or Facebook User ID, of any intellectual property or other right of any person or entity.</p><h2 class="terms_sub_title">6. Warranty Disclaimers</h2><p>You acknowledge that Portrit has no control over, and no duty to take any action regarding: which users gain access to the Site or use the Services; what effects the Content may have on you; how you may interpret or use the Content; or what actions you may take as a result of having been exposed to the Content. You release Portrit from all liability for you having acquired or not acquired Content through the Site or the Services. The Site or Services may contain, or direct you to sites containing, information that some people may find offensive or inappropriate. Portrit makes no representations concerning any content contained in or accessed through the Site or Services, and Portrit will not be responsible or liable for the accuracy, copyright compliance, legality or decency of material contained in or accessed through the Site or the Services. THE SERVICE, CONTENT, AND SITE ARE PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING, WITHOUT LIMITATION, IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT. SOME STATES DO NOT ALLOW LIMITATIONS ON HOW LONG AN IMPLIED WARRANTY LASTS, SO THE ABOVE LIMITATIONS MAY NOT APPLY TO YOU.</p><h2 class="terms_sub_title">7. Links </h2><p>The Services may provide, or third parties may provide, links to other World Wide Web sites or resources. Because Portrit has no control over such sites and resources, you acknowledge and agree that Portrit is not responsible for the availability of such external sites or resources, and does not endorse and is not responsible or liable for any Content, advertising, products or other materials on or available from such sites or resources. You further acknowledge and agree that Portrit shall not be responsible or liable, directly or indirectly, for any damage or loss caused or alleged to be caused by or in connection with use of or reliance on any such Content, goods or services available on or through any such site or resource.</p><h2 class="terms_sub_title">8. Limitation of Liability</h2><p>In no event shall Portrit or its suppliers be liable under contract, tort or strict liability, negligence or other legal theory (i) with respect to the Site, the Service or any content for any lost profits or special, indirect, incidental, punitive or consequential damages of any kind whatsoever, substitute goods or services (however arising), or (ii) for any direct damages in excess of (in the aggregate) $100. Some states do not allow the exclusion or limitation of incidental or consequential damages, so the above limitations and exclusions may not apply to you.</p><h2 class="terms_sub_title">9. Termination</h2><p>Portrit may terminate or suspend any and all Services and your Portrit account immediately, without prior notice or liability, if you breach any of the terms or conditions of the Terms of Use. Upon termination of your account, your right to use the Services will immediately cease. If you wish to terminate your Portrit account, you may simply discontinue using the Services. All provisions of the Terms of Use which by their nature should survive termination shall survive termination, including, without limitation, ownership provisions, warranty disclaimers, indemnity and limitations of liability.</p><h2 class="terms_sub_title">10. Miscellaneous</h2><p>No agency, partnership, joint venture, or employment is created as a result of the Terms of Use and you do not have any authority of any kind to bind Portrit in any respect whatsoever. The failure of either party to exercise in any respect any right provided for herein shall not be deemed a waiver of any further rights hereunder. Portrit shall not be liable for any failure to perform its obligations hereunder where such failure results from any cause beyond Portrit\'s reasonable control, including, without limitation, mechanical, electronic or communications failure or degradation (including "line-noise" interference). If any provision of the Terms of Use is found to be unenforceable or invalid, that provision shall be limited or eliminated to the minimum extent necessary so that the Terms of Use shall otherwise remain in full force and effect and enforceable. The Terms of Use is not assignable, transferable or sublicensable by you except with Portrit\'s prior written consent. Portrit may transfer, assign or delegate the Terms of Use and its rights and obligations without consent. The Terms of Use shall be governed by and construed in accordance with the laws of the state of Oregon, as if made within Oregon between two residents thereof, and the parties submit to the exclusive jurisdiction of the Superior Court of Oregon and the United States District Court for the District of Oregon. Notwithstanding the foregoing sentence, (but without limiting Portrit\'s right to seek injunctive or other equitable relief in any court of competent jurisdiction), any disputes arising with respect to this Agreement shall be referred to an arbitrator affiliated with JAMS, The Resolution Experts. The arbitrator shall be selected by joint agreement of the parties. In the event the parties cannot agree on an arbitrator within thirty (30) days of the initiating party providing the other party with written notice that it plans to seek arbitration, the parties shall each select an arbitrator affiliated with JAMS, which arbitrators shall jointly select a third such arbitrator to resolve the dispute. The written decision of the arbitrator shall be final and binding on the parties. The arbitration proceeding shall be carried on and heard in Ashland, Oregon using the English language and pursuant to the rules of JAMS. In any action or proceeding to enforce rights under the Terms of Use, the prevailing party will be entitled to recover costs and attorneys\' fees. Both parties agree that the Terms of Use is the complete and exclusive statement of the mutual understanding of the parties and supersedes and cancels all previous written and oral agreements, communications and other understandings relating to the subject matter of the Terms of Use, and that all modifications must be in a writing signed by both parties, except as otherwise provided herein.</p>');"undefined"!==
typeof _gaq&&_gaq.push(["_trackEvent","Terms","Shown",""])}
function render_privacy(){$("#context_cont").append('<div id="privacy_cont"><h1 id="privacy_title">Privacy Policy</h1><p>Portrit knows that you care about how your personal information is used and shared, and we take your privacy very seriously. Please read the following to learn more about our privacy policy. By visiting the Portrit website, you are accepting the practices outlined in this Privacy Policy.</p><p>This Privacy Policy covers Portrit\'s treatment of personal information that Portrit gathers when you are on the Portrit website and when you use Portrit services. This policy does not apply to the practices of third parties that Portrit does not own or control, or to individuals that Portrit does not employ or manage.</p><h2>Information Collected by Portrit</h2><p>We only collect personal information that is relevant to the purpose of our website, which is to enable users to discover and share information with one another. This information allows us to provide you with a customized and efficient experience. We do not process this information in a way that is incompatible with this objective. We collect the following types of information from our Portrit users:</p><h3>Information You Provide to Us:</h3><p class="indent">We receive and store any information you enter on our website or provide to us in any other way. You can choose not to provide us with certain information, but then you may not be able to take advantage of many of our special features.</p><h3>Automatic Information:</h3><p class="indent">We receive and store certain types of information whenever you interact with us. Portrit and its authorized agents automatically receive and record certain "traffic data" on their server logs from your browser including your IP address, Portrit cookie information, and the page you requested. Portrit uses this traffic data to help diagnose problems with its servers, analyze trends and administer the website.</p><p class="indent">Portrit is built off of the Facebook Open Grah API and as such, Portrit abides by the API giudlines as well as any user Facebook privacy policies and permissions. See Facebook\'s developer guidlines here <a target="_blank" href="http://developers.facebook.com/policy/">http://developers.facebook.com/policy/</a></p><p class="indent">We will collect data from your Facebook account to enable features like email notifications, suggested users, nominating photos, votes, and winning trophies. This data is shared across the Portrit service to allow for a consistant experience for the other users of Portrit. We only store the most basic personal information, including but not limited to name, email, facebook id, and friend ids. You can delete any personal data we have, including votes, comments, nominations, uploaded photos, and trophies by going to the settings and requesting to "Remove My Account". Please allow up to 7 days for this request to be handled, in which time you will be notified that your account has been removed.</p><h2>Sharing Your Information</h2><p>Rest assured that the information gathered about who is using Portrit will be neither rented nor sold to anyone and that we will share your personal information only as described below.</p><ul><li><p>Portrit Personnel: Portrit personnel and authorized consultants and/or contractors may have access to user analytics information if necessary in the normal course of Portrit business.</p></li><li><p>Business Transfers: In some cases, we may choose to buy or sell assets. In these types of transactions, user analytics information is typically one of the business assets that is transferred. Moreover, if Portrit, or substantially all of its assets, were acquired, user analytics information would be one of the assets that is transferred.</p></li></ul><h2>Keeping Information Secure</h2><ul><li><p>Your Portrit account information is protected by your Facebook account login username and password. Protect against unauthorized access to your password and to your computer by logging off once you have finished using a shared computer.</p></li><li><p>Only employees who need personal information to perform a specific job (for example, a customer service representative) are granted access to it. All of our employees are kept up to date on our privacy and security practices.</p></li></ul><h2>Changes to this Privacy Policy</h2><p>Portrit may amend this Privacy Policy from time to time, at its sole discretion. Use of information we collect now is subject to the Privacy Policy in effect at the time such information is used. If we make changes to the Privacy Policy, we will notify you by posting an announcement on the Portrit website so you are always aware of what information we collect, how we use it, and under what circumstances if any, it is disclosed.</p><h2>Conditions of Use</h2><p>If you decide to visit Portrit website, your visit and any possible dispute over privacy is subject to this Privacy Policy and our Terms of Use, including limitations on damages, arbitration of disputes, and application of Oregon state law.</p><h2>Effective Date of this Privacy Policy</h2><p>This Privacy Policy is effective as of January 31, 2011 and last updated April 27, 2011.</p></div>');"undefined"!==
typeof _gaq&&_gaq.push(["_trackEvent","Privacy","Shown",""])}
function render_faq(){$("#context_cont").append('<div id="context_header"><h1>Frequently Asked Questions</h1><p>Ansers to your most pressing questions</p></div><div id="context_main_cont"><div class="context_sub_cont"><h3>What\'s Portrit?</h3><p>Portrit aims to make photo sharing more social. It\'s up to your social circle to find and award the best photos out there. No longer do you need to look through thousands of your friend\'s photos to find the best ones. On Portrit, you and your friends filter the lame photos from the awesome ones.</p></div><div class="context_sub_cont"><h2>Nominations</h2><h3>What\'s a nomination?</h3><p>A nomination is your way of saying "I think this photo rocks!". We have 10 different categories to choose from, such as Hot, LOL, Fail, Awesome, etc.</p></div><div class="context_sub_cont"><h2>Voting</h2><h3>Can I vote on multiple nominations?</h3><p>Yes you can and we prefer you do! Vote up the photos you like and vote down the lame ones.</p><h3>Why can\'t I change my vote?</h3><p>This is to limit the possibilites of gaming the system and give the older nominations a better chance against any last minute nominations.</p></div><div class="context_sub_cont"><h2>Trophies</h2><h3>How do I win trophies?</h3><p>A nomination requires a positive vote count of 2 for it to be eligable for a trophy. At the end of the night we determine the winners based on vote count and who you are following.</p></div></div>');"undefined"!==
typeof _gaq&&_gaq.push(["_trackEvent","FAQ","Shown",""])}
function render_extensions(){$("#context_cont").append('<div id="context_header"><h1>Browser Extensions</h1><p>Share and nominate photos wherever you browse.</p></div><div id="context_main_cont"><div id="extensions_cont"><a href="http://portrit.s3.amazonaws.com/extensions/portrit.crx"><div class="browser_cont"><img src="http://portrit.s3.amazonaws.com/img/chrome.png"/><p>Google Chrome</p></div></a><a href="http://portrit.s3.amazonaws.com/extensions/portrit.safariextz"><div class="browser_cont" style="border-left: 1px solid #dedede; border-right: 1px solid #dedede;"><img src="http://portrit.s3.amazonaws.com/img/safari.png"/><p>Safari</p></div></a><a href="http://portrit.s3.amazonaws.com/extensions/portrit.xpi"><div class="browser_cont"><img src="http://portrit.s3.amazonaws.com/img/firefox.png"/><p>Firefox</p></div></a><div class="clear"></div></div><div id="extensions_about_cont"><div class="extension_point"><div class="extension_point_header"><h2>1</h2><h3>Download</h3><div class="clear"></div></div><img src="http://portrit.s3.amazonaws.com/img/download.jpg"/></div><div class="extension_point"><div class="extension_point_header"><h2>2</h2><h3>Right click</h3><div class="clear"></div></div><img src="http://portrit.s3.amazonaws.com/img/right_click.jpg"/></div><div class="extension_point"><div class="extension_point_header"><h2>3</h2><h3>Nominate and share</h3><div class="clear"></div></div><img src="http://portrit.s3.amazonaws.com/img/share_extension.jpg"/></div><div class="clear"></div></div></div>');"undefined"!==
typeof _gaq&&_gaq.push(["_trackEvent","Extensions","Shown",""])}
function info_context_delagate(a){first_tuts_on&&$("#first_tuts_cont").hide();selected_user={username:null,fid:null,name:null};stream_view="";$("html, body").scrollTop(0);$(".stream_nav").removeClass("selected");$(".sub_stream_nav").removeClass("selected");$("#profile_cont_wrap").append('<div id="context_cont"></div>');"about"===a?(view_active="about",render_about()):"contact"===a?(view_active="contact",render_contact()):"terms"===a?(view_active="terms",render_terms()):"privacy"===a?(view_active=
"privacy",render_privacy()):"settings"===a?(view_active="settings",render_settings()):"faq"==a?(view_active="faq",render_faq()):"extensions"==a&&(view_active="extensions",render_extensions())}
function show_feedback(a){disable_search=!0;a.stopPropagation();$("#wrapper").css({opacity:"0.3"});$("#feedback_cont_wrap").show();$("#feedback_reponse").hide();$("#feedback").show();$("#feedback_message").focus();$(document).bind("click",hide_feedback);$("#close_feedback").removeClass().addClass("close_img "+close_size);$("#close_feedback, #close_feedback_button").bind("click",hide_feedback);return!1}
function hide_feedback(){disable_search=!1;$("#wrapper").css({opacity:"1.0"});$("#feedback").hide();$(document).unbind("click",hide_feedback);$("#close_feedback, #close_feedback_button").unbind("click",hide_feedback)}var startX,dx,direction,swipe_el=null,swipe_listener=null;function cancelTouch(){swipe_el.removeEventListener("touchmove",onTouchMove);swipe_el.removeEventListener("touchend",onTouchEnd);direction=startY=startX=null}
function onTouchMove(a){1<a.touches.length?cancelTouch():(dx=a.touches[0].pageX-startX,a=a.touches[0].pageY-startY,null==direction?direction=dx:(0>direction&&0<dx||0<direction&&0>dx||100<Math.abs(a))&&cancelTouch())}function onTouchEnd(){cancelTouch();200<Math.abs(dx)&&swipe_listener({target:swipe_el,direction:0<dx?"right":"left"})}
function onTouchStart(a){if(1==a.touches.length)dx=0,startX=a.touches[0].pageX,startY=a.touches[0].pageY,swipe_el.addEventListener("touchmove",onTouchMove,!0),swipe_el.addEventListener("touchend",onTouchEnd,!1)}function addSwipeListener(a,b){swipe_el=a;swipe_listener=b;swipe_el.addEventListener("touchstart",onTouchStart,!1)}
function set_mobile_css(){var a="";mobile&&!tablet?a="undefined"!==typeof _gaq?'<link rel="stylesheet" href="http://portrit.s3.amazonaws.com/styles/production/mobile-3.css"/>':'<link rel="stylesheet" href="/site_media/styles/trunk/mobile.css"/>':mobile&&tablet&&"undefined"!==typeof _gaq&&(a='<link rel="stylesheet" href="http://portrit.s3.amazonaws.com/styles/production/tablet-3.css"/>');$("head").append(a)}
function wait_for_message(){var a="",a="PRODUCTION"==ENV?"http://node.portrit.com/":"/watch_update/";$.ajax({type:"GET",url:a,data:{user:me.id},dataType:"jsonp",async:!0,cache:!1,timeout:3E4,success:handle_update,error:function(){setTimeout(wait_for_message,5E3)}})}
function handle_update(a,b){if(a&&a.method)if("new_nom"==a.method){for(var c=0;c<a.payload.nom_data.length;c++)a.payload.nom_data[c].nominatee==me.id?(render_notification("new_nom",a.payload.nom_data[c]),update_notifications(a.payload.nom_data[c],"new_nom")):0<=a.payload.nom_data[c].tagged_users.find_elm(me.id)&&(render_notification("tagged_nom",a.payload.nom_data[c]),update_notifications(a.payload.nom_data[c],"tagged_nom"));"stream_active"==view_active&&inject_nom_stream(a.payload.nom_data,$("#recent_left_cont"))}else if("vote"==
a.method){if(a.payload.vote_user!=me.id){if(nom_cache&&nom_cache[a.payload.nom_id])nom_cache[a.payload.nom_id].vote_count=a.payload.vote_count,nom_cache[a.payload.nom_id].votes.push({vote_user:a.payload.vote_user,vote_name:a.payload.vote_name,vote_username:a.payload.vote_username});("stream_active"==view_active||"nom_detail"==view_active)&&update_vote_count(a.payload)}}else"new_comment"==a.method?a.payload.comment_sender_id!=me.id&&(render_notification("new_comment",a.payload),update_notifications(a.payload,
"new_comment"),"nom_detail"==view_active?a.payload.id==$("#main_nom_cont").attr("value")&&render_comment_update(a.payload):"stream_active"==view_active&&render_recent_comment_update(a.payload)):"new_comment_update"==a.method?a.payload.comment_sender_id!=me.id&&("nom_detail"==view_active?a.payload.id==$("#main_nom_cont").attr("value")&&render_comment_update(a.payload):"stream_active"==view_active&&"recent_noms"==stream_view&&render_recent_comment_update(a.payload)):"nom_won"==a.method?(render_notification("nom_won",
a.payload),update_notifications(a.payload,"nom_won")):"new_follow"==a.method&&(render_notification("new_follow",a.payload),update_notifications(a.payload,"new_follow"),update_follow_count());"undefined"!==typeof b&&wait_for_message()}
function render_recent_comment_update(a){var b='<div class="comment" id="comment_'+a.comment_id+'" style="display:none;"><p class="comment_time" value="'+a.create_datetime+'">Right now</p><a href="/#!/'+a.comment_sender_username+'/"><img class="user_photo" src="https://graph.facebook.com/'+a.comment_sender_id+'/picture?type=square"/></a><a href="/#!/'+a.comment_sender_username+'/" class="post_username from_username">'+a.comment_sender_username+"</a><p>"+a.comment+"</p></div>";$("#"+a.id+" .recent_nom_comment_heading").after(b);
$("#comment_"+a.comment_id).fadeIn("slow");var c=new Date,d=null;$(".comment_time").each(function(){time=new Date(1E3*$(this).attr("value"));d=c-time;d/=1E3;$(this).text(secondsToHms(parseInt(d)))})}
function render_comment_update(a){$("#comments_empty").remove();a='<div class="comment" style="display:none;"><p class="comment_time" value="'+a.create_datetime+'">Right now</p><a href="/#!/'+a.comment_sender_username+'/"><img class="user_photo" src="https://graph.facebook.com/'+a.comment_sender_id+'/picture?type=square"/></a><a href="/#!/'+a.comment_sender_username+'/" class="post_username from_username">'+a.comment_sender_username+"</a><p>"+a.comment+"</p></div>";$("#new_comment_cont").after(a);
$(".comment:first").fadeIn("slow");var b=new Date,c=null;$(".comment_time").each(function(){time=new Date(1E3*$(this).attr("value"));c=b-time;c/=1E3;$(this).text(secondsToHms(parseInt(c)))})}var notification_popup_fade_timeout=null,notification_popup_remove_timeout=null;
function render_notification(a,b){var c="",d="",e=c="";"new_nom"==a&&(d="",d=b.nominator==me.id?"You":b.nominator_username,d='<div class="nom_cat_'+b.nomination_category.replace(" ","_").toLowerCase()+' notification_color"></div><div class="notification_text_cont"><p class="strong">'+d+'</p><span> nominated your photo for the </span><p class="strong">'+b.nomination_category+"</p><span> trophy!</span></div>");if("tagged_nom"==a)d="",d=b.nominator==me.id?"You":b.nominator_username,d='<div class="nom_cat_'+
b.nomination_category.replace(" ","_").toLowerCase()+' notification_color"></div><div class="notification_text_cont"><p class="strong">'+d+'</p><span> tagged you in a nomination for the </span><p class="strong">'+b.nomination_category+"</p><span> trophy!</span></div>";else if("new_comment"==a)d=b.nom_owner_id==me.id?'<div class="nom_cat_'+b.nomination_category.replace(" ","_").toLowerCase()+' notification_color"></div><div class="notification_text_cont"><p class="strong">'+b.comment_sender_username+
'</p><span> commented on your <p class="strong">'+b.nomination_category+"</p> nomination!</span></div>":b.nom_owner_id==b.comment_sender_id?'<div class="nom_cat_'+b.nomination_category.replace(" ","_").toLowerCase()+' notification_color"></div><div class="notification_text_cont"><p class="strong">'+b.comment_sender_username+'</p><span> commented on their <p class="strong">'+b.nomination_category+"</p> nomination!</span></div>":'<div class="nom_cat_'+b.nomination_category.replace(" ","_").toLowerCase()+
' notification_color"></div><div class="notification_text_cont"><p class="strong">'+b.comment_sender_username+'</p><span> commented on <span class="strong">'+b.nom_owner_username+'\'s</span> <p class="strong">'+b.nomination_category+"</p> nomination!</span></div>";else if("nom_won"==a)d=b.nominatee==me.id?'<div class="nom_cat_'+b.nomination_category.replace(" ","_").toLowerCase()+' notification_color"></div><div class="notification_text_cont"><p class="strong">Your</p><span> photo won the <p class="strong">'+
b.nomination_category+"</p> nomination!</span></div>":'<div class="nom_cat_'+b.nomination_category.replace(" ","_").toLowerCase()+' notification_color"></div><div class="notification_text_cont"><p class="strong">'+b.nominatee_username+'\'s</p><span> photo won the <p class="strong">'+b.nomination_category+"</p> nomination!</span></div>";else if("new_follow"==a)c="new_follow",e=b.follower_username,d=b.pending?'<div class="new_follow notification_color"></div><div class="notification_text_cont"><p class="strong">'+
e+"</p><span> would like to follow you.</span></div>":'<div class="new_follow notification_color"></div><div class="notification_text_cont"><p class="strong">'+e+"</p><span> is now following you.</span></div>";var f="";if(b.notification_id)f=b.notification_id;c='<div class="notification_popup '+c+'" style="display:none;" username="'+e+'" value="'+b.id+'" name="'+f+'"><div class="close_notification close_img '+close_size+'"></div><div class="notification_cont">'+d+"</div></div>";$("#notification_popup_cont").append(c);
var g=$(".notification_popup:hidden");setTimeout(function(){$(g).show().css({opacity:1})},75);notification_popup_fade_timeout=setTimeout(function(){$(g).css({opacity:0});notification_popup_remove_timeout=setTimeout(function(){$(g).remove()},350)},7500)}
$(".notification_popup").live("click",function(){var a=this,b=$(this).attr("value"),c=parseInt($(this).attr("name")),d=!1;$(".notification_popup_cont").each(function(){var a=$(this).attr("read"),b=parseInt($(this).attr("id").replace("notification_",""));if(0==a||"false"==a||!1==a)c==b?($(this).attr("read","true"),$.post("/notification_read/",{notification_id:c},function(){})):d=!0});d?$("#footer_notification_cont").css("opacity",1):$("#footer_notification_cont").css("opacity",0.3);title_notification_count=
0;update_title_notification_count();$(this).hasClass("new_follow")?(b=$(this).attr("username"),window.location.href="/#!/"+b+"/"):window.location.href="/#!/nomination/"+b+"/";$(this).css({opacity:0});setTimeout(function(){$(a).remove()},350)});
mobile||$(".notification_popup").live("mouseover mouseout",function(a){var b=this;"mouseover"==a.type?(clearTimeout(notification_popup_fade_timeout),clearTimeout(notification_popup_remove_timeout)):notification_popup_fade_timeout=setTimeout(function(){$(b).css({opacity:0});notification_popup_remove_timeout=setTimeout(function(){$(b).remove()},350)},7500)});
$(".close_notification").live("click",function(a){var b=$(this).parent();$(b).css({opacity:0});setTimeout(function(){$(b).remove()},350);a.stopPropagation();return!1});function update_title_notification_count(){0<title_notification_count?$("title").text("Portrit ("+title_notification_count+")"):$("title").text("Portrit")}
function update_follow_count(){if(0<$("#profile_followers_count_cont").length&&selected_user.fid==me.id){var a=parseInt($("#profile_followers_count_cont h3").text());$("#profile_followers_count_cont h3").text(a+1)}}var title_notification_count=0;
function update_notifications(a,b){var c="",d="",e="",f="",g="";title_notification_count+=1;update_title_notification_count();"undefined"!=typeof a.nomination_category&&(e=a.nomination_category.replace(" ","_").toLowerCase());g="";a.photo&&(g='<img src="'+a.photo.crop_small+'"/>');"new_nom"==b&&(d=a.nominator==me.id?"You":a.nominator_username,c='<div class="notification_popup_cont color_transition nom_cat_'+e+'" name="'+e+'" value="'+a.id+'" read="false" id="notification_'+a.notification_id+'" onclick="void(0)">'+
g+'<div class="notification_text_cont white_back"><p class="strong" style="">'+d+'</p><span> nominated your photo.</span><p class="time">Right now</p><div class="clear"></div></div><div class="kill_notification close_img '+close_size+'" value="'+a.notification_id+'" style="display:none;"></div></div>');"tagged_nom"==b?(d=a.nominator_username,c='<div class="notification_popup_cont color_transition nom_cat_'+e+'" name="'+e+'" value="'+a.id+'" read="false" id="notification_'+a.notification_id+'" onclick="void(0)">'+
g+'<div class="notification_text_cont white_back"><p class="strong" style="">'+d+'</p><span> tagged you in a nomination.</span><p class="time">Right now</p><div class="clear"></div></div><div class="kill_notification close_img '+close_size+'" value="'+a.notification_id+'" style="display:none;"></div></div>'):"new_comment"==b?(d=a.comment_sender_id==me.id?"You":a.comment_sender_username,f=a.nom_owner_id==me.id?"your":a.nom_owner_username+"'s",c='<div class="notification_popup_cont color_transition nom_cat_'+
e+'" name="'+e+'" value="'+a.id+'" read="false" id="notification_'+a.notification_id+'" onclick="void(0)">'+g+'<div class="notification_text_cont white_back"><p class="strong" style="">'+d+"</p><span> commented on "+f+' photo.</span><p class="time">Right now</p><div class="clear"></div></div><div class="kill_notification close_img '+close_size+'" value="'+a.notification_id+'" style="display:none;"></div></div>'):"nom_won"==b?(d=a.nominatee==me.id?"Your":a.nominatee_name+"'s",c='<div class="notification_popup_cont color_transition nom_cat_'+
e+'" name="'+e+'" value="'+a.id+'" read="false" won="true" id="notification_'+a.notification_id+'" onclick="void(0)">'+g+'<div class="notification_text_cont white_back"><p class="strong" style="">'+d+'</p><span> photo won the </span><p class="strong" style="">'+a.nomination_category+'</p><span> trophy!</span><p class="time">Right now</p><div class="clear"></div></div><div class="kill_notification close_img '+close_size+'" value="'+a.notification_id+'" style="display:none;"></div></div>'):"new_follow"==
b&&(c=a.pending?c+('<div class="notification_popup_cont new_follow" value="'+a.follower_username+'" read="false" id="notification_'+a.id+'" onclick="void(0)"><div class="new_follow_icon notification_icon"></div><div class="notification_text_cont white_back color_transition new_follow"><div class="notification_pending_cont" value="'+a.notification_id+'"><span class="sick small notification_deny" value="deny">Deny</span><span class="sick small notification_accept" value="accept">Accept</span></div><p class="strong">'+
a.follower_username+'</p><span> would like to follow you.</span><p class="time">Right now</p><div class="clear"></div></div><div class="kill_notification close_img '+close_size+'" value="'+a.notification_id+'" style="display:none;"/></div></div>'):c+('<div class="notification_popup_cont new_follow" value="'+a.follower_username+'" read="false" id="notification_'+a.id+'" onclick="void(0)"><div class="new_follow_icon notification_icon"></div><div class="notification_text_cont white_back color_transition new_follow"><p class="strong">'+
a.follower_username+'</p><span> is now following you.</span><p class="time">Right now</p><div class="clear"></div></div><div class="kill_notification close_img '+close_size+'" value="'+a.notification_id+'" style="display:none;"/></div></div>'));$("#notification_footer_popup_cont").prepend(c);$("#footer_notification_cont").css({opacity:"1.0"});$("#footer_notification_cont > p").addClass("nom_cat_"+e+"_text");$("#notifications_empty").hide()}
function render_notifications(a){var b="",c="",d="",e="",f="",g=!0,h=null,j=null,k=[],h="";$("#notification_footer_popup_cont").append('<div id="notifications_empty" style="display:none;"><h2>You Have No Updates</h2></div>');if(a&&0<a.length)for(var i=0;i<a.length;i++)e="",c=a[i].source_id==me.id?"nom_won"==a[i].notification_type?"Your":"You":a[i].source_username,d=a[i].destination_id&&""!=a[i].destination_id?a[i].destination_id==me.id?"nom_won"==a[i].notification_type?"Your":"your":a[i].destination_username+
"'s":"Your",a[i].nomination_category?(f=a[i].nomination_category.replace(" ","_").toLowerCase(),a[i].read||(e="color_transition nom_cat_"+f,g&&($("#footer_notification_cont").css({opacity:"1.0"}),$("#footer_notification_cont > p").addClass("nom_cat_"+f+"_text"),g=!1))):"new_follow"==a[i].notification_type?!a[i].read&&g&&($("#footer_notification_cont").css({opacity:"1.0"}),$("#footer_notification_cont > p").addClass("nom_cat_"+f+"_text"),g=!1):e="",h=new Date,j=new Date(1E3*a[i].create_time),h-=j,
h/=1E3,h=secondsToHms(parseInt(h)),j="",a[i].photo&&(j='<img src="'+a[i].photo.crop_small+'"/>'),"new_nom"==a[i].notification_type?b+='<div class="notification_popup_cont nom_cat_'+f+'" name="'+f+'" value="'+a[i].nomination+'" read="'+a[i].read+'" id="notification_'+a[i].notification_id+'" time="'+a[i].create_time+'" onclick="void(0)">'+j+'<div class="notification_text_cont white_back '+e+'"><p class="strong">'+c+'</p><span> nominated your photo.</span><p class="time">'+h+'</p><div class="clear"></div></div><div class="kill_notification close_img '+
close_size+'" value="'+a[i].notification_id+'" style="display:none;"></div></div>':"new_comment"==a[i].notification_type?b+='<div class="notification_popup_cont nom_cat_'+f+'" name="'+f+'" value="'+a[i].nomination+'" read="'+a[i].read+'" id="notification_'+a[i].notification_id+'" time="'+a[i].create_time+'" onclick="void(0)">'+j+'<div class="notification_text_cont white_back '+e+'"><p class="strong">'+c+"</p><span> commented on "+d+' photo.</span><p class="time">'+h+'</p><div class="clear"></div></div><div class="kill_notification close_img '+
close_size+'" value="'+a[i].notification_id+'" style="display:none;"/></div></div>':"tagged_nom"==a[i].notification_type?b+='<div class="notification_popup_cont nom_cat_'+f+'" name="'+f+'" value="'+a[i].nomination+'" read="'+a[i].read+'" id="notification_'+a[i].notification_id+'" time="'+a[i].create_time+'" onclick="void(0)">'+j+'<div class="notification_text_cont white_back '+e+'"><p class="strong">'+c+'</p><span> tagged you in a nomination.</span><p class="time">'+h+'</p><div class="clear"></div></div><div class="kill_notification close_img '+
close_size+'" value="'+a[i].notification_id+'" style="display:none;"></div></div>':"nom_won"==a[i].notification_type?b+='<div class="notification_popup_cont nom_cat_'+f+'" name="'+f+'" value="'+a[i].nomination+'" read="'+a[i].read+'" id="notification_'+a[i].notification_id+'" won="true" time="'+a[i].create_time+'" onclick="void(0)">'+j+'<div class="notification_text_cont white_back '+e+'"><p class="strong">'+d+'</p><span> photo won the </span><p class="strong">'+a[i].nomination_category+'</p><span> trophy!</span><p class="time">'+
h+'</p><div class="clear"></div></div><div class="kill_notification close_img '+close_size+'" value="'+a[i].notification_id+'" style="display:none;"/></div></div>':"new_follow"==a[i].notification_type&&(a[i].read||(e="color_transition new_follow"),b=a[i].pending?b+('<div class="notification_popup_cont new_follow" value="'+a[i].source_username+'" read="'+a[i].read+'" id="notification_'+a[i].notification_id+'" time="'+a[i].create_time+'" onclick="void(0)"><div class="new_follow_icon notification_icon"></div><div class="notification_text_cont white_back '+
e+'"><div class="notification_pending_cont" value="'+a[i].notification_id+'"><span class="sick small notification_deny" value="deny">Deny</span><span class="sick small notification_accept" value="accept">Accept</span></div><p class="strong">'+c+'</p><span> is now following you.</span><p class="time">'+h+'</p><div class="clear"></div></div><div class="kill_notification close_img '+close_size+'" value="'+a[i].notification_id+'" style="display:none;"/></div></div>'):b+('<div class="notification_popup_cont new_follow" value="'+
a[i].source_username+'" read="'+a[i].read+'" id="notification_'+a[i].notification_id+'" time="'+a[i].create_time+'" onclick="void(0)"><div class="new_follow_icon notification_icon"></div><div class="notification_text_cont white_back '+e+'"><p class="strong">'+a[i].source_username+'</p><span> is now following you.</span><p class="time">'+h+'</p><div class="clear"></div></div><div class="kill_notification close_img '+close_size+'" value="'+a[i].notification_id+'" style="display:none;"/></div></div>'));
else $("#notifications_empty").show();k&&0<k.length&&render_publish_story(k);$("#notification_footer_popup_cont").append(b)}
function render_share_wins(a){var b="",c="",b="trophies";1==a.length&&(b="trophy");for(var b='<div id="share_win_cont"><h1>Congratulations!</h1><p>You have won '+a.length+" "+b+' since your last visit.</p><div id="trophy_cont">',d=0;d<a.length;d++)b+='<div class="share_trophy_cont"><img src="'+a[d].photo.crop+'"/><div class="trophy_img medium '+a[d].nomination_category.replace(" ","_").toLowerCase()+'"></div></div>',c+=a[d].notification_id+",";b+='</div><h2>Share Your Trophies</h2><div id="caption_cont"><textarea class="inactive" id="share_nom_comment" value="Caption">Caption</textarea><p id="text_remail_cont">0/140</p></div><div id="share_bottom_cont"><div id="share_options_cont"><div class="share_service"><img src="http://portrit.s3.amazonaws.com/img/f_logo.png"><h1>Facebook</h1><div id="share_facebook" class="switch switch_off" value="on" name="facebook"></div><div class="clear"></div></div><div id="share_mid"></div><div class="share_service"><img src="http://portrit.s3.amazonaws.com/img/twitter_logo.png"><h1>Twitter</h1><div id="share_twitter" class="switch switch_off" value="on" name="twitter"></div><div class="clear"></div></div></div><div class="clear"></div><div id="share_row_cont"><a id="post_share" class="sick large off" style="color: #99CB6E;">Share</a><a id="cancel_share" class="sick large">Cancel</a><div class="clear"></div></div></div>';
$("#context_overlay_cont").addClass("publish_share_win");$("#context_overlay_cont > div").append(b);show_context_overlay(!0);$.post("/notification_read/",{notification_ids:c},function(){});$("#share_row_cont #cancel_share").bind("click",function(){close_context_overlay()});$("#share_row_cont #post_share").bind("click",function(){if(!1==$(this).hasClass("off")){var a=$("#share_nom_comment").val(),c="http://www.portrit.com/#!/"+me.username+"/trophies/all/",b=winning_notification_data[0].photo.crop_small;
"Caption"==a&&(a="");$("#share_twitter").hasClass("switch_on")&&share_on_twitter(a,c);if($("#share_facebook").hasClass("switch_on")){var d=me.name.split(" ")[0]+" won new trophies on Portrit";share_on_facebook(d,a,c,b)}close_context_overlay()}});$("#share_win_cont .switch").live("click",function(){$("#share_twitter").hasClass("switch_on")||$("#share_facebook").hasClass("switch_on")?$("#post_share").removeClass("off"):$("#post_share").addClass("off")})}
function render_publish_story(a){for(var b="",c="",d="",e="",f="",f=me.name.split(" ")[0],d=0;d<a.length;d++)b=a[d].cat.replace(" ","_").toLowerCase(),c=d+1<a.length?c+(a[d].notification_id+","):c+a[d].notification_id;1==a.length?(d=f+" won the "+a[0].cat+" trophy for their rockin' photo!",e="http://portrit.s3.amazonaws.com/img/invite/"+b+".png"):(d=f+" won "+a.length+" trophies for their rockin' photos!",e="http://portrit.s3.amazonaws.com/img/invite/blank.png");FB.ui({method:"feed",name:d,link:"http://portrit.com/#!/nom_id="+
a[0].nom_id+"/ref=facebook",picture:e,caption:"Click the trophy to see "+f+"'s winning photos."},function(a){a&&a.post_id?"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Nom Won","Shared",""]):"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Nom Won","Not Shared",""]);$.post("/notification_read/",{notification_ids:c},function(){})})}
$(".notification_popup_cont").live("click",function(){var a=$(this).attr("value"),b=$(this).attr("read");$(this).attr("won");var c=$(this).attr("id").replace("notification_","");if("false"==b||!1==b||0==b||"0"==b)$(this).attr("read","true"),$.post("/notification_read/",{notification_id:c},function(){});window.location.href=$(this).hasClass("new_follow")?"/#!/"+a+"/":"/#!/nomination/"+a+"/"});
$(".notification_popup_cont").live("mouseover mouseout",function(a){var b=$(this).attr("name");"mouseover"==a.type?($(".notification_text_cont",this).removeClass("white_back").addClass("nom_cat_"+b).removeClass("color_transition"),$(this).css({color:"white"}),$(this).find("p").css({color:"white"}),$(this).find(".kill_notification").show()):($(".notification_text_cont",this).removeClass("nom_cat_"+b).addClass("white_back"),$(this).css({color:""}),$(this).find("p").css({color:""}),$(this).find(".kill_notification").hide())});
$(".kill_notification").live("click",function(a){$(this).parent().attr("read");var b=$(this).attr("value");$.post("/notification_read/",{notification_id:b,kill:!0},function(){});$(this).parent().remove();a.stopPropagation();return!1});
$("#clear_all_notifications").live("click",function(a){var b="";$(".notification_popup_cont").each(function(){b+=$(this).attr("id").replace("notification_","")+","});""!=b&&$.post("/notification_read/",{notification_ids:b,kill:!0},function(){});$(".notification_popup_cont").remove();$("#notifications_empty").show();a.stopPropagation();return!1});var footer_notification_shown=!1,footer_show_first=!0,notification_scroller=null;
$("#footer_notification_cont").live("click",function(){if(footer_notification_shown)$("#wrapper").die("click"),$("#clear_all_notifications").hide(),$("#footer").css({"overflow-y":"hidden"}),$(this).css({opacity:"0.3"}),$("#notification_popup").show().css({opacity:"0.0"}),mobile?(notification_scroller&&notification_scroller.destroy(!1),$("#notification_footer_popup").hide()):$("#notification_footer_popup").fadeOut("fast"),footer_notification_shown=!1;else{title_notification_count=0;update_title_notification_count();
$(this).css({opacity:"1.0"});$(this).children().filter("p").attr("class","");$("#footer").css({"overflow-y":"visible"});mobile?$("#notification_footer_popup").show():$("#notification_footer_popup").fadeIn("fast");$("#notification_popup").show().css({opacity:"1.0"});var a=$('.notification_popup_cont[read="false"]');if(0<a.length){var b="";setTimeout(function(){$(a).each(function(){var a=$(this).attr("read",!0).attr("name");b+=$(this).attr("id").replace("notification_","")+",";$(this).removeClass("nom_cat_"+
a)});$.post("/notification_read/",{notification_ids:b},function(){})},100)}var c=new Date,d=null,e=null;$(".notification_popup_cont").each(function(){e=$(this).attr("time");e=new Date(1E3*e);d=c-e;d/=1E3;time_str=secondsToHms(parseInt(d));$(this).find(".time").text(time_str)});0<$(".notification_popup_cont").length&&$("#clear_all_notifications").show();mobile&&(notification_scroller=new iScroll("notification_scroller"));$("#wrapper").live("click",function(){footer_notification_shown=!0;$("#footer_notification_cont").click()});
footer_show_first=!1;footer_notification_shown=!0}});var tut_on=!1;
function render_tut(a){function b(){var a="";0==c?a="red":1==c?a="orange":2==c?a="yellow":3<=c&&(a="green");return a}if(a){$("#activate_tut").css("opacity",1);$(document).bind("click",toggle_tut);tut_on=!0;var c=0,d="",e="",c=3-a.nom_count,d=b(c);3<=c?(c=3,e='<div class="tut_completed_checkmark"></div>'):e="";$("#nomination_tut").html('<h3><span class="strong">Nominate</span> 3 friend\'s photos</h3><p class="'+d+'_back">'+c+"/3 Completed</p>"+e).attr("count",c);c=3-a.vote_count;d=b(c);3<=c?(c=3,e=
'<div class="tut_completed_checkmark"></div>'):e="";$("#vote_count_tut").html('<h3><span class="strong">Vote</span> on 3 friend\'s nominations</h3><p class="'+d+'_back">'+c+"/3 Completed</p>"+e).attr("count",c);c=3-a.comment_count;d=b(c);3<=c?(c=3,e='<div class="tut_completed_checkmark"></div>'):e="";$("#comment_count_tut").html('<h3><span class="strong">Comment</span> on 3 friend\'s nominations</h3><p class="'+d+'_back">'+c+"/3 Completed</p>"+e).attr("count",c);setTimeout(function(){$("#tutorial_cont").fadeIn()},
1E3);$("#tutorial_cont").bind("click",function(){return!1});$("#activate_tut").bind("click",toggle_tut);$("#skip_tut").bind("click",function(){$.post("/skip_tut/",function(){});hide_tut();$("#activate_tut").remove();tut_on=!1})}else $("#tutorial_cont").remove()}
function update_tut(a){function b(a){var c="";0==a?c="red":1==a?c="orange":2==a?c="yellow":3<=a&&(c="green");return c}var c=0,d="",e=!0,f=!0,g=!0;"nom"==a?(c=parseInt($("#nomination_tut").attr("count")),d=b(c+1),c+=1,3==c&&$("#nomination_tut").append('<div class="tut_completed_checkmark"></div>'),3<=c&&(c=3),$("#nomination_tut > p").text(c+"/3 Completed").removeClass().addClass(d+"_back").parent().attr("count",c)):"vote"==a?(c=parseInt($("#vote_count_tut").attr("count")),d=b(c+1),c+=1,3==c&&$("#vote_count_tut").append('<div class="tut_completed_checkmark"></div>'),
3<=c&&(c=3),$("#vote_count_tut > p").text(c+"/3 Completed").removeClass().addClass(d+"_back").parent().attr("count",c)):"comment"==a&&(c=parseInt($("#comment_count_tut").attr("count")),d=b(c+1),c+=1,3==c&&$("#comment_count_tut").append('<div class="tut_completed_checkmark"></div>'),3<=c&&(c=3),$("#comment_count_tut > p").text(c+"/3 Completed").removeClass().addClass(d+"_back").parent().attr("count",c));$("#activate_tut").css("opacity",1);c=parseInt($("#nomination_tut").attr("count"));3>c&&(e=!1);
c=parseInt($("#vote_count_tut").attr("count"));3>c&&(f=!1);c=parseInt($("#comment_count_tut").attr("count"));3>c&&(g=!1);e&&f&&g&&(tut_on=!1,$("#context_overlay_cont").addClass("tut_completed_overlay"),$("#context_overlay_cont > div").append('<h1>Congratulations!</h1><h2>You have just completed the tutorial.</h2><div id="tut_completed_middle"><img src="http://portrit.s3.amazonaws.com/img/tutorial_graphic.png"/><div class="tut_check_completed"><div class="green_checkmark"></div><p>You nominated 3 of your friend\'s photos.</p><div class="clear"></div></div><div class="tut_check_completed"><div class="green_checkmark"></div><p>You voted on 3 of your friend\'s nominations.</p><div class="clear"></div></div><div class="tut_check_completed"><div class="green_checkmark"></div><p>You commented on 3 of your friend\'s nominations.</p><div class="clear"></div></div></div><h3>You now know how to use Portrit.</h3><h3>Go nominate, vote, comment, and have fun!</h3><span id="tut_completed_go" class="sick large">Continue</span>'),
show_context_overlay(!0),$("#activate_tut").fadeOut(),$("#tut_completed_go").bind("click",function(){$("#tut_completed_go").unbind("click");close_context_overlay()}))}function toggle_tut(){if($("#tutorial_cont").is(":hidden"))return show_tut(),$("#activate_tut").css("opacity",1),$(document).bind("click",toggle_tut),!1;hide_tut();$("#activate_tut").css("opacity",0.3);$(document).unbind("click",toggle_tut)}function show_tut(){$("#tutorial_cont").fadeIn()}
function hide_tut(){$("#tutorial_cont").fadeOut()}
function attach_initial_tut_handlers(a){$("#tut_go_cont span").live("click",function(){var c=this,b=$("#username").val();if((""!=b||"Create a Username"!=b)&&0==$("#username_taken").length&&alphaNumericCheck(b)){$(this).text("Saving...");var e=!1;$("#allow_portrit_album").hasClass("switch_on")&&(allow_portrit_album=e=!0);var f=!1;$("#allow_notifications").hasClass("switch_on")&&(email_on_win=email_on_nomination=email_on_follow=f=!0);$.post("/api/add_username/",{username:b,access_token:fb_session.access_token,
post_wins:e,email_notifications:f},function(e){!1!=e?(my_username=b,$("#initial_tut_cont").fadeOut(function(){$(this).remove();(!mobile||tablet)&&render_tut(a);init_view();"#!/community/"==window.location.hash?update_view():window.location.href="/#!/community/"}),$("#wrapper").animate({opacity:"1.0"},350,function(){$(this).css("min-height","100%")}),$("#tut_go_cont span").die("click"),$("#allow_notifications, #allow_portrit_album").die("click"),$("#username").unbind("focus"),$("#username").unbind("unblur"),
$("#username").unbind("keyup")):$(c).text("Submit")})}});$("#allow_notifications, #allow_portrit_album").live("click",function(){var a=!1,b=$(this).attr("value");$(this).hasClass("switch_on")?("fb_auto_post"==b?allow_notifications=!0:"portrit_album"==b&&(allow_portrit_album=!0),a=!0):("fb_auto_post"==b?allow_notifications=!1:"portrit_album"==b&&(allow_portrit_album=!1),a=!1);$.post("/change_user_permissions/",{permission:b,check:a},function(){})});$("#username").bind("focus",function(){disable_search=
!0;$(this).css("color","#444");if(this.value==this.defaultValue)this.value="";this.value!=this.defaultValue&&this.select()});$("#username").bind("blur",function(){disable_search=!1;if(""==$.trim(this.value))$(this).css("color","#999"),this.value=this.defaultValue?this.defaultValue:""});$("#username").bind("keydown",function(a){if(16<$(this).val().length&&8!=a.keyCode)return!1});var b=null;$("#username").bind("keyup",function(){var a=$(this).val();if(16<a.length)return!1;clearTimeout(b);$(".cross").remove();
$(".check").remove();$("#username_load").remove();$("#username_taken").remove();""!=a?alphaNumericCheck(a)?(0==$("#username_load").length&&$("#username").parent().append('<img id="username_load" src="http://portrit.s3.amazonaws.com/img/ajax-loader-light.gif"/>'),b=setTimeout(function(){a=$("#username").val();""!=a&&alphaNumericCheck(a)?$.post("/api/check_username_availability/",{username:a},function(a){$("#username_load").remove();!0==a?($("#username_aval").remove(),0==$("#username_taken").length&&
($("#username").parent().append('<div class="cross" id="username_taken"></div>'),0==$("#username_taken_text").length&&$("#username").parent().append('<p id="username_taken_text">We\'re sorry, but this username is already taken.</p>'))):($("#username_taken").remove(),$("#username_taken_text").remove(),0==$("#username_aval").length&&$("#username").parent().append('<div class="check" id="username_aval"></div>'))}):!alphaNumericCheck(a)&&""!=a?($("#username_load").remove(),$("#username_taken").remove(),
$("#username_taken_text").remove(),$("#username_aval").remove(),0==$("#username_taken").length&&$("#username").parent().append('<div class="cross" id="username_taken"></div>')):($("#username_load").remove(),$("#username_taken").remove(),$("#username_taken_text").remove(),$("#username_aval").remove())},500)):($("#username_aval").remove(),0==$("#username_taken").length&&$("#username").parent().append('<div class="cross" id="username_taken"></div>')):($("#username_taken").remove(),$("#username_taken_text").remove(),
$("#username_aval").remove())})}
function render_initial_tutorial(a){$("#wrapper").css({opacity:"0.3"});$("body").append('<div id="initial_tut_cont"><div id="initial_tut_wrap"><div id="initial_tut_top_wrap"><h1>Getting Started!</h1><div class="tut_point"><h2 class="tut_point_num nom_cat_fail">1</h2><div><input id="username" value="Create a Username"/><p style="color: #666; font-size: 14px; margin-left: 5px; float: left;">No spaces and only alphanumeric characters please</p><div class="clear"></div></div></div><div class="tut_point"><h2 class="tut_point_num nom_cat_lol">2</h2><div><h3>Check Out the Nominations</h3><p>Once you click the submit button below, you will be taken to your personal stream. This will show you all active nominations by your followers. If you find your friends borring or maybe you don\'t have any, try looking through the community section. The community section is where you can see what everyone on Portrit is nominating.</p></div><div class="clear"></div></div><div class="tut_point" style="margin-bottom: 30px;"><h2 class="tut_point_num nom_cat_party_animal">3</h2><div><h3>Compete with Your Followers</h3><p>Got amazing photos? Earn trophies for your hard work. Post a photo and nominate it for one of the 10 trophies to compete with your followers. Don\'t sweat it if someone has a better photo, nominations restart every night at 12AM(PST).</p><div class="clear"></div></div><div class="clear"></div></div><div id="allow_notifications_cont"><label for="allow_notifications">Allow Portrit to notify me through email: </label><div id="allow_notifications" value="fb_auto_post" class="switch switch_on"></div><div class="clear"></div></div><div id="allow_portrit_album_cont"><label for="allow_portrit_album">Allow Portrit to post my winning trophies back to Facebook: </label><div id="allow_portrit_album" value="portrit_album" class="switch switch_on"></div><div class="clear"></div></div></div><div id="initial_tut_bottom_wrap"><div id="tut_go_cont"><span class="sick large">Submit</span></div></div></div></div>');(!mobile||
tablet)&&860>$(window).height()&&$("#wrapper").css("min-height",860);attach_initial_tut_handlers(a)}var notification_data=null,winning_notification_data=null,allow_notifications=!0,allow_public_follows=!0,allow_portrit_album=!1,email_on_follow=!1,email_on_nomination=!1,email_on_win=!1,email="",server_login_timeout=null,render_perms_context=!1,first_visit=!1,vote_tooltip_on=!1,my_username="",twitter_access_token="",first_tuts_on=!1,first_tuts_sections={stream:!0,community:!0,profile:!0,detail:!0,gallery:!0};
function login_fb_user(){$("#cont").prepend('<div class="loading"><h1>Portrit Loading...</h1><div id="loader"><img src="http://portrit.s3.amazonaws.com/img/album-loader-dark.gif"/></div></div>');setTimeout(render_server_dead,15E3);$.post("/login_fb_user/",function(a){$(".loading").remove();clearTimeout(server_login_timeout);if(a){var b=null,c=!1;notification_data=a.notifications;winning_notification_data=a.winning_notifications;b=a.tut_counts;vote_tooltip_on=first_visit=c=a.first;allow_portrit_album=
a.allow_winning_fb_album;allow_public_follows=a.allow_public_follows;email_on_follow=a.email_on_follow;email_on_nomination=a.email_on_nomination;email_on_win=a.email_on_win;email=a.email;twitter_access_token=a.twitter_access_token;my_username=a.username;if(c){if(!mobile||tablet)first_tuts_on=!0,$("#wrapper").after('<div id="first_tuts_cont" style="display:none;"><div id="tuts_wrap"></div></div>');$("#app_download").after('<div id="activate_tut"><div id="tutorial_cont" style="display:none;"><div id="tut_arrow"></div><h1>Tutorial</h1><div id="tut_section_wrap"><div class="tut_section" id="nomination_tut"></div><div class="tut_section" id="vote_count_tut"></div><div class="tut_section" id="comment_count_tut"></div></div><a id="skip_tut" class="sick large">Skip</a></div></div>');
render_initial_tutorial(b)}else{if(b&&(!mobile||tablet))$("#app_download").after('<div id="activate_tut"><div id="tutorial_cont" style="display:none;"><div id="tut_arrow"></div><h1>Tutorial</h1><div id="tut_section_wrap"><div class="tut_section" id="nomination_tut"></div><div class="tut_section" id="vote_count_tut"></div><div class="tut_section" id="comment_count_tut"></div></div><a id="skip_tut" class="sick large">Skip</a></div></div>'),render_tut(b);init_view(update_view)}}})}
function render_server_dead(){$(".loading > h1").after('<div id="server_down" style="display:none;"><h2>We\'re sorry, looks like our servers are taking a much needed coffee break.</h2><h3>Please give us another chance and refresh your browser.</h3></div>');$(".loading > h1").hide();$("#server_down").fadeIn()}function load_friend_dict(a){for(var b=0;b<a.length;b++)friends[a[b].id]=a[b],friends[a[b].id].hidden=!1}
function load_friend_array(a){for(var b in a)friend_array.push({name:a[b].name,id:b})}function init_view(a){void 0!==window.sessionStorage&&(me=sessionStorage.getItem("me"));null===me?FB.api("/me",function(b){void 0!==window.sessionStorage&&sessionStorage.setItem("me",JSON.stringify(b));me=b;me.username=my_username;wait_for_message();load_user_data();"undefined"!=typeof a&&a()}):(me=JSON.parse(me),me.username=my_username,wait_for_message(),load_user_data(),"undefined"!=typeof a&&a())}
function show_search_view(){search_active=!0;$("#search").show();$("#wrapper").css({opacity:"0.3"});$("#query").focus();"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Search","Shown",""]);$(document).bind("click",hide_search_view)}function hide_search_view(){$(document).unbind("click",hide_search_view);$("#results").html("");$("#search").hide();$("#wrapper").css({opacity:"1.0"});$("#query").val("");query_cache={};prev_query="";search_active=!1}
function load_user_data(){$("#profile_pic").html('<a href="/#!/'+me.username+'"><img src="https://graph.facebook.com/'+me.id+'/picture?type=square"/></a>');$("#profile_pic").after('<img src="http://static.ak.fbcdn.net/images/connect_favicon.png"/>')}
function render_public_header(){$("#public_header").html('<div id="public_logo_wrap"><a href="/"><img src="http://portrit.s3.amazonaws.com/img/logo_blank.png"/></a></div><div id="public_tagline_cont"><div class="left_triangle"></div><p id="tagline_main">Snap, nominate, vote, and earn wherever you go with the <a href="http://itunes.apple.com/us/app/portrit/id435873942?mt=8&amp;ls=1" target="_blank"><strong>Portrit iPhone app.</strong></a></p></div><a target="_blank" href="http://itunes.apple.com/us/app/portrit/id435873942?mt=8&amp;ls=1" target="_blank"><img style="height: 53px; width: 153px; margin-top: 19px;" src="http://portrit.s3.amazonaws.com/img/app_store_badge.png"></a><div id="public_login_cont" style="background-image: -webkit-gradient(linear, left bottom, left top, color-stop(0.04, rgb(173,173,173)), color-stop(0.7, rgb(250,250,250)));"><div id="public_login_wrap"><a id="login" class="fb_button fb_button_large"><span class="fb_button_text">Login with Facebook</span></a><p>Simply click Login with Facebook.</p></div></div><div class="clear"></div>');$("#header").show().addClass("public");
$("#cont").append('<p class="public_tooltip"></p>')}function attach_public_handlers(){$("#login").bind("click",login_user);$("#add_new_comment, .flag_photo, #nominate").live("mouseover mouseout",function(a){"mouseover"==a.type?show_public_tooltip(this):hide_public_tooltip()})}
function init_public_view(){public_view=!0;global_hash_tag=window.location.hash;fb_session=null;$("#login_cont").remove();$("#wrapper").css({background:"none"});$("#login").unbind("click");$(".footer_hover").unbind("click");$("#header").show();$("#login_loader").show();watch_hashtag_interval=setInterval(watch_hashtag,75);render_public_header();attach_public_handlers();update_view()}
function stream_nav_click(){if("stream"!=stream_view)"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Recent Noms","Shown",""]),window.location.href="/#!/"}function community_nav_click(){if("community"!=stream_view)"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Recent Winners","Shown",""]),window.location.href="/#!/community/"}
function profile_nav_click(){if("profile"!=stream_view)"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Profile","Shown",""]),"profile_user"==stream_view&&$("#profile_cont_wrap").html(""),window.location.href="/#!/"+me.username+"/"}var added_swipe_once=!1;
function main_view(){view_active="main";selected_album_id=selected_user="";photo_comment_cache={};var a="";$("#user_profile_cont").remove();$(".friend").remove();mobile||(a='<li id="show_upload"><h1>Post Photo</h1></li>');0==$("#wall_cont #profile_wrap").length&&($("#wall_cont").hide(),$("#wall_cont").append('<div id="profile_wrap"><ul><li><h1 id="active_stream_view" class="stream_nav selected" name="stream">Stream</h1></li><li><h1 id="activate_community" class="stream_nav" name="community">Community</h1></li><li><h1 id="activate_profile" class="stream_nav" name="profile">Profile</h1></li>'+
a+'<div class="clear"></div></ul><div class="clear"></div><div id="profile_cont_wrap"></div></div>'),$("#wall_cont").show());init_stream_view();$("#wall_cont").show();$("#friend_cont").show()}function create_nom_cache(a){for(var b=0;b<a.length;b++)nom_cache[a[b].id]=a[b]}var nom_cache={};
function nom_detail_view(a,b){view_active="nom_detail";var c=null,d="",e="",f=null,g="",h=e="",j="",h="",j="Already voted",k="",i="",o="",m="";create_nom_cache(a);(c=nom_cache[selected_nom])||(c=a[0]);d=c.nomination_category;e=get_cat_under(d);"stream_active"==b?(k='<h1 class="title" state="'+b+'" cat="'+d+'">Active <span class="nom_cat_'+e+'_text">'+d+"</span> Photos</h1>",c.position&&(i='<h2 id="nom_place">'+getGetOrdinal(c.position+1)+"</h2>")):"stream_winners"==b?(h="won",j="Already won",k='<h1 class="title" state="'+
b+'" cat="'+d+'">Winning Photos</h1>'):"community_active"==b?(k='<h1 class="title" state="'+b+'" cat="'+d+'">Community <span class="nom_cat_'+e+'_text">'+d+"</span> Photos</h1>",c.position&&(i='<h2 id="nom_place">'+getGetOrdinal(c.position+1)+"</h2>")):"community_top"==b?(k='<h1 class="title" state="'+b+'" cat="'+d+'">Top Community <span class="nom_cat_'+e+'_text">'+d+"</span> Photos</h1>",c.position&&(i='<h2 id="nom_place">'+getGetOrdinal(c.position+1)+"</h2>")):"profile_trophies"==b?(h="won",j=
"Already won",k='<h1 class="title" state="'+b+'" cat="'+d+'"><a href="/#!/'+c.nominatee_username+'/">'+c.nominatee_username+"'s</a> Winning Photos</h1>"):k="profile_active"==b?'<h1 class="title" state="'+b+'" cat="'+d+'"><a href="/#!/'+c.nominatee_username+'/">'+c.nominatee_username+"'s</a> Active Nominations</h1>":'<h1 class="title" state="'+b+'" cat="'+d+'"><a href="/#!/'+c.nominatee_username+'/">'+c.nominatee_username+"'s</a> Photo</h1>";if(1<a.length){for(var g='<div id="nom_cat_stream"><div class="prev_photo"><div class="prev_photo_img"></div></div><div class="next_photo"><div class="next_photo_img"></div></div>',
l=0;l<a.length;l++)f=a[l],g=f.id==c.id?g+('<div id="nom_photo_'+f.id+'" class="nom_photo_thumbnail" style="opacity: 1.0;" name="selected"><img src="'+f.photo.crop_small+'"/></div>'):g+('<div id="nom_photo_'+f.id+'" class="nom_photo_thumbnail" style="opacity: 0.6;"><img src="'+f.photo.crop_small+'"/></div>');g+="</div>"}else g="";f="active";l='<div id="vote_cont_right"><p class="tooltip"></p><div class="vote_arrow"></div><span class="vote vote_up '+h+'" value="'+c.id+'" name="'+j+'"></span><span class="vote vote_down '+
h+'" value="'+c.id+'" name="'+j+'"></span></div>';c.won?(h="Won",f="won",l=""):h=c.active?"Nominated for":"Lost";var n="",n=c.caption?"Caption: "+c.caption.replace(/(\r\n|\n|\r)/gm,""):"No caption provided";0<c.tagged_users.length&&(o='<div class="tagged_users" nom="'+c.id+'"><span>'+c.tagged_users.length+' Tagged</span><div class="tag"></div></div>');public_view&&(m="off");j="large";mobile&&!tablet&&(j="medium");var p="";now=new Date;time=new Date(1E3*c.created_time);p=(now-time)/1E3;$("#main_nom_photo_post_time").html(secondsToHms(p));
$("#nom_detail_cont .title").remove();$("#nom_detail_cont").prepend(k);$("#main_nom_cont").attr("value",c.id);$("#main_nom_photo").attr("src",c.photo.source);$("#main_nom_cont_left_wrap").append(i);$("#nominator_overlay_cont").html("<p>"+n+"</p>"+o);$("#nominatee_cont").html('<a href="/#!/'+c.nominatee_username+'/"><img class="user_img" src="https://graph.facebook.com/'+c.nominatee+'/picture?type=square"/></a><div id="nomination_text_cont"><a href="/#!/'+c.nominatee_username+'/"><span class="strong">'+
c.nominatee_username+"</span></a><p>"+h+"</p><h3>"+d+"</h3></div>");$("#trophy_cont").html('<div id="nom_trophy_icon" class="trophy_img '+j+" "+e+'"></div>');$("#vote_cont").html('<div id="vote_cont_left" class="'+f+" nom_cat_"+e+'"><h3>Votes</h3><h2 id="nom_vote_count">'+c.vote_count+"</h2></div>"+l+'<div class="clear"></div>');e='<div id="main_nom_bottom_cont"><div id="nom_comments_cont"><div id="comment_heading_cont"><p class="tooltip"></p><span class="sick large '+m+'" id="add_new_comment">Comment</span><div class="flag flag_photo '+
m+'" nom_id="'+c.id+'"></div><div class="clear"></div></div><div id="new_comment_cont"><div class="comment_top_head"><span class="sick large post_new_comment" value="'+c.id+'">Post</span><span class="sick large cancel_new_comment">Close</span></div><textarea class="comment_body"></textarea></div></div><div id="nom_votes_cont"><h2 id="voted_heading">Voted</h2><div id="nom_votes_wrap" class="voted_cont"><p class="tooltip"></p></div>';$("#nom_detail_cont").append(g+e);slide_images=$(".nom_photo_thumbnail");
var q=[],r=0,s=0,u=!1,d=$("#nom_cat_stream").width()/2;$(slide_images).each(function(){s=100;"selected"===$(this).attr("name")?(r+=s/2,u=!0):!1===u&&(r+=s+20);q.push(s+20)});var t=0,v=d-r;$(slide_images).each(function(a){$(this).css({left:t+v,top:0});t+=q[a]});first_visit&&vote_tooltip_on&&$("#vote_cont").append('<p id="vote_tooltip">Click the arrows to cast your <span class="strong">vote<span>.<span class="vote_tooltip_arrow"></span></p>');get_nom_comments(c.id);render_nom_votes(c,c.votes)}
var get_comment_timeout=null;function get_nom_comments(a){0==$("#loader").length&&append_load($("#nom_comments_cont"),"light");clearTimeout(get_comment_timeout);get_comment_timeout=setTimeout(function(){$.getJSON("/api/get_comments/",{nom_id:a},function(a){remove_load();render_nom_comments(a)})},300)}
function render_nom_votes(a,b){for(var c="",d=!1,e=0;e<b.length;e++)c+='<a href="/#!/'+b[e].vote_username+'/" id="voted_'+b[e].vote_username+'" name="'+b[e].vote_username+'"><img src="https://graph.facebook.com/'+b[e].vote_user+'/picture?type=square"/></a>',me&&b[e].vote_user==me.id&&(d=!0);public_view?$(".vote").addClass("won").attr("name","Login to vote"):a.won?$(".vote").addClass("won").attr("name","Already won"):d?$(".vote").addClass("won").attr("name","Already voted"):$(".vote").removeClass("won");
$("#nom_votes_wrap").append(c)}
function render_nom_comments(a){var b="",c=null,d=null,c="";if(0<a.length){$("#comments_empty").remove();for(var e=0;e<a.length;e++)d=new Date,c=new Date(1E3*a[e].create_datetime),d-=c,d/=1E3,d=secondsToHms(parseInt(d)),c=a[e].owner_username,me&&c==me.username&&(c="You"),b+='<div class="comment"><p class="comment_time" value="'+a[e].create_datetime+'">'+d+'</p><a href="/#!/'+a[e].owner_username+'/"><img class="user_photo" src="https://graph.facebook.com/'+a[e].owner_id+'/picture?type=square"/></a><a href="/#!/'+
a[e].owner_username+'/" class="post_username from_username">'+c+"</a><p>"+a[e].comment+"</p></div>"}else 0==$("#comments_empty").length&&(b='<div id="comments_empty"><h3>No Comments</h2></div>');$("#nom_comments_cont").append(b)}
function update_vote_count(a){if(a){var b=a.nom_id,c="";"stream_active"==view_active?$(".nom_vote_"+b).find("h2").text("Votes: "+a.vote_count):"nom_detail"==view_active&&$("#main_nom_cont").attr("value")==b&&($("#nom_vote_count").text(a.vote_count),c='<a href="/#!/='+a.vote_username+'/" id="voted_'+a.vote_user+'" name="'+a.vote_username+'"><img src="https://graph.facebook.com/'+a.vote_user+'/picture?type=square"/></a>',$("#nom_votes_wrap").append(c))}}
function append_load(a,b){0==$("#loader").length&&("light"==b?$(a).append('<div id="loader"><img src="http://portrit.s3.amazonaws.com/img/ajax-loader-light.gif"/></div>'):$(a).append('<div id="loader"><img src="http://portrit.s3.amazonaws.com/img/album-loader-dark.gif"/></div>'))}function remove_load(a){"undefined"!==typeof a?$("#loader").animate({opacity:0},{duration:200,queue:!1,complete:function(){$(this).remove()}}):$("#loader").remove()}
function render_photo_list(a){var b="",c=!1;0==$("#photo_list_cont").length&&(c=!0,$("#recent_left_cont").append('<div id="photo_list_cont"></div>'));for(var d=0;d<a.length;d++)b='<div class="community_photo_cont" pid="'+a[d].photo.id+'" name="'+a[d].username+'"><img src="'+a[d].photo.crop+'" owner="'+a[d].username+'" pid="'+a[d].photo.id+'"/></div>',$("#photo_list_cont").append(b);c&&$("#photo_list_cont").append('<p class="tooltip"></p><div class="clear"></div>')}
function init_community_photos(){$("#recent_left_cont").html("");append_load($("#recent_left_cont"),"light");$.getJSON("/api/get_community_photos/",function(a){remove_load();render_photo_list(a)})}function get_more_community_photos(a){var b="";if(fb_session)b=fb_session.access_token;scroll_loading=!0;append_load($("#recent_left_cont"),"light");$.getJSON("/api/get_community_photos/",{pid:a,dir:"old",access_token:b},function(a){scroll_loading=!1;remove_load();render_photo_list(a,!0)})}
function get_stream_empty(){$.getJSON("/api/get_community_empty_nominations/",function(a){0<a.length&&($("#recent_left_cont").append('<h2 id="empty_exp">Recent Activity</h2>'),render_empty_overview_stream(a,$("#recent_left_cont")))})}
function init_community_active(){$("#recent_left_cont").html("");append_load($("#recent_left_cont"),"light");$.getJSON("/api/get_community_nominations/",function(a){remove_load();0<a.length?render_active_overview_stream(a,$("#recent_left_cont")):(empty_html='<div id="stream_empty"><h1>There are no <span class="strong">Community Nominations</span></h1><ul><li><h3>You can solve this by completing one of the following actions:</h3></li><li><p>Nominate one of your photos.</p></li><li><p>Nominate your friend\'s photos.</p></li><li><p>Nominate photos from the community.</p></li></ul><div class="clear"></div></div>',$("#recent_left_cont").append(empty_html),
get_stream_empty())})}function get_more_community_active(a){scroll_loading=!0;append_load($("#recent_left_cont"),"light");0==$("#stream_empty").length?$.getJSON("/api/get_community_nominations/",{id:a,dir:"old"},function(a){scroll_loading=!1;remove_load();render_active_overview_stream(a,$("#recent_left_cont"))}):$.getJSON("/api/get_community_empty_nominations/",{id:a,dir:"old"},function(a){scroll_loading=!1;remove_load();render_empty_overview_stream(a,$("#recent_left_cont"))})}
function init_community_top(){$("#recent_left_cont").html("");append_load($("#recent_left_cont"),"light");$.getJSON("/api/get_community_top_stream/",{page_size:12},function(a){remove_load();0<a.length?render_community_top(a,$("#recent_left_cont")):(empty_html='<div id="stream_empty"><h1>There are no <span class="strong">Community Nominations</span></h1><ul><li><h3>You can solve this by completing one of the following actions:</h3></li><li><p>Nominate one of your photos.</p></li><li><p>Nominate your friend\'s photos.</p></li><li><p>Nominate photos from the community.</p></li></ul><div class="clear"></div></div>',
$("#recent_left_cont").append(empty_html))})}function init_community_top_cat(){var a=getUrlVars();$("#recent_left_cont").html("");append_load($("#recent_left_cont"),"light");$.getJSON("/api/get_community_top_nominations_cat/",{page_size:32,cat:a[2]},function(a){remove_load();render_community_top_cat(a,$("#recent_left_cont"))})}
function render_promoted_users(a,b){for(var c="",d=0;d<a.length;d++)c='<div class="top_user_cont" value="'+a[d].username+'"><a href="/#!/'+a[d].username+'/"><img src="https://graph.facebook.com/'+a[d].fid+'/picture?type=square"/></a><div class="top_user_text_cont"><a href="/#!/'+a[d].username+'/"><h3>'+a[d].username+'</h3></a><p>Focus: <span class="strong">'+a[d].top_nom_cat+'</span></p></div><div class="clear"></div></div>',$(b).append(c)}
function get_suggested_users(a,b){0==$(".top_user_cont").length&&("top"==a?$.getJSON("/api/get_top_users/",function(a){0<a.length?render_promoted_users(a,b):0==$("#empty_suggest_users").length&&$(b).append('<h3 id="empty_suggest_users">No suggested users at the moment.</h3>')}):"interesting"==a&&$.getJSON("/api/get_interesting_users/",function(a){0<a.length?render_promoted_users(a,b):0==$("#empty_suggest_users").length&&$(b).append('<h3 id="empty_suggest_users">No interesting users at the moment.</h3>')}))}
function init_community_view(a){if(0==$("#community").length){$(".stream_nav").removeClass("selected");$("#activate_community").addClass("selected");stream_view="community";if(public_view)0==$("li.public").length&&$("#profile_wrap ul #countdown_cont").before('<li class="public" style="margin-left: 285px;"><h2 id="community_photos" class="sub_stream_nav" name="community_photos">Photos</h2></li><li class="public"><h2 id="community_active" class="sub_stream_nav" name="community_active">Active</h2></li><li class="public"><h2 id="community_top" class="sub_stream_nav" name="community_top">Top</h2></li>'),
b='<div id="community"><div id="community_cont"><div id="recent_left_cont"></div><div id="community_right_cont"><div id="community_public_push"></div><div id="app_download_cont"><a href="http://itunes.apple.com/us/app/portrit/id435873942?mt=8&ls=1" target="_blank"><h2>Download our free app.</h2><img src="http://portrit.s3.amazonaws.com/img/appicon.png"/></a></div><div id="community_interesting_people"><h1>Interesting People</h1></div></div><div class="clear"></div></div></div>';else var b='<div id="community"><div id="community_header"><div class="stream_nav_cont"><h1>Community</h1><ul><li><h2 id="community_top" class="sub_stream_nav" name="community_top">Top</h2></li><li><h2 id="community_active" class="sub_stream_nav" name="community_active">Active</h2></li><li><h2 id="community_photos" class="sub_stream_nav" name="community_photos">Photos</h2></li><div class="clear"></div></ul></div><h2>Suggested People to Follow</h2></div><div id="community_cont"><div id="recent_left_cont"></div><div id="community_right_cont"></div><div class="clear"></div></div></div>';
$("#profile_cont_wrap").append(b)}public_view?get_suggested_users("interesting",$("#community_right_cont")):get_suggested_users("top",$("#community_right_cont"));"photos"==a?$("#community_photos").addClass("selected"):"active"==a?$("#community_active").addClass("selected"):"top"==a&&$("#community_top").addClass("selected");first_tuts_on&&first_tuts_sections.community?($("#first_tuts_cont").show(),$("#tuts_wrap").html("<h1>Community</h1><p>Watch the nominations as they come in, browse through the highest rated nominations of the day, and meet new people.<p>"),
setTimeout(function(){("community_active"==view_active||"community_photos"==view_active||"community_top"==view_active)&&$("#first_tuts_cont").fadeOut();first_tuts_sections.community=!1},1E4)):$("#first_tuts_cont").hide()}var selected_nom=null;
function init_nom_detail(a,b){getUrlVars();var c="";void 0!=typeof b&&(c=b);$(".stream_nav, .sub_stream_nav").removeClass("selected");$("#profile_cont_wrap").html("");stream_view="";$("#profile_cont_wrap").append('<div id="nom_detail_cont"><h1 class="title"></h1><div id="main_nom_cont"><div id="main_nom_cont_left"><div id="main_nom_cont_left_wrap"><img id="main_nom_photo" src="http://portrit.s3.amazonaws.com/img/album-loader-dark.gif"/><div id="main_nom_photo_post_time"></div><div id="nominator_overlay_cont"></div></div></div><div id="main_nom_cont_right"><div id="main_nom_cont_right_wrap"><div id="nominatee_cont"></div><div id="trophy_cont"></div><div id="vote_cont"></div></div></div><div class="clear"></div></div></div>');$.getJSON("/api/get_nom_detail/",
{source:selected_user.username,nom_id:selected_nom,nav_selected:a,cat:c},function(c){0<c.length?nom_detail_view(c,a):raise_404()});attach_nom_detail_handlers();first_tuts_on&&first_tuts_sections.detail?($("#first_tuts_cont").show(),$("#tuts_wrap").html("<h1>Detail</h1><p>Detail view is where the magic happens. Give your vote, leave a comment, see the other competing photos, and share the nomination with your friends.<p>"),setTimeout(function(){"nom_detail"==view_active&&$("#first_tuts_cont").fadeOut();
first_tuts_sections.detail=!1},1E4)):$("#first_tuts_cont").hide()}
function inject_nom_stream(a,b){var c=null,d="",e="",f="",g="",h="",j=null,k=new Date,i="",o="",m="",l=m=d="",n="",p=$(".sub_stream_nav.selected").attr("name");create_nom_cache(a);for(var q=0;q<a.length;q++){c=a[q];d=c.nomination_category;e=c.nomination_category.replace(" ","_").toLowerCase();h=c.nominatee==me.id?"You":c.nominatee_username;g='<img src="https://graph.facebook.com/'+c.nominatee+'/picture?type=square"/>';f='<img src="'+c.photo.source+'"/>';o=i="";if(0<c.quick_comments.length){for(l=
0;l<c.quick_comments.length;l++)m=c.quick_comments[l].owner_username,time=new Date(1E3*c.quick_comments[l].create_datetime),j=k-time,j/=1E3,i+='<div class="comment"><p class="comment_time" value="'+c.quick_comments[l].create_datetime+'">'+secondsToHms(j)+'</p><a href="#!/'+c.quick_comments[l].owner_username+'"><img class="user_photo" src="https://graph.facebook.com/'+c.quick_comments[l].owner_id+'/picture?type=square"/></a><a href="#!/'+c.quick_comments[l].owner_username+'" class="post_username from_username">'+
m+"</a><p>"+c.quick_comments[l].comment+"</p></div>";c.more_comments&&(o='<p class="load_more_comments" value="'+c.id+'">Load more comments</p>')}"stream_active"==p?n="/#!/stream/nominations/"+d.replace(" ","-")+"/":"stream_winners"==p?n="/#!/winners/nominations/":"community_active"==p?n="/#!/nomination/"+c.id+"/":"profile_active"==p&&(n="/#!/"+selected_user.username+"/active/nominations/");m=c.caption?c.caption:"No caption provided";l="";0<c.tagged_users.length&&(l='<div class="tagged_users" nom="'+
c.id+'"><span>'+c.tagged_users.length+' Tagged</span><div class="tag"></div></div>');time=new Date(1E3*c.created_time);j=k-time;j/=1E3;d='<div class="recent_nom_cont" id="'+c.id+'" time="'+c.created_time+'" style="display:none;"><div class="recent_nom_top_cont nom_cat_'+e+'"><a href="#!/'+c.nominatee_username+'">'+g+'</a><a href="#!/'+c.nominatee_username+'"><h2>'+h+"</h2></a><h3>"+d+'</h3><div class="clear"></div></div><div class="recent_nom_photo_cont"><div class="recent_nom_photo_left_cont"><div class="recent_nom_photo_left_wrap"><a href="'+
n+'" class="nomination_id" value="'+c.id+'">'+f+'<div class="post_time_cont"><p>'+secondsToHms(j)+'</p></div><div id="nominator_overlay_cont"><p>'+m+"</p>"+l+'</div></a></div></div><div class="recent_nom_photo_right_cont"><div class="recent_nom_vote_count nom_vote_'+c.id+'"><a href="'+n+'" class="nomination_id" value="'+c.id+'"><div class="trophy_img large '+e+'"></div></a><a href="'+n+'" class="nomination_id" value="'+c.id+'"><h2 class="nom_cat_'+e+'">Votes: <span class="strong">'+c.vote_count+'</span></h2></a></div><div class="clear"></div></div><div class="clear"></div></div><div class="recent_nom_comment_cont" id="nom_comments_'+
c.id+'"><div class="recent_nom_comment_heading" value="'+c.id+'"><span class="add_new_comment sick large">Comment</span><span class="nom_detail sick large">Detail</span><div class="flag flag_photo" nom_id="'+c.id+'"></div><div class="clear"></div></div>'+i+o+'<div class="clear"></div></div></div>';$(b).prepend(d);$("#"+c.id).fadeIn()}}var inactive_nom_found=!1,inactive_header_pos=0;
function render_recent_stream(a,b){var c=null,d="",e="",f="",g="",h="",j=null,k=new Date,i="",o="",m="",l=j=c="",n=m="",l="",p=$(".sub_stream_nav.selected").attr("name");create_nom_cache(a);var q="";me||(q="off");if(0<a.length)for(var r=0;r<a.length;r++){c=a[r];d=c.nomination_category;e=c.nomination_category.replace(" ","_").toLowerCase();h=me&&c.nominatee==me.id?"You":c.nominatee_username;g='<img src="https://graph.facebook.com/'+c.nominatee+'/picture?type=square"/>';f='<img src="'+c.photo.source+
'"/>';o=i="";if(0<c.quick_comments.length){for(l=0;l<c.quick_comments.length;l++)m=c.quick_comments[l].owner_username,time=new Date(1E3*c.quick_comments[l].create_datetime),j=k-time,j/=1E3,me&&m==me.username&&(m="You"),i+='<div class="comment"><p class="comment_time" value="'+c.quick_comments[l].create_datetime+'">'+secondsToHms(j)+'</p><a href="#!/'+c.quick_comments[l].owner_username+'"><img class="user_photo" src="https://graph.facebook.com/'+c.quick_comments[l].owner_id+'/picture?type=square"/></a><a href="#!/'+
c.quick_comments[l].owner_username+'" class="post_username from_username">'+m+"</a><p>"+c.quick_comments[l].comment+"</p></div>";0<c.comment_count-c.quick_comments.length&&(o='<p class="load_more_comments" value="'+c.id+'">Load more comments</p>')}j=me&&c.nominator==me.id?"You":c.nominator_username;"stream_active"==p?n="/#!/stream/nominations/"+d.replace(" ","-")+"/":"stream_winners"==p?n="/#!/winners/nominations/":"community_active"==p?n="/#!/nomination/"+c.id+"/":"profile_active"==p&&(n="/#!/"+
selected_user.username+"/active/"+d.replace(" ","-")+"/");l=c.caption?c.caption:"No caption provided";m="";0<c.tagged_users.length&&(m='<div class="tagged_users" nom="'+c.id+'"><span>'+c.tagged_users.length+' Tagged</span><div class="tag"></div></div>');l="profile_active"==view_active&&selected_user.fid==me.id?'<a href="/#!/'+c.nominator_username+'/"><img class="user_img" src="https://graph.facebook.com/'+c.nominator+'/picture?type=square"/></a><h2>Nominated by <span class="strong"><a href="/#!/'+
c.nominator_username+'/">'+j+'</a></span></h2><p class="nom_by_above">'+l+"</p>":"<p>"+l+"</p>";time=new Date(1E3*c.created_time);j=k-time;j/=1E3;c='<div class="recent_nom_cont" id="'+c.id+'" time="'+c.created_time+'"><div class="recent_nom_top_cont nom_cat_'+e+'"><a href="#!/'+c.nominatee_username+'">'+g+'</a><a href="#!/'+c.nominatee_username+'"><h2>'+h+"</h2></a><h3>"+d+'</h3><div class="clear"></div></div><div class="recent_nom_photo_cont"><div class="recent_nom_photo_left_cont"><div class="recent_nom_photo_left_wrap"><a href="'+
n+'" class="nomination_id" value="'+c.id+'">'+f+'<div class="post_time_cont"><p>'+secondsToHms(j)+'</p></div><div id="nominator_overlay_cont">'+l+m+'</div></a></div></div><div class="recent_nom_photo_right_cont"><div class="recent_nom_vote_count nom_vote_'+c.id+'"><a href="'+n+'" class="nomination_id" value="'+c.id+'"><div class="trophy_img large '+e+'"></div></a><a href="'+n+'" class="nomination_id" value="'+c.id+'"><h2 class="nom_cat_'+e+'">Votes: <span class="strong">'+c.vote_count+'</span></h2></a></div><div class="clear"></div></div><div class="clear"></div></div><div class="recent_nom_comment_cont" id="nom_comments_'+
c.id+'"><div class="recent_nom_comment_heading" value="'+c.id+'"><span class="add_new_comment sick large '+q+'">Comment</span><span class="nom_detail sick large">Detail</span><div class="flag flag_photo '+q+'" nom_id="'+c.id+'"></div><div class="clear"></div></div>'+i+o+'<div class="clear"></div></div></div>';$(b).append(c)}else 0==$(b).children().length&&(q=p=n=n=k="","stream_active"==view_active?(k="Active Nominations",n="Nominate one of your photos.",p="Nominate your friend's photos.",q="Nominate photos from the community."):
"stream_winners"==view_active&&(k="Winning Photos",n="Nominate one of your photos.",p="Nominate your friend's photos.",q="Nominate photos from the community."),$(b).append('<div id="stream_empty"><h1>There are no <span class="strong">'+k+"</span></h1><ul><li><h3>You can solve this by completing one of the following actions:</h3></li><li><p>"+n+"</p></li><li><p>"+p+"</p></li><li><p>"+q+'</p></li></ul><div class="clear"></div></div>'))}
function render_empty_overview_stream(a,b){var c="",d=c="",e="",f=null,f=null,g=new Date,h="",j="",k="";public_view&&(h="off");create_nom_cache(a);for(var i=0;i<a.length;i++)c=a[i].nomination_category,d=get_cat_under(c),a[i].caption?(e=a[i].caption,40<e.length&&(e=a[i].caption.slice(0,40)+"...")):e="No caption provided.",a[i].won?(j="won",k="Won"):(j="lost",k="Lost"),f=new Date(1E3*a[i].created_time),f=g-f,f/=1E3,c='<div class="community_active_cont prev" id="'+a[i].id+'"><div class="community_active_left_cont '+
j+'"><a href="/#!/community/active/'+a[i].id+'/" class="nomination_id" value="'+a[i].id+'"><img src="'+a[i].photo.crop+'"/></a></div><div class="community_active_right_cont"><div class="community_active_header nom_cat_'+d+'"><a href="/#!/'+a[i].nominatee_username+'/"><img src="https://graph.facebook.com/'+a[i].nominatee+'/picture?type=square"/></a><h3>'+k+" "+c+'</h3><h2><a href="/#!/'+a[i].nominatee_username+'/">'+a[i].nominatee_username+'</a></h2></div><div class="community_active_mid"><h2>'+e+
'</h2></div><div class="community_active_bottom"><div class="flag flag_photo '+h+'" nom_id="'+a[i].id+'"></div><a href="/#!/community/active/'+a[i].id+'/" class="nomination_id" value="'+a[i].id+'"><div class="active_stat"><h4>'+secondsToHms(f)+'</h4></div></a><a href="/#!/community/active/'+a[i].id+'/" class="nomination_id" value="'+a[i].id+'"><div class="active_stat"><h5>Votes</h5><p>'+a[i].vote_count+'</p></div></a></div></div><div class="clear"></div></div>',$(b).append(c)}
function render_active_overview_stream(a,b){var c="",d=c="",e="",f=null,f=null,g=new Date,h="";public_view&&(h="off");create_nom_cache(a);for(var j=0;j<a.length;j++)c=a[j].nomination_category,d=get_cat_under(c),a[j].caption?(e=a[j].caption,40<e.length&&(e=a[j].caption.slice(0,40)+"...")):e="No caption provided.",f=new Date(1E3*a[j].created_time),f=g-f,f/=1E3,c='<div class="community_active_cont" id="'+a[j].id+'"><div class="community_active_left_cont"><a href="/#!/community/active/'+a[j].id+'/" class="nomination_id" value="'+
a[j].id+'"><img src="'+a[j].photo.crop+'"/></a></div><div class="community_active_right_cont"><div class="community_active_header nom_cat_'+d+'"><a href="/#!/'+a[j].nominatee_username+'/"><img src="https://graph.facebook.com/'+a[j].nominatee+'/picture?type=square"/></a><h3>'+c+'</h3><h2><a href="/#!/'+a[j].nominatee_username+'/">'+a[j].nominatee_username+'</a></h2></div><div class="community_active_mid"><h2>'+e+'</h2></div><div class="community_active_bottom"><div class="flag flag_photo '+h+'" nom_id="'+
a[j].id+'"></div><a href="/#!/community/active/'+a[j].id+'/" class="nomination_id" value="'+a[j].id+'"><div class="active_stat"><h4>'+secondsToHms(f)+'</h4></div></a><a href="/#!/community/active/'+a[j].id+'/" class="nomination_id" value="'+a[j].id+'"><div class="active_stat"><h5>Votes</h5><p>'+a[j].vote_count+'</p></div></a></div></div><div class="clear"></div></div>',$(b).append(c)}
function render_community_top_cat(a,b){var c="",d="",d=null,e="";tag_html="";for(var c=a[0].nomination_category,d=get_cat_under(c),e='<div class="top_nom_cat"><div class="top_cat_heading nom_cat_'+d+'"><h2>'+c+'</h2><div class="clear"></div></div><div class="top_nom_cat_cont"><p class="tooltip"></p>',f=0;f<a.length;f++)d=a[f],e+='<div class="top_cat_photo_cont nomination_id" value="'+d.id+'" name="'+d.nominatee_username+'"><a href="/#!/community/top/'+c.replace(" ","-")+'/nominations/"><img src="'+
d.photo.crop+'"/></a></div>';$(b).append(e+'<div class="clear"></div></div></div>')}
function render_community_top(a,b){var c="",d="",e=null,d=null,f="";tag_html="";for(var g=0;g<a.length;g++){c=a[g].cat_name;d=get_cat_under(c);e=a[g].noms;tag_html="";12==e.length&&(tag_html='<div class="load_more_community_active" value="'+c+'"><div class="tag"></div><p>View More</p></div>');for(var f='<div class="top_nom_cat"><div class="top_cat_heading nom_cat_'+d+'"><h2>'+c+"</h2>"+tag_html+'<div class="clear"></div></div><div class="top_nom_cat_cont"><p class="tooltip"></p>',h=0;h<e.length;h++)d=
e[h],f+='<div class="top_cat_photo_cont nomination_id" value="'+d.id+'" name="'+d.nominatee_username+'"><a href="/#!/community/top/'+c.replace(" ","-")+'/nominations/"><img src="'+d.photo.crop+'"/></a></div>';f+='<div class="clear"></div></div></div>';$(b).append(f)}}
function render_top_noms(a){var b=null,c="",d="",e="",f="",b="",g=10;$("#top_right_cont").append('<h1>Daily <span class="strong">Leaders</h1><div id="current_top_noms"></div>');if(0<a.length){if(a.length<g)g=a.length;for(var h=0;h<a.length;h++)b=a[h],c=b.nomination_category,d=b.nomination_category.replace(" ","_").toLowerCase(),h<g&&(e='<img src="https://graph.facebook.com/'+b.nominatee+'/picture?type=square"/>',f='<img src="'+b.photo.thumbnail+'"/>',b='<div class="top_nom_wrap" name="'+b.nominatee_username+
'"><p class="vote_count nom_cat_'+d+'">'+getGetOrdinal(h+1)+'</p><a class="top_nom_username" href="/#!/'+b.nominatee_username+'/" name="'+b.nominatee_username+'">'+e+'</a><div class="top_nom_clip_cont" value="'+b.id+'"><div class="top_nom_clip"><a href="/#!/stream/nominations/'+c.replace(" ","-")+'/" class="nomination_id" value="'+b.id+'">'+f+'</a></div></div><div class="top_nom_user_cont"><div class="trophy_cont"><a href="/#!/stream/nominations/'+c.replace(" ","-")+'/" class="nomination_id" value="'+
b.id+'"><div class="trophy_img small '+d+'"></div></a></div><div class="vote_cont"><a href="/#!/stream/nominations/'+c.replace(" ","-")+'/" class="nomination_id" value="'+b.id+'"><h3>Votes</h3><h2>'+b.vote_count+"</h2></a></div></div></div>",$("#current_top_noms").append(b));$("#current_top_noms").append('<p class="tooltip"></p>')}else $("#top_right_cont").append("<h2>No current nominations.</h2>")}
function render_top_users(a){var b="",c="",b="";if(0<a.length){for(var c='<h1>All Time <span class="strong">Leaders</span></h1><div id="top_friends">',d=0;d<a.length;d++)b=a[d].fid==me.id?"You":a[d].username,b='<div class="top_friend" value="'+a[d].username+'"><a href="/#!/'+a[d].username+'/"><img src="https://graph.facebook.com/'+a[d].fid+'/picture?type=square"/></a><a href="/#!/'+a[d].username+'/"><h2>'+b+"</h2></a><h3>"+a[d].noms_won+'</h3><p class="nom_cat_'+a[d].top_nom_cat.replace(" ","_").toLowerCase()+
'">'+getGetOrdinal(d+1)+"</p></div>",c+=b;$("#top_right_cont").append(c+"</div>")}}
function init_stream_photos(){$("#recent_left_cont").html("");append_load($("#recent_left_cont"),"light");$.getJSON("/api/get_user_stream_photos/",{access_token:fb_session.access_token},function(a){remove_load();0<a.length?render_photo_list(a):(empty_html='<div id="stream_empty"><h1>There are no <span class="strong">Recent Photos</span></h1><ul><li><h3>You can solve this by completing one of the following actions:</h3></li><li><p>Upload a photo by clicking the Post Photo button above.</p></li><li><p>Downloading the <a>Portrit iPhone app</a>.</p></li></ul><div class="clear"></div></div>',$("#recent_left_cont").append(empty_html))})}
function get_more_stream_photos(a){scroll_loading=!0;append_load($("#recent_left_cont"),"light");$.getJSON("/api/get_user_stream_photos/",{pid:a,access_token:fb_session.access_token},function(a){scroll_loading=!1;remove_load();render_photo_list(a,!0)})}
function init_stream_active(){$("#recent_left_cont").html("");append_load($("#recent_left_cont"),"light");$.getJSON("/api/get_recent_stream/",{access_token:fb_session.access_token},function(a){remove_load();render_recent_stream(a,$("#recent_left_cont"));0==a.length&&get_stream_empty()})}
function get_more_stream_active(a){scroll_loading=!0;append_load($("#recent_left_cont"),"light");0==$("#stream_empty").length?$.getJSON("/api/get_recent_stream/",{access_token:fb_session.access_token,id:a,dir:"old"},function(a){scroll_loading=!1;remove_load();render_recent_stream(a,$("#recent_left_cont"))}):$.getJSON("/api/get_community_empty_nominations/",{access_token:fb_session.access_token,id:a,dir:"old"},function(a){scroll_loading=!1;remove_load();render_empty_overview_stream(a,$("#recent_left_cont"))})}
function init_stream_winners(){$("#recent_left_cont").html("");append_load($("#recent_left_cont"),"light");$.getJSON("/api/get_winners_stream/",{access_token:fb_session.access_token},function(a){remove_load();0<a.length?$.getJSON("/api/get_history_stream/",{access_token:fb_session.access_token},function(a){0<a.length&&render_empty_overview_stream(a,$("#recent_left_cont"))}):(empty_html='<div id="stream_empty"><h1>There are no <span class="strong">Winning Photos</span></h1><ul><li><h3>You can solve this by completing one of the following actions:</h3></li><li><p>Nominate one of your photos.</p></li><li><p>Nominate your friend\'s photos.</p></li><li><p>Nominate photos from the community.</p></li></ul><div class="clear"></div></div>',
$("#recent_left_cont").append(empty_html),get_stream_empty())})}function get_more_stream_winners(a){scroll_loading=!0;append_load($("#recent_left_cont"),"light");$.getJSON("/api/get_history_stream/",{access_token:fb_session.access_token,id:a,dir:"old"},function(a){scroll_loading=!1;remove_load();0<a.length&&render_empty_overview_stream(a,$("#recent_left_cont"))})}
function init_stream_view(a){$(".stream_nav").removeClass("selected");$("#active_stream_view").addClass("selected");stream_view="stream";$("#profile_cont_wrap").append('<div id="recent_cont_1"><div class="stream_nav_cont"><h1>Stream</h1><ul><li><h2 id="stream_winners" class="sub_stream_nav" name="stream_winners">History</h2></li><li><h2 id="stream_active" class="sub_stream_nav" name="stream_active">Active</h2></li><li><h2 id="stream_photos" class="sub_stream_nav" name="stream_photos">Photos</h2></li><div class="clear"></div></ul></div><div id="top_right_cont"></div><div id="recent_left_cont"></div></div><div class="clear"></div>');
"photos"==a?$("#stream_photos").addClass("selected"):"active"==a?$("#stream_active").addClass("selected"):"winners"==a&&$("#stream_winners").addClass("selected");$.getJSON("/init_stream/",function(a){render_top_noms(a.top);render_top_users(a.top_users)});first_tuts_on&&first_tuts_sections.stream?($("#first_tuts_cont").show(),$("#tuts_wrap").html("<h1>Stream</h1><p>This is your personalized stream. This will show nominations, photos, and recent winning photos from the users you follow.<p>"),setTimeout(function(){("stream_active"==
view_active||"stream_photos"==view_active||"stream_winners"==view_active)&&$("#first_tuts_cont").fadeOut();first_tuts_sections.stream=!1},1E4)):$("#first_tuts_cont").hide()}
function load_user(a,b){var c=getUrlVars(),d=c[0],e="";if(fb_session)e=fb_session.access_token;d={access_token:e,username:d};if("all"!=a&&(d.method=a,"photos"==a&&2<c.length))d.pid=c[2];$.getJSON("/api/get_user_profile/",d,function(c){selected_user=c.user;selected_user.fid&&selected_user.name?("all"==a&&(user_profile_data=c),selected_user.photos=c.photos,b(selected_user)):raise_404()})}
function render_gallery_view(){for(var a=0,b=null,c="empty",d=null,b="empty",e="",c=0;c<selected_user.photos.length;c++)if(selected_user.photos[c].id==selected_photo){a=c;break}selected_photo=selected_user.photos[a];0<=a-1?(b=selected_user.photos[a-1],c=b.id,prev_photo_html='<img src="'+b.crop+'"/>'):(c="empty",prev_photo_html="<h4>First</h4>");a+1<selected_user.photos.length?(d=selected_user.photos[a+1],b=d.id,next_photo_html='<img src="'+d.crop+'"/>'):(b="empty",next_photo_html="<h4>Last</h4>");
d="";public_view&&(d="off");e=selected_user.name+"'s";me&&me.id==selected_user.fid&&(e="Your");var f=new Date-new Date(1E3*selected_photo.created_time),f=f/1E3,e='<a href="/#!/'+selected_user.username+'/"><img src="https://graph.facebook.com/'+selected_user.fid+'/picture?type=square"/><h2>'+e+" Photos</h2></a>";$("#gallery_header").append(e);$("#gallery_prev_cont").attr("value",c).append(prev_photo_html);c='<img src="'+selected_photo.crop+'"/><div id="nominate" class="active">Nominate</div><div id="nominate_arrow" class="nominate_arrow"></div>';
$("#gallery_selected_cont").append(c);$("#gallery_next_cont").attr("value",b).append(next_photo_html);$("#gallery_photo_center").html('<img src="'+selected_photo.source+'"/>');c="<p>"+secondsToHms(f)+'</p><div class="flag flag_photo '+d+'" pid="'+selected_photo.id+'" thumb="'+selected_photo.crop+'" fb_crop="'+selected_photo.crop_small+'" owner="'+selected_user.username+'"></div>';$("#gallery_photo_bottom_cont").append(c);0<=a-1&&$("#gallery_photo_cache").append('<img src="'+selected_user.photos[a-
1].source+'"/>');a+1<selected_user.photos.length&&$("#gallery_photo_cache").append('<img src="'+selected_user.photos[a+1].source+'"/>')}
function update_gallery_view(){for(var a=0,b=null,c="empty",d=null,b="empty",c=0;c<selected_user.photos.length;c++)if(selected_user.photos[c].id==selected_photo){a=c;break}selected_photo=selected_user.photos[a];$("#photo_nominated_cont").remove();$(".nominated").removeClass("nominated");0<=a-1?(b=selected_user.photos[a-1],c=b.id,prev_photo_html='<img src="'+b.crop+'"/>',b.nominated&&$("#gallery_prev_cont").addClass("nominated")):(c="empty",prev_photo_html='<img src="http://portrit.s3.amazonaws.com/img/album-loader-dark.gif"/>',
"undefined"==typeof selected_photo.end?load_more_user_photos(selected_photo.id,"new"):prev_photo_html="<h4>First</h4>");a+1<selected_user.photos.length?(d=selected_user.photos[a+1],b=d.id,next_photo_html='<img src="'+d.crop+'"/>',d.nominated&&$("#gallery_next_cont").addClass("nominated")):(b="empty",next_photo_html='<img src="http://portrit.s3.amazonaws.com/img/album-loader-dark.gif"/>',"undefined"==typeof selected_photo.end?load_more_user_photos(selected_photo.id,"old"):next_photo_html="<h4>Last</h4>");
d=new Date-new Date(1E3*selected_photo.created_time);d/=1E3;$("#gallery_photo_bottom_cont > p").text(secondsToHms(d));$("#gallery_photo_bottom_cont > .flag").attr("pid",selected_photo.id).attr("thumb",selected_photo.crop).attr("fb_crop",selected_photo.crop_small);$("#gallery_prev_cont").html(prev_photo_html).attr("value",c);$("#gallery_selected_cont > img").attr("src",selected_photo.crop);$("#gallery_next_cont").html(next_photo_html).attr("value",b);$("#gallery_photo_center > img").attr("src",selected_photo.source);
selected_photo.nominated?render_photo_nominated(selected_photo.nom):$("#nominate").removeClass().addClass("active");$("#gallery_photo_cache").html("");0<=a-1&&$("#gallery_photo_cache").append('<img src="'+selected_user.photos[a-1].source+'"/>');a+1<selected_user.photos.length&&$("#gallery_photo_cache").append('<img src="'+selected_user.photos[a+1].source+'"/>')}
function render_photo_nominated(a){$("#gallery_selected_cont").addClass("nominated");$("#nominate").removeClass().addClass("disabled");a='<div id="photo_nominated_cont"><h2>You nominated this photo for '+a+'</h2><div class="trophy_img large '+get_cat_under(a)+'"></div><h3>Go to the <a href="/#!/" class="nom_cat_'+get_cat_under(a)+'_text">Stream</a> to see your nomination</h3></div>';$("#gallery_photo_cont").append(a)}
function add_photo_nominated(a,b){for(var b=b.split(","),c="",d=0;d<b.length;d++)b[d]&&(c=b[d]);for(d=0;d<selected_user.photos.length;d++)if(selected_user.photos[d].id==a){selected_user.photos[d].nominated=!0;selected_user.photos[d].nom=c;break}render_photo_nominated(c)}
function attach_gallery_handlers(){$("#gallery_next").live("click",function(){$("#gallery_next_cont").click()});$("#gallery_prev").live("click",function(){$("#gallery_prev_cont").click()});$("#gallery_prev_cont").live("click",function(){var a=$(this).attr("value");"empty"!=a&&(selected_photo=a,update_gallery_view())});$("#gallery_next_cont").live("click",function(){var a=$(this).attr("value");"empty"!=a&&(selected_photo=a,update_gallery_view(a))});$("#nominate").live("click",function(){public_view?
$("#gallery_selected_cont").append(""):(disable_search=!0,$("#context_overlay_cont").addClass("nominate_photo"),$("#context_overlay_cont > div").append(nominate_photo_html),$("#selected_img").attr("src",selected_photo.source),show_context_overlay(!0,!0),$("#tagged_friends_cont").append('<div class="tagged_user nominatee_user" name="Nominee"><img src="https://graph.facebook.com/'+selected_user.fid+'/picture?type=square"/></div>'),mutual_friends_list=[],$.getJSON("/api/get_follow_data/",{access_token:fb_session.access_token,
mutual:!0,target:selected_user.fid,all:!0,method:"following"},function(a){for(var b=null,c=0;c<a.data.length;c++)b=a.data[c],mutual_friends_list.push({fid:b.fid,name:b.name,username:b.username});for(c=0;c<mutual_friends_list.length;c++)$("#mutual_friends_cont").append('<div class="mutual_user" id="mutual_'+mutual_friends_list[c].fid+'" value="'+mutual_friends_list[c].fid+'"><img src="https://graph.facebook.com/'+mutual_friends_list[c].fid+'/picture?type=square"/><p>'+mutual_friends_list[c].name+"</p><span>"+
mutual_friends_list[c].username+'</span><div class="clear"></div></div>')}))});$("#nominate").live("mouseover mouseout",function(a){!1==$(this).hasClass("disabled")&&("mouseover"==a.type?$("#nominate_arrow").removeClass().addClass("nominate_arrow_hover"):$("#nominate_arrow").removeClass().addClass("nominate_arrow"))})}
function init_gallery_view(a){"undefined"!=typeof a&&(selected_photo=a);stream_view="";$(".stream_nav, .sub_stream_nav").removeClass("selected");$("#profile_cont_wrap").html('<div id="gallery_cont"><div id="gallery_header"></div><div id="gallery_wrap"><div id="gallery_left_stream"><div id="gallery_prev"><div class="up_arrow"></div></div><div id="gallery_prev_cont" class="gallery_thumb"></div><div id="gallery_selected_cont" class="gallery_thumb"></div><div id="gallery_next_cont" class="gallery_thumb"></div><div id="gallery_next"><div class="down_arrow"></div></div></div><div id="gallery_photo_cont"><div id="gallery_photo_center"><img src="http://portrit.s3.amazonaws.com/img/ajax-loader-light.gif"/></div><div id="gallery_photo_bottom_cont"></div></div><div id="gallery_photo_cache" style="display:none;"></div></div><div class="clear"></div></div>');selected_user&&
selected_user.username?selected_user.photos?render_gallery_view():load_user("photos",render_gallery_view):load_user("all",render_gallery_view);attach_gallery_handlers();first_tuts_on&&first_tuts_sections.gallery?($("#first_tuts_cont").show(),$("#tuts_wrap").html("<h1>Gallery</h1><p>Browse through photos to find the best, then nominate it for a trophy!<p>"),setTimeout(function(){"gallery"==view_active&&$("#first_tuts_cont").fadeOut();first_tuts_sections.gallery=!1},1E4)):$("#first_tuts_cont").hide()}
function render_user_profile(a){if(!me||a.user.fid!=me.id)if($("#user_profile_image").html('<img src="https://graph.facebook.com/'+a.user.fid+'/picture?type=large"/>'),$("#profile_user_name").text(a.user.name),$("#profile_user_username").text("AKA "+a.user.username),me){var b="",b=a.follow?'<span class="sick_abs large red follow" value="unfollow" target="'+a.user.username+'">Unfollow</span>':'<span class="sick_abs large green follow" value="follow" target="'+a.user.username+'">Follow</span>';$("#user_profile_image").append(b)}$("#profile_followers_count_cont h3").text(a.follow_counts.followers);
$("#profile_following_count_cont h3").text(a.follow_counts.following);$("#profile_trophies").after('<p id="trophy_count" class="round_count">'+a.trophy_count+"</p>");$("#profile_active").after('<p id="active_count" class="round_count">'+a.active_noms_count+"</p>")}
function render_user_photos(a,b){if(0<a.length){"undefined"==typeof b&&$("#profile_user_context").append('<div id="user_photo_cont"></div>');for(var c="",d=new Date,e=0;e<a.length;e++)time=new Date(1E3*a[e].created_time),time_diff=d-time,time_diff/=1E3,c='<div class="user_photo_wrap" pid="'+a[e].id+'" name="'+secondsToHms(time_diff)+'"><a href="/#!/'+selected_user.username+'/photos/" value="'+a[e].id+'"><img src="'+a[e].crop+'"/></a></div>',$("#user_photo_cont").append(c);0==$("#user_photo_cont .tooltip").length&&
$("#user_photo_cont").append('<p class="tooltip"></p>');$("#user_photo_cont").append('<div class="clear"></div>')}else c="",c=me&&me.id==selected_user.fid?"You have no photos.":selected_user.username+" has no photos.",$("#profile_user_context").append('<div id="cont_empty"><h2>'+c+"</h2></div>")}
function render_user_trophies(a){if(0<a.length){var b="",c="",d=null,c=null,e="",e="";$("#profile_user_context").append('<div id="user_trophy_cont"></div>');for(var f=0;f<a.length;f++){b=a[f].cat_name;c=get_cat_under(b);d=a[f].noms;e="";4>d.length&&1<a.length&&(e="short");for(var e='<div class="top_nom_cat '+e+'"><div class="top_cat_heading nom_cat_'+c+'"><h2>'+b+'</h2><div class="clear"></div></div><div class="top_nom_cat_cont"><p class="tooltip"></p>',g=0;g<d.length;g++)c=d[g],e+='<div class="top_cat_photo_cont nomination_id" value="'+
c.id+'" name="Votes: '+c.vote_count+'"><a href="/#!/'+selected_user.username+"/trophies/"+b.replace(" ","-")+'/"><img src="'+c.photo.crop+'"/></a></div>';e+='<div class="clear"></div></div></div>';$("#user_trophy_cont").append(e)}$("#user_trophy_cont").append('<div class="clear"></div>')}else a="",a=me&&me.id==selected_user.fid?"You have not won any trophies yet.":selected_user.username+" has not won any trophies yet.",$("#profile_user_context").append('<div id="user_trophy_cont"><div id="cont_empty"><h2>'+
a+"<h2></div></div>")}
function render_profile_follow(a,b){var c="",c="",a=a.data;$("#profile_user_context").append("<h2>"+capitaliseFirstLetter(b)+'</h2><div id="follow_cont"></div>');if(0<a.length)for(var d=0;d<a.length;d++)c=public_view?"":a[d].fid==me.id?"<h3>You</h3>":a[d].follow?'<span class="sick large green follow" value="follow" target="'+a[d].username+'">Follow</span>':'<span class="sick large red follow" value="unfollow" target="'+a[d].username+'">Unfollow</span>',c='<div class="follow_wrap" value="'+a[d].username+
'"><img src="https://graph.facebook.com/'+a[d].fid+'/picture?type=square"/><div class="follow_name_cont"><h3>'+a[d].name+"</h3><h4>aka "+a[d].username+'</h4></div><div class="user_stats_cont"><div class="follow_photos"><h4>Photos</h4><p>'+a[d].photo_count+'</p></div><div class="follow_trophies"><h4>Trophies</h4><p>'+a[d].trophy_count+'</p></div><div class="follow_button_cont">'+c+"</div></div></div>",$("#follow_cont").append(c);else d=$(".follow_nav.selected").attr("name"),c="",c=me&&me.id==selected_user.fid?
"<h2>You have no "+d+".</h2>":"<h2>"+selected_user.username+" has no "+d+"</h2>",$("#follow_cont").append(c)}
function render_profile_related_noms(a){for(var b="",c=b="",d="",c="",e=0;e<a.length;e++)d=getGetOrdinal(a[e].selected_nom.position+1),b="",a[e].next&&(c=me&&me.username==a[e].next.nominatee_username?"You":a[e].next.nominatee_username,b='<div class="related_nom_next_cont"><div class="related_nom_left_cont"><div class="related_nom_top_cont" name="'+c+'"><p class="tooltip"></p><h2>'+getGetOrdinal(a[e].next.position+1)+'</h2><a href="/#!/'+a[e].next.nominatee_username+'/"><img src="https://graph.facebook.com/'+
a[e].next.nominatee+'/picture?type=square"/></a><div class="clear"></div></div></div><div class="related_nom_mid_cont"><a href="/#!/'+selected_user.username+'/active/nominations/" class="nomination_id" value="'+a[e].next.id+'"><p>Votes</p><h3><strong>'+a[e].next.vote_count+'</strong></h3><div class="clear"></div></a></div><div class="related_nom_right_cont"><a href="/#!/'+selected_user.username+'/active/nominations/" class="nomination_id" value="'+a[e].next.id+'"><img src="'+a[e].next.photo.crop_small+
'"/></a></div><div class="clear"></div></div>'),c="",a[e].prev?(c=me&&me.username==a[e].prev.nominatee_username?"You":a[e].prev.nominatee_username,c='<div class="related_nom_prev_cont"><div class="related_nom_left_cont"><div class="related_nom_top_cont" name="'+c+'"><p class="tooltip"></p><h2>'+getGetOrdinal(a[e].prev.position+1)+'</h2><a href="/#!/'+a[e].prev.nominatee_username+'/"><img src="https://graph.facebook.com/'+a[e].prev.nominatee+'/picture?type=square"/></a><div class="clear"></div></div></div><div class="related_nom_mid_cont"><a href="/#!/'+
selected_user.username+'/active/nominations/" class="nomination_id" value="'+a[e].prev.id+'"><p>Votes</p><h3><strong>'+a[e].prev.vote_count+'</strong></h3><div class="clear"></div></a></div><div class="related_nom_right_cont"><a href="/#!/'+selected_user.username+'/active/nominations/" class="nomination_id" value="'+a[e].prev.id+'"><img src="'+a[e].prev.photo.crop+'"/></a></div><div class="clear"></div></div>'):d=!a[e].next&&!a[e].prev?"1st":"Last",b='<div class="related_nom_cont" style="top: '+$(".recent_nom_cont:eq("+
e+")").position().top+'px;">'+b+'<div class="related_selected_cont"></div><div class="related_selected_post_cont"><h2>'+d+"</h2><p>This is your place.</p></div>"+c+"</div>",$("#top_right_cont").append(b)}function get_profile_related_noms(){$.getJSON("/api/get_profile_related_noms/",{username:selected_user.username},function(a){user_profile_data.related_noms=a;render_profile_related_noms(a)})}
function init_profile_photos(){$("#profile_user_context").html("");render_user_photos(user_profile_data.photos)}
function get_more_profile_photos(a){var b="";if(fb_session)b=fb_session.access_token;scroll_loading=!0;append_load($("#user_photo_cont"),"light");$.getJSON("/api/get_user_profile/",{access_token:b,username:selected_user.username,method:"photos",dir:"old",pid:a,page_size:20},function(a){scroll_loading=!1;remove_load();if(0<a.photos.length){for(var b=0;b<a.photos.length;b++)selected_user.photos.push(a.photos[b]);render_user_photos(a.photos,!0)}})}
function load_more_user_photos(a,b){var c="";if(fb_session)c=fb_session.access_token;c={access_token:c,method:"photos",dir:b,pid:a,page_size:20};if(!me||me.id!=selected_user.fid)c.username=selected_user.username;"old"==b?$.getJSON("/api/get_user_profile/",c,function(a){if(0<a.photos.length){for(var c=0;c<a.photos.length;c++)selected_user.photos.push(a.photos[c]);$("#gallery_next_cont").attr("value",a.photos[0].id);$("#gallery_next_cont").html('<img src="'+a.photos[0].crop+'"/>')}else selected_user.photos[selected_user.photos.length-
1].end=!0,$("#gallery_next_cont").html("<h4>Last</h4>")}):"new"==b&&$.getJSON("/api/get_user_profile/",c,function(a){if(0<a.photos.length){for(var c=0;c<a.photos.length;c++)selected_user.photos.unshift(a.photos[c]);$("#gallery_prev_cont").attr("value",a.photos[0].id);$("#gallery_prev_cont").html('<img src="'+a.photos[0].crop+'"/>')}else selected_user.photos[0].end=!0,$("#gallery_prev_cont").html("<h4>First</h4>")})}
function init_profile_trophies(){$("#profile_user_context").html("");if(user_profile_data.trophies)render_user_trophies(user_profile_data.trophies);else{var a="";if(fb_session)a=fb_session.access_token;append_load($("#profile_user_context"),"light");$.getJSON("/api/get_user_trophies/",{access_token:a,target:selected_user.fid},function(a){remove_load();user_profile_data.trophies=a;render_user_trophies(user_profile_data.trophies)})}}
function init_profile_active(){$("#profile_user_context").html('<div id="profile_active_cont"><div id="top_right_cont"></div><div id="recent_left_cont"></div><div class="clear"></div></div>');if(user_profile_data.active_noms)if(0<user_profile_data.active_noms.length)render_recent_stream(user_profile_data.active_noms,$("#recent_left_cont")),render_profile_related_noms(user_profile_data.related_noms);else{var a="",a=me&&me.id==selected_user.fid?"You have no active nominations.":selected_user.username+
" has no active nominations.";$("#recent_left_cont").append('<div id="cont_empty"><h2>'+a+"</h2></div>")}else{a="";if(fb_session)a=fb_session.access_token;append_load($("#recent_left_cont"),"light");$.getJSON("/api/get_user_profile/",{access_token:a,username:selected_user.username,method:"active"},function(a){remove_load();user_profile_data.active_noms=a.active_noms;0<user_profile_data.active_noms.length?(render_recent_stream(user_profile_data.active_noms,$("#recent_left_cont")),get_profile_related_noms()):
(a="",a=me&&me.id==selected_user.fid?"You have no active nominations.":selected_user.username+" has no active nominations.",$("#recent_left_cont").append('<div id="cont_empty"><h2>'+a+"</h2></div>"))})}}
function init_profile_settings(){$("#profile_user_context").html("");var a="",b="switch_off",c="switch_off",d="switch_off",e="switch_off",f="switch_off",g="switch_off";allow_public_follows&&(b="switch_on");allow_portrit_album&&(c="switch_on");email_on_follow&&(d="switch_on");email_on_nomination&&(e="switch_on");email_on_win&&(f="switch_on");email&&30<email.length&&(email=email.slice(0,30)+"...");twitter_access_token&&(g="switch_on");a='<div id="settings_cont"><h1>Settings</h1><div class="sub_setting_cont"><div style="border-bottom: 1px solid #bebebe;"><div id="allow_public_follows" value="privacy" class="switch '+
b+'"></div><div class="center_twin"><label for="allow_public_follows">Allow anyone to follow you: </label><p class="sub_label">Turning this off will require you to accept new followers.</p></div><div class="clear"></div></div><div><div id="allow_portrit_album" value="post_wins" class="switch '+c+'"></div><div class="center_twin"><label for="allow_portrit_album">Allow Portrit to post winning trophies back to Facebook: </label><p class="sub_label">This will create a Portrit Trophies photo album on your Facebook.</p></div><div class="clear"></div></div></div><h1 class="half">Email Notifications</h1><h1 class="half" style="width: 430px; padding-left: 20px;">Linked Accounts</h1><div class="sub_setting_cont_half sharing_cont" style="float: right;"><div style="border-bottom: 1px solid #bebebe;"><img src="http://portrit.s3.amazonaws.com/img/f_logo.png"/><label for="sharing_facebook">Facebook: </label><div id="sharing_facebook" style="margin-top: 10px;" value="sharing_facebook" class="switch switch_on"></div><div class="clear"></div></div><div><img src="http://portrit.s3.amazonaws.com/img/twitter_logo.png"/><label for="sharing_twitter">Twitter: </label><div id="twitter_login"></div><div id="sharing_twitter" style="margin-top: 10px;" value="sharing_twitter" class="switch '+
g+'"></div><div class="clear"></div></div></div><div class="sub_setting_cont_half" style="margin-right: 36px; border: 1px solid #dedede"><div class="user_email_cont"><label class="single_line" for="email_on_follow">Email Address: </label><p>'+email+'</p></div></div><div class="sub_setting_cont_half" style="margin-right: 36px;"><div style="border-bottom: 1px solid #bebebe;"><div id="email_on_follow" value="email_follow" class="switch '+d+'"></div><label class="single_line" for="email_on_follow">Notify on new follow:</label><div class="clear"></div></div><div style="border-bottom: 1px solid #bebebe;"><div id="email_on_nomination" value="email_nomination" class="switch '+
e+'"></div><label class="single_line" for="email_on_nomination">Notify on new nomination:</label><div class="clear"></div></div><div><div id="email_on_win" value="email_win" class="switch '+f+'"></div><label class="single_line" for="email_on_win">Notify on winning nomination:</label><div class="clear"></div></div></div><div class="clear"></div></div>';mobile&&!tablet&&(a='<div id="settings_cont"><h1>Settings</h1><div class="sub_setting_cont"><div style="border-bottom: 1px solid #bebebe;"><div id="allow_public_follows" value="privacy" class="switch '+
b+'"></div><div class="center_twin"><label for="allow_public_follows">Allow anyone to follow you: </label><p class="sub_label">Turning this off will require you to accept new followers.</p></div><div class="clear"></div></div><div><div id="allow_portrit_album" value="post_wins" class="switch '+c+'"></div><div class="center_twin"><label for="allow_portrit_album">Allow Portrit to post winning trophies back to Facebook: </label><p class="sub_label">This will create a Portrit Trophies photo album on your Facebook.</p></div><div class="clear"></div></div></div><h1 class="half" style="width: 500px;">Linked Accounts</h1><div class="sub_setting_cont_half sharing_cont" style="float: right;"><div style="border-bottom: 1px solid #bebebe;"><img src="http://portrit.s3.amazonaws.com/img/f_logo.png"/><label for="sharing_facebook">Facebook: </label><div id="sharing_facebook" style="margin-top: 10px;" value="sharing_facebook" class="switch switch_on"></div><div class="clear"></div></div><div><img src="http://portrit.s3.amazonaws.com/img/twitter_logo.png"/><label for="sharing_twitter">Twitter: </label><div id="twitter_login"></div><div id="sharing_twitter" style="margin-top: 10px;" value="sharing_twitter" class="switch '+
g+'"></div><div class="clear"></div></div></div><h1 class="half">Email Notifications</h1><div class="sub_setting_cont_half" style="border: 1px solid #dedede"><div class="user_email_cont"><label class="single_line" for="email_on_follow">Email Address: </label><p>'+email+'</p></div></div><div class="sub_setting_cont_half"><div style="border-bottom: 1px solid #bebebe;"><div id="email_on_follow" value="email_follow" class="switch '+d+'"></div><label class="single_line" for="email_on_follow">Notify on new follow:</label><div class="clear"></div></div><div style="border-bottom: 1px solid #bebebe;"><div id="email_on_nomination" value="email_nomination" class="switch '+
e+'"></div><label class="single_line" for="email_on_nomination">Notify on new nomination:</label><div class="clear"></div></div><div><div id="email_on_win" value="email_win" class="switch '+f+'"></div><label class="single_line" for="email_on_win">Notify on winning nomination:</label><div class="clear"></div></div></div><div class="clear"></div></div>');$("#profile_user_context").append(a)}
function init_profile_follow(a){var b="";if(fb_session)b=fb_session.access_token;$("#profile_user_context").html("");append_load($("#profile_user_context"),"light");$.getJSON("/api/get_follow_data_detailed/",{access_token:b,target:selected_user.fid,method:a,all:!0},function(c){remove_load();render_profile_follow(c,a)})}var user_profile_data=null;
function init_profile_view(a){var b="",c="",d="",e="";if(0==$("#user_profile_cont").length){stream_view="profile_user";user_profile_data=null;$(".stream_nav, .sub_stream_nav").removeClass("selected");me&&me.username==selected_user.username&&($("#activate_profile").addClass("selected"),stream_view="profile",d="You",e="AKA "+me.username,b='<img src="https://graph.facebook.com/'+me.id+'/picture?type=large"/>',c='<li><h2 id="profile_settings" class="sub_stream_nav" name="profile_settings">Settings</h2></li>');
$("#profile_cont_wrap").append('<div id="profile"><div id="profile_header"><h1>Profile</h1></div><div id="user_profile_cont"><div id="profile_user_header"><div id="user_profile_image">'+b+'</div><div id="profile_nav_cont"><h2 id="profile_user_name">'+d+'</h2><h3 id="profile_user_username">'+e+'</h3><div class="stream_nav_cont"><ul>'+c+'<li><h2 id="profile_active" class="sub_stream_nav" name="profile_active">Active</h2></li><li><h2 id="profile_trophies" class="sub_stream_nav" name="profile_trophies">Trophies</h2></li><li><h2 id="profile_photos" class="sub_stream_nav" name="profile_photos">Photos</h2></li><div class="clear"></div></ul></div></div><div id="profile_stats_cont"><div id="profile_followers_count_cont" class="follow_nav" name="followers"><h4>Followers</h4><h3></h3></div><div id="profile_following_count_cont" class="follow_nav" name="following"><h4>Following</h4><h3></h3></div></div></div><div id="profile_user_context"></div></div></div>');
append_load($("#profile_user_context"),"light");b="";if(fb_session)b=fb_session.access_token;$.getJSON("/api/get_user_profile/",{access_token:b,username:selected_user.username,page_size:30},function(c){remove_load();null!=c.user.username?(selected_user=c.user,user_profile_data=c,render_user_profile(c),selected_user.photos=c.photos,"photos"==a?init_profile_photos():"trophies"==a?init_profile_trophies():"active"==a?init_profile_active():"settings"==a?init_profile_settings():("following"==a||"followers"==
a)&&init_profile_follow(a)):raise_404()})}else"photos"==a?init_profile_photos():"trophies"==a?init_profile_trophies():"active"==a?init_profile_active():"settings"==a?init_profile_settings():("following"==a||"followers"==a)&&init_profile_follow(a);attach_profile_handlers();first_tuts_on&&first_tuts_sections.profile?($("#first_tuts_cont").show(),$("#tuts_wrap").html("<h1>Profile</h1><p>Welcome to your profile. Check who you are following, look through your photos, keep track of your active nominations and more!<p>"),
setTimeout(function(){("profile_trophies"==view_active||"profile_photos"==view_active||"profile_active"==view_active||"profile_settings"==view_active)&&$("#first_tuts_cont").fadeOut();first_tuts_sections.profile=!1},1E4)):$("#first_tuts_cont").hide()}
function attach_profile_handlers(){mobile?$("#profile_stats_cont > div").live("touchend",function(){var a=$(this).attr("name");if("followers"==a)window.location.href="#!/"+selected_user.username+"/followers/";else if("following"==a)window.location.href="#!/"+selected_user.username+"/following/"}):$("#profile_stats_cont > div").live("click",function(){var a=$(this).attr("name");if("followers"==a)window.location.href="#!/"+selected_user.username+"/followers/";else if("following"==a)window.location.href=
"#!/"+selected_user.username+"/following/"});$(".user_photo_wrap a").live("click",function(){selected_photo=$(this).attr("value")});$(".follow_wrap").live("click",function(){var a=$(this).attr("value");stream_view="";window.location.href="/#!/"+a+"/"});$(".follow_wrap").live("mouseover mouseout",function(a){"mouseover"==a.type?$(this).css("background-color","#ccc"):$(this).css("background-color","#eee")});$(".user_photo_wrap").live("mouseover mouseout",function(a){"mouseover"==a.type?show_tooltip(this):
hide_tooltip(this)})}var date=new Date,month=date.getMonth(),todays_date=date.getDate(),todays_year=date.getFullYear(),dateFuture=null,dateFuture=23<=date.getHours()?new Date(todays_year,month,todays_date+1,23,0,0):new Date(todays_year,month,todays_date,23,0,0);tzOffset=-8;dx=dateFuture.toGMTString();dx=dx.substr(0,dx.length-3);tzCurrent=-2*(dateFuture.getTimezoneOffset()/60);dateFuture.setTime(Date.parse(dx));dateFuture.setHours(dateFuture.getHours()+tzCurrent-tzOffset);
function GetCount(){dateNow=new Date;amount=dateFuture.getTime()-dateNow.getTime();delete dateNow;if(1>=amount){var a=new Date,b=a.getMonth(),c=a.getDate(),d=a.getFullYear();dateFuture=23<=a.getHours()?new Date(d,b,c+1,23,0,0):new Date(d,b,c,23,0,0);tzOffset=-8;dx=dateFuture.toGMTString();dx=dx.substr(0,dx.length-3);tzCurrent=-2*(dateFuture.getTimezoneOffset()/60);dateFuture.setTime(Date.parse(dx));dateFuture.setHours(dateFuture.getHours()+tzCurrent-tzOffset);0==$("#winners_announced_cont").length&&
$("#cont").prepend('<div id="winners_announced_cont"><h2>Winners are being calculated. Check back in a few minutes.</h2></div>')}secs=mins=hours=days=0;out="";amount=Math.floor(amount/1E3);days=Math.floor(amount/86400);amount%=86400;hours=Math.floor(amount/3600);amount%=3600;mins=Math.floor(amount/60);amount%=60;secs=Math.floor(amount);if(0!=days||0!=hours)out+=hours+"h:";if(0!=days||0!=hours||0!=mins)out+=mins+"m:";out+=secs+"s";$("#time_countdown").text(out);setTimeout("GetCount()",1E3)}
function render_countdown_clock(){0==$("#countdown_cont").length&&$("#profile_wrap > ul > .clear").before('<li id="countdown_cont"><div><h1>Time Remaining</h1><p></p><h2 id="time_countdown"></h2></h1></div></li>');GetCount()}var expand_timeout=null;
function show_tooltip(a){$(".tooltip:visible").css({top:"0px",opacity:"0"});var b=$(a).attr("name");if(b&&""!=b){var c=$(a).position().left+($(a).outerWidth()-$(".tooltip").width())/2-4,d=$(a).position().top-30;$(a).parent().find(".tooltip").html(b+'<span class="tooltip_arrow"></span>').css({top:d,left:c,width:"150px",opacity:"1.0","z-index":"100"})}}function hide_tooltip(a){$(a).parent().find(".tooltip").css({opacity:"0","z-index":"-1"})}
function show_public_tooltip(a){$(".public_tooltip:visible").css({top:"0px",opacity:"0"});var b=$(a).offset().left+($(a).outerWidth()-$(".public_tooltip").width())/2-4,a=$(a).offset().top-136;$(".public_tooltip").html('Login Required<span class="tooltip_arrow"></span>').css({top:a,left:b,width:"150px",opacity:"1.0","z-index":"100"})}function hide_public_tooltip(){$(".public_tooltip").css({opacity:"0","z-index":"-1"})}
function render_more_comments(a,b){$(b).find(".comment").remove();for(var c="",d="",e=null,f=null,g=0;g<a.length;g++)c=a[g].owner_id==me.id?"You":a[g].owner_username,f=new Date,e=new Date(1E3*a[g].create_datetime),f-=e,f/=1E3,e=secondsToHms(parseInt(f)),d+='<div class="comment"><p class="comment_time" value="'+a[g].create_datetime+'">'+e+'</p><a href="#!/'+a[g].owner_username+'"><img class="user_photo" src="https://graph.facebook.com/'+a[g].owner_id+'/picture?type=square"/></a><a href="#!/'+a[g].owner_username+
'" class="post_username from_username">'+c+"</a><p>"+a[g].comment+"</p></div>";$(b).find(".recent_nom_comment_heading").after(d)}function load_more_comments_handler(){var a=$(this).attr("value"),b=this;$.getJSON("/api/get_comments/",{nom_id:a},function(c){0<c.length&&render_more_comments(c,$("#nom_comments_"+a));$(b).remove()})}
function hide_more_comments_handler(){var a=$(this).prev().prev();$(a).css({"min-height":""});var b=$(a).children().length-2;$(a).children().filter(":lt("+b+")").remove();$(this).text("Load More Comments").removeClass("hide_more_comments").addClass("load_more_comments")}
function add_comment_peek_handler(){var a='<div class="comment_form_cont" style="display: none;"><div class="comment_top_head"><a class="submit_comment sick large" name="'+$(this).attr("value")+'">Post</a><a class="cancel_comment sick large">Close</a></div><textarea id="new_comment_body" class="comment_body"></textarea></div></div>';0==$(this).parent().find(".comment_form_cont").length&&($(this).parent().append(a),a=$(this).parent(),!1===mobile?$(a).find(".comment_form_cont").slideDown(function(){$(this).find(".comment_body").focus()}):
$(a).find(".comment_form_cont").show().find(".comment_body").focus(),$(this).hide(),$(this).next().hasClass("load_more_comments")&&$(this).next().hide())}function cancel_comment_handler(){var a=$(this).parent().parent();mobile?($(a).prev().show(),$(a).prev().prev().show(),$(a).remove()):$(a).slideUp(function(){$(a).prev().show();$(a).prev().prev().show();$(this).remove()});return!1}
function vote_up_handler(){var a=this,b=$(this).attr("value");if(!1==$(this).hasClass("won")){tut_on&&update_tut("vote");var c='<a href="/#!/'+me.username+'/" id="voted_'+me.id+'" name="'+me.username+'"><img src="https://graph.facebook.com/'+me.id+'/picture?type=square"/></a>';$("#nom_votes_wrap").append(c);$.post("/api/vote_on_nomination/",{direction:"up",nomination_id:b,access_token:fb_session.access_token},function(c){if(c){var e=$(a).parent().children().filter("p");$(e).text(c.vote_count);if(nom_cache[b])nom_cache[b].vote_count=
c.vote_count,nom_cache[b].votes.push({vote_user:me.id,vote_name:me.name,vote_username:me.username});$("#nom_vote_count").text(c.vote_count)}});vote_tooltip_on=!1;$("#vote_tooltip").fadeOut();"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Vote","Up",""]);$(".vote").addClass("won")}}
function vote_down_handler(){var a=this,b=$(this).attr("value");if(!1==$(this).hasClass("won")){tut_on&&update_tut("vote");var c='<a href="#!/'+me.username+'" id="voted_'+me.id+'" name="'+me.username+'"><img src="https://graph.facebook.com/'+me.id+'/picture?type=square"/></a>';$("#nom_votes_wrap").append(c);$.post("/api/vote_on_nomination/",{direction:"down",nomination_id:b,access_token:fb_session.access_token},function(c){if(c){var e=$(a).parent().children().filter("p");$(e).text(c.vote_count);if(nom_cache[b])nom_cache[b].vote_count=
c.vote_count,nom_cache[b].votes.push({vote_user:me.id,vote_name:me.name,vote_username:me.username});$("#nom_vote_count").text(c.vote_count)}});$("#vote_tooltip").fadeOut();vote_tooltip_on=!1;"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Vote","Down",""]);$(".vote").addClass("won")}}$("#close_overlay").live("click",close_context_overlay);
function close_context_overlay(a){disable_search=!1;$("#tab_nav > .selected").removeClass("selected");mobile?$("#wrapper").css("opacity",1):"undefined"!==typeof a&&!0==a||$("#wrapper").css({opacity:1});$("#context_overlay").hide();$("#context_overlay_cont").removeClass();$("#context_overlay_cont > div").html("");$("#wrapper").css("min-height","")}
function show_context_overlay(a,b){disable_search=!0;$("#close_overlay").removeClass().addClass("close_img "+close_size);mobile?("undefined"!==typeof a&&$("#wrapper").css("opacity",0.3),$("#context_overlay").show()):"undefined"!==typeof a&&("undefined"!==typeof b?($("#wrapper").css({opacity:0.3}),$("#context_overlay").show()):($("#wrapper").animate({opacity:0.3},300),$("#context_overlay").fadeIn()));var c=$(window).scrollTop(),d=$(window).height(),e=$("#context_overlay").height(),f=0,f=c+(d-e)/2;
0>d-e&&(f=c+25);$("#context_overlay").css({top:f})}var selected_result_index=0,result_length=0;
function render_search_results(a){var b=!0,c=!0,d="";selected_result_index=0;$("#results").append('<div id="results_wrap"></div>');result_length=a.length;selected_result_index=-1;if(0<a.length)for(var e=0;e<a.length;e++){if(!me||me.id!=a[e].fid)d="",b&&!0==a[e].following?(b=!1,d='<div id="search_following_header"><h2>Following</h2></div>'):c&&!1==a[e].following&&(c=!1,d='<div id="search_community_header"><h2>Community</h2></div>'),d+='<div class="search_result_cont" username="'+a[e].username+'"><div class="user_trophy_cont"><div class="trophy_img_cont"><div class="trophy_img medium blank"></div></div><div class="trophy_count"><h1>'+
a[e].wins+'</h1></div></div><img class="user_profile_photo" src="https://graph.facebook.com/'+a[e].fid+'/picture?type=square"/><h3>'+a[e].name+"</h3><h4>aka "+a[e].username+'</h4><div class="clear"></div></div>',$("#results_wrap").append(d)}else $("#results_wrap").html('<h1 id="empty_results">No results.</h1>')}
function search_keyboard_press(a){"up"==a?0<=selected_result_index&&(selected_result_index-=1,$(".search_result_cont").removeClass("selected"),$(".user_trophy_cont").removeClass("active"),$(".search_result_cont:eq("+selected_result_index+")").addClass("selected"),$(".search_result_cont:eq("+selected_result_index+")").find(".user_trophy_cont").addClass("active")):"down"==a&&selected_result_index<result_length&&(selected_result_index+=1,$(".search_result_cont").removeClass("selected"),$(".user_trophy_cont").removeClass("active"),
$(".search_result_cont:eq("+selected_result_index+")").addClass("selected"),$(".search_result_cont:eq("+selected_result_index+")").find(".user_trophy_cont").addClass("active"))}function search_select(){0<=selected_result_index&&selected_result_index<result_length&&$(".search_result_cont:eq("+selected_result_index+")").click()}var query_cache={},prev_query="",scroll_loading=!1,profile_active_nom_scroll=0;
function attach_main_handlers(){$("#tuts_wrap").live("click",function(){$(this).parent().fadeOut()});$("#share_nom_comment").live("focus",function(){$(this).removeClass().addClass("inputed");if("Caption"==this.value)this.value="";"Caption"!=this.value&&this.select()});$("#share_nom_comment").live("blur",function(){if(""==$.trim(this.value))$(this).removeClass().addClass("inactive"),this.value="Caption"});$("#share_nom_comment").live("keyup",function(){var a=$(this).val().length;$("#text_remail_cont").text(a+
"/140")});$("#share_nom_comment").live("keydown",function(a){var b=$(this).val().length;$("#text_remail_cont").text(b+"/140");if(140<=b&&8!=a.keyCode)return!1});$(".notification_pending_cont span").live("click",function(){var a=$(this).attr("value"),b=$(this).parent().attr("value"),a="accept"==a?1:0;$("#notification_"+b).fadeOut();$.post("/api/follow_permission_submit/",{access_token:fb_session.access_token,notification_id:b,value:a},function(){});return!1});$("#query").live("keyup",function(){var a=
$(this).attr("value");if(void 0==query_cache[a]&&""!=a&&prev_query!=a){var b="";if(fb_session)b=fb_session.access_token;var e=$("#results").height()-20,f=$("#results").width();$("#results").append('<div class="loading" style="height: '+e+"px; width: "+f+'px;"></div>');$.getJSON("/api/combined_search/",{access_token:b,query:a},function(b){$("#results").html("");query_cache[a]=b;render_search_results(b)})}else""!=a&&prev_query!=a?($("#results").html(""),render_search_results(query_cache[a])):prev_query!=
a&&$("#results").html("");prev_query=a});$(".search_result_cont").live("mouseover mouseout",function(a){selected_result_index=0;$(".search_result_cont").removeClass("selected");"mouseover"==a.type?($(this).find(".user_trophy_cont").addClass("active"),$(this).addClass("selected"),selected_result_index=$(".search_result_cont").index(this)):$(this).find(".user_trophy_cont").removeClass("active")});$(".search_result_cont").live("click",function(){var a=$(this).attr("username");if(a)window.location.href=
"/#!/"+a+"/"});$(".add_comment_peek").live("click",add_comment_peek_handler);$(".load_more_comments").live("click",load_more_comments_handler);$(".hide_more_comments").live("click",hide_more_comments_handler);$(".cancel_comment").live("click",cancel_comment_handler);$(".photo_post a").live("click",function(){$("#photo_list").html("");albums=null});$(".nomination_id").live("click",function(){selected_nom=$(this).attr("value")});$(".vote_up").live("click",vote_up_handler);$(".vote_down").live("click",
vote_down_handler);$(".stream_nav").live("click",function(){var a=$(this).attr("name");!1==$(this).hasClass("selected")&&($(".stream_nav").removeClass("selected"),$(this).addClass("selected"),"stream"==a?stream_nav_click():"community"==a?community_nav_click():"profile"==a&&profile_nav_click())});$(".sub_stream_nav").live("click",function(){var a=$(this).attr("name");if(!1==$(this).hasClass("selected")){$(".sub_stream_nav").removeClass("selected");$(this).addClass("selected");if("stream_photos"==a)window.location.href=
"#!/photos/";else if("stream_active"==a)window.location.href="#!/";else if("stream_winners"==a)window.location.href="#!/winners/";if("community_active"==a)window.location.href="#!/community/";else if("community_photos"==a)window.location.href="#!/community/photos/";else if("community_top"==a)window.location.href="#!/community/top/";if("profile_photos"==a)window.location.href="#!/"+selected_user.username;else if("profile_trophies"==a)window.location.href="#!/"+selected_user.username+"/trophies/";else if("profile_active"==
a)window.location.href="#!/"+selected_user.username+"/active/";else if("profile_settings"==a)window.location.href="#!/"+selected_user.username+"/settings/"}});$(".related_nom_top_cont").live("mouseover mouseout",function(a){"mouseover"==a.type?show_tooltip(this):hide_tooltip(this)});$(".top_nom_wrap").live("mouseover mouseout",function(a){"mouseover"==a.type?show_tooltip(this):hide_tooltip(this)});$(".top_cat_photo_cont").live("mouseover mouseout",function(a){"mouseover"==a.type?show_tooltip(this):
hide_tooltip(this)});$(".community_photo_cont").live("mouseover mouseout",function(a){"mouseover"==a.type?show_tooltip(this):hide_tooltip(this)});$(".voted_cont a, .new_photo_cont").live("mouseover mouseout",function(a){"mouseover"==a.type?show_tooltip(this):hide_tooltip(this)});$(".next_photo").live("click",function(){var a=$(this).parent().prev().children().filter('[name="selected"]');$(a).next().click()});$(".prev_photo").live("click",function(){var a=$(this).parent().prev().children().filter('[name="selected"]');
$(a).prev().click()});$("#settings_cont .switch").live("click",function(a){var b="",e="",f=!1,b=$(this).attr("value");$(this).hasClass("switch_on")?(e=1,f=!0):(e=0,f=!1);"privacy"==b?allow_public_follows=f:"post_wins"==b&&(allow_portrit_album=f);if("sharing_facebook"==b)return a.stopPropagation(),!1;"sharing_twitter"!=b&&$.post("/api/change_user_settings/",{access_token:fb_session.access_token,method:b,value:e})});if(!mobile){$("#show_upload").live("click",function(){$("#context_overlay_cont").addClass("photo_upload");
$("#context_overlay_cont > div").append('<div id="photo_upload_cont"><h1>Post Photo</h1><div id="upload_left_cont"><form id="file_uploader" action="/upload_photo/" method="POST" enctype="multipart/form-data"><input type="file" name="file" multiple><div class="sick large">Select Photos</div></form></div><div id="upload_right_cont"><h2>Drag Photos Here</h2></div><div id="upload_controls"><a id="cancel_upload" class="sick large">Cancel</a><a id="post_upload" class="sick large">Submit</a></div><div class="clear"></div></div><div id="photo_upload_permission_cont"><div id="connecting_triangle"></div><h2>Upload Settings</h2><ul id="upload_permission_controls"><li><div id="public_photo" class="switch switch_on"></div><h3>Photos are public:</h3><p>Switch to remove photos from community section.</p><div class="clear"></div></li></ul></div>');
show_context_overlay(!0,!0);var c=0,b=null;$("#file_uploader").fileUpload({namespace:"file_upload_1",url:"/upload_photo/",dropZone:$("#upload_right_cont"),initUpload:function(e,f,g,h,j,k){/\.(png)|(jpg)|(jpeg)|(gif)$/i.test(f[g].name)?2E6<f[g].size?($("#upload_right_cont").css("background-color","white"),$("#upload_right_cont > h2").text("Drag Photos Here"),$("#upload_error").remove(),$("#photo_upload_cont > h1").after('<p id="upload_error">File size must be below 2MB.</p>'),clearTimeout(b),b=setTimeout(function(){$("#upload_error").fadeOut()},
4500)):(c+=1,append_load($("#upload_left_cont"),"light"),a=!0,k()):($("#upload_right_cont").css("background-color","white"),$("#upload_right_cont > h2").text("Drag Photos Here"),$("#upload_error").remove(),$("#photo_upload_cont > h1").after('<p id="upload_error">Only .jpg, .png, and .gif are allowed.</p>'),clearTimeout(b),b=setTimeout(function(){$("#upload_error").fadeOut()},4500))},onLoad:function(b,d,g,h){c-=1;0>=c&&(remove_load(),a=!1);b=JSON.parse(h.responseText);0==$("#upload_right_cont > div").length&&
$("#upload_right_cont > h2").hide();b='<div class="photo_to_upload_cont" value="'+b.id+'"><div class="photo_to_upload_thumb"><img src="'+b.thumb+'"/></div><div class="photo_to_upload_name_cont"><p>'+b.name+'</p></div><p class="close_img '+close_size+'"></p></div>';$("#upload_right_cont").append(b);$("#upload_right_cont").css("background-color","white");$("#upload_right_cont > h2").text("Drag Photos Here")},onDragEnter:function(){$("#upload_right_cont").css("background-color","#E95C41");$("#upload_right_cont > h2").text("Drop")},
onDragLeave:function(){$("#upload_right_cont").css("background-color","white");$("#upload_right_cont > h2").text("Drag Photos Here")}})});$("#cancel_upload").die("click");$("#cancel_upload").live("click",function(){$("#close_overlay").click()});$(".photo_to_upload_cont .close_img").die("click");$(".photo_to_upload_cont .close_img").live("click",function(){$(this).parent().remove();0==$("#upload_right_cont .photo_to_upload_cont").length&&$("#upload_right_cont > h2").fadeIn()});var a=!1,b=[];$("#post_upload").die("click");
$("#post_upload").live("click",function(){if(!a){var c=$("#public_photo");$("#facebook_photo");b=[];if(0<$("#upload_right_cont .photo_to_upload_cont").length){var c=$(c).hasClass("switch_on")?!0:!1,d="";$(".photo_to_upload_cont").each(function(){var a=$(this);d+=$(a).attr("value")+",";b.push({id:$(a).attr("value"),thumbnail:$(a).find(".photo_to_upload_thumb img").attr("src")})});$.post("/mark_photos_live/",{photo_ids:d,public_perm:c},function(){});close_context_overlay(!0);render_photo_upload_nom(b);
$("#post_nomination").attr("id","post_photos_nomination");$("#cancel_nom").text("Skip")}"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Post Photo Upload","Click",""])}})}$(".nom_detail").live("click",function(){var a=$(this).parent().attr("value"),b=$("#"+a).find("a.nomination_id:first").attr("href");selected_nom=a;if(b)window.location.href=b});$(".add_new_comment").live("click",function(){if(me){$(this).addClass("off");var a='<div class="new_comment_cont" style="display:none;"><div class="comment_top_head"><span class="sick large post_new_comment" value="'+
$(this).parent().attr("value")+'">Post</span><span class="sick large cancel_new_comment">Close</span></div><textarea class="comment_body"></textarea></div>';0==$(this).parent().parent().find(".new_comment_cont").length&&($(this).parent().after(a),$(this).parent().parent().find(".new_comment_cont").show(),$(this).parent().parent().find(".comment_body").focus(),"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Comment","Shown",""]))}});$(".cancel_new_comment").live("click",function(){var a=$(this).parent().parent();
$(a).parent().find(".sick").removeClass("off");stream_view?$(a).remove():$(a).hide();$("#add_new_comment").show()});$(".post_new_comment").live("click",function(){var a=$(this).parent().parent(),b=$(a).find(".comment_body").val().replace(/\n\r?/g,"<br />"),e=$(this).attr("value"),f='<div class="comment" style="display:none;"><p class="comment_time" value="'+(new Date).getTime()/1E3+'">Right now</p><a href="#!/'+me.username+'"><img class="user_photo" src="https://graph.facebook.com/'+me.id+'/picture?type=square"/></a><a href="#!/'+
me.username+'" class="post_username from_username">You</a><p>'+b+"</p></div>";$(a).after(f);$(a).next().fadeIn();$(a).find(".cancel_new_comment").click();$(a).find(".comment_body").val("");$("#comments_empty").remove();tut_on&&update_tut("comment");$.post("/api/new_comment/",{access_token:fb_session.access_token,body:b,nom_id:e},function(a){if(a){var c=new Date,b=null;$(".comment_time").each(function(){time=new Date(1E3*$(this).attr("value"));b=c-time;b/=1E3;$(this).text(secondsToHms(parseInt(b)))})}});
"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Comment","Posted",""])});$(".comment_body").live("focus",function(){disable_search=!0});$(".comment_body").live("blur",function(){disable_search=!1});selected_photo_noms={};$("#cancel_nom").live("click",function(){$("#close_overlay").click();return!1});$("#inactive_trophy_cont li").live("click",function(){if($(this).hasClass("active")&&1>$("#selected_noms > div").length){$("#selected_noms h4").hide();1==$("#selected_noms > div").length+1?$("#inactive_trophy_cont li").removeClass("active").addClass("inactive"):
$(".inactive").removeClass("inactive");$(this).removeClass("active").addClass("selected");var a=$(this).find("h3").text().replace(" ","_").toLowerCase(),b=$(this).html();$("#selected_noms").append('<div id="'+a+'">'+b+'<span class="kill_nomination close_img '+close_size+'"></span></div>');setTimeout(function(){$("#"+a).css({opacity:"1.0"})},50)}});$("#selected_noms > div").live("mouseover mouseout",function(a){"mouseover"==a.type?$(this).find(".kill_nomination").show():$(this).find(".kill_nomination").hide()});
mobile?$("#selected_noms > div").live("touchend",function(){var a=$(this).attr("id");$("#"+a+"_cont").addClass("active").removeClass("selected");$(this).remove();1>$("#active_nominations_cont").children().length&&$(".inactive").removeClass("inactive").addClass("active");0==$("#selected_noms > div").length&&$("#selected_noms > h4").show()}):$("#selected_noms > div").live("click",function(){var a=$(this).attr("id");$("#"+a+"_cont").addClass("active").removeClass("selected");$(this).remove();1>$("#active_nominations_cont").children().length&&
$(".inactive").removeClass("inactive").addClass("active");0==$("#selected_noms > div").length&&$("#selected_noms > h4").show()});$("#nom_caption").live("focus",function(){if(this.value==this.defaultValue)this.value="";this.value!=this.defaultValue&&this.select()});$("#nom_caption").live("blur",function(){if(""==$.trim(this.value))this.value=this.defaultValue?this.defaultValue:""});$("#nom_caption").live("keyup",function(){var a=$(this).val().length;$("#text_remail_cont").text(a+"/90")});$("#nom_caption").live("keydown",
function(a){var b=$(this).val().length;$("#text_remail_cont").text(b+"/90");if(90<=b&&8!=a.keyCode)return!1});$("#post_nomination").live("click",function(){var a="",b="";if(0<$("#selected_noms > div").length&&!$(this).hasClass("sick_hover_lock")){tut_on&&update_tut("nom");$("#selected_noms > div > h3").each(function(){a+=$(this).text()+","});$(".tagged_user").each(function(){!1==$(this).hasClass("nominatee_user")&&(b+=$(this).attr("id").replace("tagged_","")+",")});$(this).text("Saving...");$(this).addClass("sick_hover_lock");
var e=$("#nom_caption").val();if("Add a caption to this nomination."==e||"Caption"==e)e="";$.post("/api/nominate_photo/",{access_token:fb_session.access_token,nominations:a,comment_text:e,photo_id:selected_photo.id,owner:selected_user.fid,tags:b},function(a){render_share_nom(a,e)});"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Post Nom","Click",""]);$("#context_overlay_cont > div").html("");"gallery"==view_active&&add_photo_nominated(selected_photo.id,a)}});$("#post_photos_nomination").live("click",
function(){var a=!0;if(0<$("#selected_noms > div").length&&!$(this).hasClass("sick_hover_lock")){push_nom(current_photo_id);$(this).text("Saving...");$(this).addClass("sick_hover_lock");for(var b in selected_photo_noms)if(""!=b&&void 0!=b){tut_on&&update_tut("nom");var e=selected_photo_noms[b].caption;if("Add a caption to this nomination."==e||"Caption"==e)e="";$.post("/api/nominate_photo/",{access_token:fb_session.access_token,nominations:selected_photo_noms[b].selected_nominations,comment_text:e,
photo_id:b,owner:me.id,tags:selected_photo_noms[b].selected_tags},function(b){a&&(a=!1,render_share_nom(b,e))})}"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent","Post Upload Nom","Click",""]);$("#close_overlay").click()}});$("#close_nom_success").live("click",function(){mobile?($("#nom_complete_cont").hide(),$(".nom_complete_cat_cont").remove(),$("#nominate_photo, #go_nom_detail").show(),$("#forward_gallery, #back_gallery").show()):($("#nom_complete_cont").fadeOut("fast",function(){$(".nom_complete_cat_cont").remove()}),
$("#nominate_photo, #go_nom_detail").fadeIn("fast"),$("#forward_gallery, #back_gallery").fadeIn("fast"));$("#new_nomination_cont li").removeClass("selected").addClass("unselected");$(".inactive").removeClass("inactive");$("#active_nominations #active_empty").is(":hidden")&&$("#active_nominations #active_empty").show();$("#active_nominations_cont").html("");$("#nomination_comment").text("Add a caption to this nomination.")});$("#tag_search").live("focus",function(){var a=$("#tag_search_cont").position().top+
$("#new_nom_tagged_cont > div").scrollTop()-45;$("#new_nom_tagged_cont > div").scrollTop(a);$("#mutual_friends_cont").css({"min-height":123});if(this.value==this.defaultValue)this.value="";this.value!=this.defaultValue&&this.select();setTimeout(function(){$("#tag_search").select()},300)});$("#tag_search").live("blur",function(){if(""==$.trim(this.value))this.value=this.defaultValue?this.defaultValue:""});$("#tag_search").live("keyup",function(){var a=$(this).val(),b,e,f,g;if(""==a){$("#mutual_friends_cont").html("");
for(g=0;g<mutual_friends_list.length;g++)$("#mutual_friends_cont").append('<div class="mutual_user" id="mutual_'+mutual_friends_list[g].fid+'" value="'+mutual_friends_list[g].fid+'"><img src="https://graph.facebook.com/'+mutual_friends_list[g].fid+'/picture?type=square"/><p>'+mutual_friends_list[g].name+"</p><span>"+mutual_friends_list[g].username+'</span><div class="clear"></div></div>')}else{e=mutual_friends_list.length;b=[];a=a.toLowerCase();for(g=0;g<e;g++)f=mutual_friends_list[g],(0===f.name.toLowerCase().indexOf(a)||
0===f.username.toLowerCase().indexOf(a))&&b.push(f);$("#mutual_friends_cont").html("");if(0<b.length)for(g=0;g<b.length;g++)$("#mutual_friends_cont").append('<div class="mutual_user" id="mutual_'+b[g].fid+'" value="'+b[g].fid+'"><img src="https://graph.facebook.com/'+b[g].fid+'/picture?type=square"/><p>'+b[g].name+"</p><span>"+b[g].username+'</span><div class="clear"></div></div>')}});$(".mutual_user").live("click",function(){if($(this).hasClass("selected")){$(this).removeClass("selected");$(this).find(".checked").remove();
var a=$(this).attr("value");$("#tagged_"+a).remove();for(var b=0;b<mutual_friends_list.length;b++)if(a==mutual_friends_list[b].fid)mutual_friends_list[b].active=void 0}else{$(this).addClass("selected");$(this).find("p").after('<div class="checked"></div>');for(var a=$(this).attr("value"),e=null,b=0;b<mutual_friends_list.length;b++)if(a==mutual_friends_list[b].fid){e=mutual_friends_list[b];e.active=!0;break}$("#tagged_friends_cont").append('<div id="tagged_'+a+'" class="tagged_user" name="'+e.username+
'"><img src="https://graph.facebook.com/'+a+'/picture?type=square"/></div>')}});$(".tagged_user").live("mouseover mouseout",function(a){"mouseover"==a.type?show_tooltip(this):hide_tooltip(this)});$(".tagged_user").live("click",function(){if(!1==$(this).hasClass("nominatee_user")){var a=$(this).attr("id").replace("tagged_","");$(this).remove();$("#mutual_"+a).removeClass("selected").find(".checked").remove();$("#tagged_friends_cont .tooltip").css("opacity",0)}});$(".nom_photo_thumb_cont").live("click",
function(){var a=$(this).attr("value"),b=$(this).position().left,e=$(this).width();$("#selected_photo_triangle").css("left",b+e/2-37);b=$(this).find("img").attr("src").replace("_130","_720");$("#selected_img").attr("src",b);push_nom(current_photo_id);restore_nom(a);current_photo_id=a});$(".community_photo_cont > img").live("click",function(){var a=$(this).attr("owner"),b=$(this).attr("pid");window.location.href="/#!/"+a+"/photos/"+b+"/"});$(".load_more_community_active").live("click",function(){var a=
$(this).attr("value");if(a)window.location.href="/#!/community/top/"+a.replace(" ","-")+"/"});$(".folow").live("click",function(){});$(".unfollow").live("click",function(){});$(".tagged_users").live("click",function(){var a=$(this).attr("nom");if(a=nom_cache[a]){for(var b='<div id="tagged_user_cont"><h1>Tagged</h1>',e="",f=0;f<a.tagged_users.length;f++)e=a.tagged_users[f].username,me&&a.tagged_users[f].user==me.id&&(e="You"),b+='<div class="tagged_user_wrap"><div class="tagged_user_border"><div class="tagged_user_img"><a href="/#!/'+
a.tagged_users[f].username+'/"><img src="https://graph.facebook.com/'+a.tagged_users[f].user+'/picture?type=large"/></a></div></div><a href="/#!/'+a.tagged_users[f].username+'/"><h3>'+e+"</h3></a></div>";b+='<div class="clear"></div></div>';$("#context_overlay_cont").addClass("tagged_user_overlay");$("#context_overlay_cont > div").append(b);show_context_overlay(!0,!0)}return!1});$(".flag_photo").live("click",function(){if(!1==$(this).hasClass("off")){var a=$(this).attr("pid"),b=$(this).attr("owner"),
e=$(this).attr("nom_id"),f=$(this).attr("thumb"),g=$(this).attr("fb_crop"),h=nom_cache[e];if(h)f=h.photo.thumbnail;e='<div id="flag_photo_selected_cont"><img src="'+f+'"/><div id="flag_photo_overlay"><p>Selected</p></div></div><div id="flag_cont"><div id="flag_heading"><h1>Photo Options</h1><p>Click one of the options below</p></div><div id="flag_options"><h2>Share photo</h2><div class="round_cont"><div class="round_cont_option share" value="facebook" style="border-bottom: 1px solid #bebebe;"><img src="http://portrit.s3.amazonaws.com/img/f_logo.png"/><h3>Facebook</h3><p class="strong">Share this photo on Facebook.</p><div class="clear"></div></div><div id="share_facebook_cont" class="share_cont" style="display:none; border-bottom: 1px solid #bebebe;"><textarea class="share_caption inactive" id="facebook_caption">Caption</textarea><p class="caption_limit">0/140</p><span class="sick post_share" value="facebook">Post</span><span class="sick cancel_share">Cancel</span><div class="clear"></div></div><div class="round_cont_option share" value="twitter"><img src="http://portrit.s3.amazonaws.com/img/twitter_logo.png"/><h3>Twitter</h3><p class="strong">Share this photo on Twitter.</p><div class="clear"></div></div><div id="share_twitter_cont" class="share_cont" style="display:none; border-top: 1px solid #bebebe;"><textarea class="share_caption inactive" id="twitter_caption">Caption</textarea><p class="caption_limit">0/140</p><span class="sick post_share" value="twitter">Post</span><span class="sick cancel_share">Cancel</span><div class="clear"></div></div></div><h2>Flag photo</h2><div class="round_cont"><div class="round_cont_option" value="flag"><p>Please only flag photos that break the Portrit Terms of Service. Such as pornography, violence, spam, etc.</p></div><div id="flag_photo_confirmation" class="share_cont" style="display:none; border-top: 1px solid #bebebe;"><h2 style="text-align: center; margin-bottom: 10px;">Are you sure?</h2><span class="sick cancel_share" style="float:left; margin-left: 0px">No</span><span class="sick post_share" value="flag">Yes</span><div class="clear"></div></div></div><div class="clear"></div></div><div class="clear"></div></div>';
$("#context_overlay_cont").addClass("flag_photo_overlay");$("#context_overlay_cont > div").append(e);show_context_overlay(!0,!0);$("#close_overlay").bind("click",function(){$("#close_overlay").unbind("click");$("#cancel_flag").unbind("click");$(".round_cont_option").unbind("click");$(".share_caption").unbind("keydown");$(".share_caption").unbind("keyup");$(".share_caption").unbind("blur");$(".share_caption").unbind("focus");$(".cancel_share").die("click");$(".post_share").die("click")});$(".round_cont_option").unbind("click");
$(".round_cont_option").bind("click",function(){var a=$(this).attr("value");"flag"==a?$(this).hasClass("selected")?($(this).removeClass("selected"),$("#flag_photo_confirmation").slideUp("fast")):($(this).addClass("selected"),$("#flag_photo_confirmation").slideDown("fast")):"portrit"!=a&&("facebook"==a?$(this).hasClass("selected")?($(this).removeClass("selected"),$("#share_facebook_cont").slideUp("fast"),$("#share_facebook_cont textarea").val("Caption").removeClass("inputed").addClass("inactive"),
$("#share_facebook_cont .caption_limit").text("0/140")):($(this).addClass("selected"),$("#share_facebook_cont").slideDown("fast"),$("#facebook_caption").focus()):"twitter"==a&&($(this).hasClass("selected")?($(this).removeClass("selected"),$("#share_twitter_cont").slideUp("fast"),$("#share_twitter_cont textarea").val("Caption").removeClass("inputed").addClass("inactive"),$("#share_twitter_cont .caption_limit").text("0/140")):(twitter_access_token||send_twitter_auth_request(),$(this).addClass("selected"),
$("#share_twitter_cont").slideDown("fast"),$("#twitter_caption").focus())))});$(".cancel_share").die("click");$(".cancel_share").live("click",function(){$(this).parent().prev().click()});$(".post_share").die("click");$(".post_share").live("click",function(){var e="",f="",i="",e=$(this).attr("value");h?(f=HOST+"#!/nomination/"+h.id+"/",i=h.photo.crop_small):(f=HOST+"#!/"+b+"/photos/"+a+"/",i=g);if("twitter"==e)e=$("#twitter_caption").val(),"Caption"==e&&(e=""),share_on_twitter(e,f);else if("facebook"==
e){e=$("#facebook_caption").val();"Caption"==e&&(e="");var o="",o=h?me.name.split(" ")[0]+" shared a nomination on Portrit":me.name.split(" ")[0]+" shared a photo on Portrit";share_on_facebook(o,e,f,i)}else if("flag"==e){if(h)a=h.photo.id;$.post("/api/flag/photo",{access_token:fb_session.access_token,photo_id:a},function(){})}$(this).parent().prev().click()});$(".share_caption").unbind("focus");$(".share_caption").bind("focus",function(){$(this).removeClass().addClass("inputed");if("Caption"==this.value)this.value=
"";"Caption"!=this.value&&this.select()});$(".share_caption").unbind("blur");$(".share_caption").bind("blur",function(){if(""==$.trim(this.value))$(this).removeClass().addClass("inactive"),this.value="Caption"});$(".share_caption").unbind("keydown");$(".share_caption").bind("keyup",function(){var a=$(this).val().length;$(this).parent().find(".caption_limit").text(a+"/140")});$(".share_caption").unbind("keydown");$(".share_caption").bind("keydown",function(a){var b=$(this).val().length;$(this).parent().find(".caption_limit").text(b+
"/140");if(140<=b&&8!=a.keyCode)return!1})}});$(".follow").live("click",function(a){a.stopPropagation();var a=$(this).attr("value"),b=$(this).attr("target");"follow"==a?$(this).removeClass("green").addClass("red").attr("value","unfollow").text("Unfollow"):$(this).removeClass("red").addClass("green").attr("value","follow").text("Follow");$.post("/api/follow_unfollow_user/",{access_token:fb_session.access_token,target:b,method:a},function(){});return!1});$(".top_user_cont, .top_friend").live("click",
function(){var a=$(this).attr("value");if(a)window.location.href="/#!/"+a+"/"});$("#sharing_twitter").live("click",function(){$(this).hasClass("switch_on")?send_twitter_auth_request():deauth_twitter()});$(".share_service .switch").live("click",function(){"twitter"==$(this).attr("name")&&(twitter_access_token||send_twitter_auth_request())});$(window).bind("scroll",function(){var a=$(window).scrollTop(),b=$(window).height(),e=$(document).height();a>=e-b-200&&!1==scroll_loading&&("stream_active"==view_active?
(a=$(".community_active_cont:last"),!1==$(a).hasClass("end")&&10<=$(".community_active_cont").length&&($(a).addClass("end"),(a=$(a).attr("id"))&&get_more_stream_active(a))):"stream_photos"==view_active?(a=$(".community_photo_cont:last"),!1==$(a).hasClass("end")&&15<=$(".community_photo_cont").length&&($(a).addClass("end"),(a=$(a).attr("pid"))&&get_more_stream_photos(a))):"stream_winners"==view_active?(a=$(".community_active_cont:last"),!1==$(a).hasClass("end")&&10<=$(".community_active_cont").length&&
($(a).addClass("end"),(a=$(a).attr("id"))&&get_more_stream_winners(a))):"community_photos"==view_active?(a=$(".community_photo_cont:last"),!1==$(a).hasClass("end")&&21<=$(".community_photo_cont").length&&($(a).addClass("end"),(a=$(a).attr("pid"))&&get_more_community_photos(a))):"community_active"==view_active?(a=$(".community_active_cont:last"),!1==$(a).hasClass("end")&&10<=$(".community_active_cont").length&&($(a).addClass("end"),(a=$(a).attr("id"))&&get_more_community_active(a))):"profile_photos"==
view_active&&(a=$(".user_photo_wrap:last"),!1==$(a).hasClass("end")&&($(a).addClass("end"),(a=$(a).attr("pid"))&&get_more_profile_photos(a))));if("profile_active"==view_active)try{$(".recent_nom_cont:first").position()}catch(f){}})}function send_twitter_auth_request(){window.open("/api/auth_twitter?access_token="+fb_session.access_token,"TwitterAuth","width=800,height=677")}function catch_twitter_access_token(a){twitter_access_token=a}
function deauth_twitter(){$.post("/api/deauth_twitter/",{access_token:fb_session.access_token},function(){twitter_access_token=null})}var selected_photo_noms={};
function push_nom(a){var b="",c="";$("#selected_noms > div > h3").each(function(){b+=$(this).text()+","});$(".tagged_user").each(function(){!1==$(this).hasClass("nominatee_user")&&(c=$(this).attr("id").replace("tagged_","")+",")});selected_photo_noms[a]={selected_nominations:b,selected_tags:c,photo_id:a,caption:$("#nom_caption").val()};$(".tagged_user").remove();$("#mutual_friends_cont .selected").removeClass("selected").find(".checked").remove();$("#selected_noms").html("");$("#nom_caption").val("");
$("#inactive_trophy_cont li").removeClass().addClass("active")}
function restore_nom(a){if(selected_photo_noms[a]){for(var b=selected_photo_noms[a].selected_nominations.split(","),c=selected_photo_noms[a].selected_tags.split(","),d="",e="",e="",f=0;f<b.length;f++)""!=b[f]&&(d=b[f].replace(" ","_").toLowerCase(),e=$("#"+d+"_cont").html(),e='<div id="'+d+'">'+e+'<span class="kill_nomination close_img '+close_size+'"></span></div>',$("#selected_noms").append(e),$("#"+d+"_cont").removeClass().addClass("selected")),3==f&&$("#inactive_trophy_cont li").removeClass("active").addClass("inactive");
1>=f&&$("#selected_noms").append("<h4>No nominations selected.</h4>");$("#tagged_friends_cont").append('<div class="tagged_user nominatee_user" name="Nominee"><img src="https://graph.facebook.com/'+me.id+'/picture?type=square"></div>');for(f=0;f<mutual_friends_list.length;f++)mutual_friends_list[f].active=void 0;for(f=0;f<c.length;f++){""!=c[f]&&($("#tagged_friends_cont").append('<div id="tagged_'+c[f]+'" class="tagged_user" name="'+friends[c[f]].username+'"><img src="https://graph.facebook.com/'+
c[f]+'/picture?type=square"></div>'),$("#mutual_"+c[f]).addClass("selected").find("p").after('<div class="checked"></div>'));for(f=0;f<mutual_friends_list.length;f++)if(c[f]==mutual_friends_list[f].fid)mutual_friends_list[f].active=!0}""!=selected_photo_noms[a].caption&&void 0!=selected_photo_noms[a].caption?"Add a caption to this nomination."==selected_photo_noms[a].caption?($("#nom_caption").val("Add a caption to this nomination."),$("#text_remail_cont").text("0/90")):($("#nom_caption").val(selected_photo_noms[a].caption),
$("#text_remail_cont").text(selected_photo_noms[a].caption.length+"/90")):($("#nom_caption").val("Add a caption to this nomination."),$("#text_remail_cont").text("0/90"));$("#selected_noms > div").css("opacity",1)}else $("#tagged_friends_cont").append('<div class="tagged_user nominatee_user" name="Nominee"><img src="https://graph.facebook.com/'+me.id+'/picture?type=square"></div>'),$("#nom_caption").val("Add a caption to this nomination."),$("#text_remail_cont").text("0/90")}
$(".switch").live("click",function(){"sharing_facebook"!=$(this).attr("value")&&($(this).hasClass("switch_on")?$(this).removeClass("switch_on").addClass("switch_off"):$(this).removeClass("switch_off").addClass("switch_on"))});var current_photo_id=null,mutual_friends_list=[];
function render_photo_upload_nom(a){var b=a[0],c=b.thumbnail.replace("_130","_720");current_photo_id=b.id;disable_search=!0;$("#context_overlay_cont").addClass("nominate_photo");$("#context_overlay_cont > div").append(nominate_photo_html);if(1<a.length){for(var d="",e=0;e<a.length;e++)d+='<div class="nom_photo_thumb_cont" value="'+a[e].id+'"><img src="'+a[e].thumbnail+'"/></div>';$("#new_nom_middle_cont").after('<div id="new_nom_photo_stream_cont">'+d+"</div>")}$("#selected_img").attr("src",c).attr("value",
b.id);$("#selected_photo_triangle").css("left",40);show_context_overlay(!0,!0);$("#tagged_friends_cont").append('<div class="tagged_user nominatee_user" name="Nominee"><img src="https://graph.facebook.com/'+me.id+'/picture?type=square"/></div>');mutual_friends_list=[];$.getJSON("/api/get_follow_data/",{access_token:fb_session.access_token,mutual:!0,target:me.id,all:!0,method:"following"},function(a){for(var b=null,c=0;c<a.data.length;c++)b=a.data[c],mutual_friends_list.push({fid:b.fid,name:b.name,
username:b.username});for(c=0;c<mutual_friends_list.length;c++)$("#mutual_friends_cont").append('<div class="mutual_user" id="mutual_'+mutual_friends_list[c].fid+'" value="'+mutual_friends_list[c].fid+'"><img src="https://graph.facebook.com/'+mutual_friends_list[c].fid+'/picture?type=square"/><p>'+mutual_friends_list[c].name+"</p><span>"+mutual_friends_list[c].username+'</span><div class="clear"></div></div>')})}
function update_nom_detail(a){$("#main_nom_photo").attr("src",a.photo.source);$("#nom_vote_count").text(a.vote_count);$(".comment").remove();$("#nom_votes_wrap a").remove();$(".vote").attr("value",a.id);$("#main_nom_cont").attr("value",a.id);var b="",c="",d="",b=me&&a.nominatee==me.id?a.won?"You":"You're":a.nominatee_username,c=a.caption?"Caption: "+a.caption:"No caption provided",d="";0<a.tagged_users.length&&(d='<div class="tagged_users" nom="'+a.id+'"><span>'+a.tagged_users.length+' Tagged</span><div class="tag"></div></div>');
$(".tagged_users").remove();$("#nominator_overlay_cont").append(d);d=a.nomination_category.replace(" ","_").toLowerCase();$("#vote_cont_left").removeClass().addClass("nom_cat_"+d);a.won?$("#vote_cont_left").addClass("won"):$("#vote_cont_left").addClass("active");var e="";now=new Date;time=new Date(1E3*a.created_time);e=(now-time)/1E3;$("#main_nom_photo_post_time").html(secondsToHms(e));$("#nomination_text_cont h3").text(a.nomination_category);!mobile||tablet?$("#nom_trophy_icon").removeClass().addClass("trophy_img large "+
d):$("#nom_trophy_icon").removeClass().addClass("trophy_img medium "+d);$("#nominator_overlay_cont p").text(c);$("#nominatee_cont .user_img").attr("src","https://graph.facebook.com/"+a.nominatee+"/picture?type=square");$("#nominatee_cont a").attr("href","/#!/"+a.nominatee_username+"/");$("#nomination_text_cont span").text(b);$(".post_new_comment").attr("value",a.id);$(".flag_photo").attr("pid",a.photo.id);$(".flag_photo").attr("thumb",a.photo.crop);$("#nom_place").text(getGetOrdinal(a.position+1));
b="";b=a.won?"Won":"Nominated for";$("#nomination_text_cont p").text(b);get_nom_comments(a.id);render_nom_votes(a,a.votes)}
function render_more_nom_detail(a,b){if(0<a.length){create_nom_cache(a);for(var c=null,d="",e=0;e<a.length;e++)c=a[e],d+='<div id="nom_photo_'+c.id+'" class="nom_photo_thumbnail" style="opacity: 0.6; display:none;"><img src="'+c.photo.crop_small+'"/></div>';"up"==b?$("#nom_cat_stream").append(d):$("#nom_cat_stream .next_photo").after(d);slide_images=$(".nom_photo_thumbnail");var f=[],g=0,h=0,j=!1,c=$("#nom_cat_stream").width()/2;$(slide_images).each(function(){h=100;"selected"===$(this).attr("name")?
(g+=h/2,j=!0):!1===j&&(g+=h+20);f.push(h+20)});var k=0,i=c-g;$(slide_images).each(function(a){$(this).css({left:k+i,top:0});k+=f[a]});$(".nom_photo_thumbnail").show()}else"up"==b?$(".nom_photo_thumbnail:last").attr("end",!0):$(".nom_photo_thumbnail:first").attr("end",!0)}
function load_more_noms(a,b,c,d){if("stream_active"==a)$.getJSON("/api/get_nom_detail/",{source:selected_user.username,nav_selected:a,cat:b,dir:c,pos:d},function(a){render_more_nom_detail(a,c)});else if("stream_winners"==a)$.getJSON("/api/get_nom_detail/",{source:selected_user.username,nav_selected:a,cat:b,dir:c,pos:d},function(a){render_more_nom_detail(a,c)});else if("community_active"==a)$.getJSON("/api/get_nom_detail/",{nav_selected:a,cat:b,dir:c,pos:d},function(a){render_more_nom_detail(a,c)});
else if("community_top"==a)$.getJSON("/api/get_nom_detail/",{nav_selected:a,cat:b,dir:c,pos:d},function(a){render_more_nom_detail(a,c)});else if("profile_trophies"==a){var e=getUrlVars();e[2]&&"all"==e[2]&&(b="all");$.getJSON("/api/get_nom_detail/",{source:selected_user.username,nav_selected:a,cat:b,dir:c,pos:d},function(a){render_more_nom_detail(a,c)})}}
function check_detail_pagination(a,b,c,d){var c=c-b+d,d=d-b,e=0,f=null,g=$("#nom_detail_cont .title").attr("state"),h=$("#nom_detail_cont .title").attr("cat");9<=c&&b>a&&b+3>=c&&void 0==$(".nom_photo_thumbnail:last").attr("end")?(f="up",e=c+1):b<a&&b-3<=d&&0<d&&(f="down",e=d);f&&load_more_noms(g,h,f,e)}
function attach_nom_detail_handlers(){$(".nom_photo_thumbnail").live("click",function(){var a=$(this).attr("id").replace("nom_photo_",""),a=nom_cache[a],b=$(".nom_photo_thumbnail").index($('.nom_photo_thumbnail[name="selected"]')),c=$(".nom_photo_thumbnail").index(this),d=$(".nom_photo_thumbnail").length-1;check_detail_pagination(b,c,d,a.position);var b=$(".nom_photo_thumbnail"),e=[],f=0,g=0,h=!1,c=$("#nom_cat_stream").width()/2;$('.nom_photo_thumbnail[name="selected"]').css({opacity:"0.6"}).attr("name",
"");$(this).css({opacity:"1.0"}).attr("name","selected");$(b).each(function(){g=$(this).width();"selected"===$(this).attr("name")?(f+=g/2,h=!0):!1===h&&(f+=g+20);e.push(g+20)});var j=0,k=c-f;$(b).each(function(a){$(this).css({left:j+k,top:0});j+=e[a]});update_nom_detail(a)});$(".won").live("mouseover mouseout",function(a){"mouseover"==a.type?show_tooltip(this):hide_tooltip(this)});$("#nom_votes_cont a").live("mouseover mouseout",function(a){"mouseover"==a.type?show_tooltip(this):hide_tooltip(this)});
$("#add_new_comment").live("click",function(){if(!1==$(this).hasClass("off")){var a=$(this).parent().parent().find("#new_comment_cont");disable_search=!0;$(this).addClass("off");$(a).show();$(".comment_body").focus()}});$(".vote_up").live("click",vote_up_handler);$(".vote_down").live("click",vote_down_handler);$(".next_photo").live("click",function(){var a=$("#nom_cat_stream").children().filter('[name="selected"]');$(a).next().click()});$(".prev_photo").live("click",function(){var a=$("#nom_cat_stream").children().filter('[name="selected"]');
2!=$(a).index()&&$(a).prev().click()})}var nominate_photo_html='<div id="new_nom_wrap"><div id="new_nom_top_cont"><h1>Nominate Photo For A Trophy</h1><div id="inactive_trophy_cont"><ul><li class="active" id="hot_cont"><div class="trophy_img medium hot"></div><h3 class="nom_cat_hot_text">Hot</h3></li><li class="active" id="lol_cont"><div class="trophy_img medium lol"></div><h3 class="nom_cat_lol_text">LOL</h3></li><li class="active" id="artsy_cont"><div class="trophy_img medium artsy"></div><h3 class="nom_cat_artsy_text">Artsy</h3></li><li class="active" id="fail_cont"><div class="trophy_img medium fail"></div><h3 class="nom_cat_fail_text">Fail</h3></li><li class="active" id="party_animal_cont"><div class="trophy_img medium party_animal"></div><h3 class="nom_cat_party_animal_text">Party Animal</h3></li><li class="active" id="cute_cont"><div class="trophy_img medium cute"></div><h3 class="nom_cat_cute_text">Cute</h3></li><li class="active" id="wtf_cont"><div class="trophy_img medium wtf"></div><h3 class="nom_cat_wtf_text">WTF</h3></li><li class="active" id="creepy_cont"><div class="trophy_img medium creepy"></div><h3 class="nom_cat_creepy_text">Creepy</h3></li><li class="active" id="awesome_cont"><div class="trophy_img medium awesome"></div><h3 class="nom_cat_awesome_text">Awesome</h3></li><li class="active" id="yummy_cont"><div class="trophy_img medium yummy"></div><h3 class="nom_cat_yummy_text">Yummy</h3></li></ul></div></div><div id="new_nom_middle_cont"><div id="selected_nom_image_cont"><div><p>Selected Photo</p><img id="selected_img"/></div></div><div id="selected_nom_cont"><h2>Selected Nomination</h2><div id="selected_noms"><h4>No nominations selected.</h4></div></div><div id="new_nom_tagged_cont"><h2 id="tagg_cont_header">Tag Friends</h2><div><div id="tagged_friends_cont"><p class="tooltip"></p></div><div id="tag_search_cont"><input type="text" id="tag_search" value="Search"/></div><div id="mutual_friends_cont"></div></div></div><div class="clear"></div></div><div id="new_nom_bottom_cont"><div id="selected_photo_triangle"></div><textarea id="nom_caption">Add a caption to this nomination.</textarea><div id="text_remail_cont"><p>0/90</p></div><div id="nom_controls_cont"><a id="cancel_nom" class="sick large">Cancel</a><a id="post_nomination" class="sick large">Post Nomination</a></div><div class="clear"></div></div></div>';
function raise_404(){if("profile_active"==view_active||"profile_trophies"==view_active||"profile_settings"==view_active||"profile_following"==view_active||"profile_followers"==view_active)$("#profile_nav_cont").fadeOut("fast"),$("#profile_stats_cont").fadeOut("fast"),$("#profile_user_header").append('<div id="not_found_header" style="display:none;"><img style="height: 113px; width: 113px;" src="http://portrit.s3.amazonaws.com/img/404_bear.png"/><h1>We\'re sorry...</h1></div>'),$("#profile_user_context").append('<div id="not_found_cont" style="display:none;"><div id="not_found_message"><h2>We can\'t find the page you are looking for. Try returning back to the <strong><a href="/#!/">homepage</a></strong></h2></div></div>'),
setTimeout(function(){$("#not_found_header").fadeIn();$("#not_found_cont").fadeIn()},150);else if("community_top_detail"==view_active||"community_active_detail"==view_active||"stream_winners_detail"==view_active||"stream_active_detail"==view_active||"nom_detail"==view_active||"profile_trophies_detail"==view_active||"profile_active_detail"==view_active){$("#main_nom_photo").remove();var a;$("#main_nom_cont_left_wrap").append('<div id="not_found_header"><img style="height: 113px; width: 113px;" src="http://portrit.s3.amazonaws.com/img/404_bear.png"/><h1>We\'re sorry...</h1></div><div id="not_found_cont"><div id="not_found_message"><h2>We can\'t find the page you are looking for. Try returning back to the <strong><a href="/#!/">homepage</a></strong></h2></div></div>')}else"gallery"==
view_active&&$("#gallery_photo_center").append('<div id="not_found_header"><img style="height: 113px; width: 113px;" src="http://portrit.s3.amazonaws.com/img/404_bear.png"/><h1>We\'re sorry...</h1></div><div id="not_found_cont"><div id="not_found_message"><h2>We can\'t find the page you are looking for. Try returning back to the <strong><a href="/#!/">homepage</a></strong></h2></div></div>')}
function render_share_nom(a,b){var c="inputed";b||(b="Caption",c="inactive");c='<div id="share_nom_cont" nom="'+a[0].id+'" crop="'+a[0].photo.crop_small+'"><h1 style="font-size: 30px;">Share your nomination</h1><textarea class="'+c+'" id="share_nom_comment" value="Caption"/></textarea><p id="text_remail_cont">0/140</p><div id="share_bottom_cont"><div id="share_left_cont"><h1>Sharing Options</h1><p>Share your nomination on Facebook or Twitter.</p></div><div id="share_options_cont"><div class="share_service"><img src="http://portrit.s3.amazonaws.com/img/f_logo.png"/><h1>Facebook</h1><div id="share_facebook" class="switch switch_off" value="on" name="facebook"></div><div class="clear"></div></div><div id="share_mid"></div><div class="share_service"><img src="http://portrit.s3.amazonaws.com/img/twitter_logo.png"/><h1>Twitter</h1><div id="share_twitter" class="switch switch_off" value="on" name="twitter"></div><div class="clear"></div></div></div><div class="clear"></div></div><div id="share_controls_cont"><span class="sick large" id="post_share">Share</span><span class="sick large" id="cancel_share">Cancel</span><div class="clear"></div></div></div>';
$("#context_overlay_cont").removeClass().addClass("share_nom");$("#context_overlay_cont > div").append(c);$("#share_nom_comment").attr("value",b);show_context_overlay(!0,!0);attach_nom_share_handlers()}function share_on_facebook(a,b,c,d){$.post("/api/shorten_url/",{url:c},function(e){c=e.url;FB.api("/me/feed","post",{message:b,caption:b,link:c,picture:d,name:a},function(){})})}
function share_on_twitter(a,b){$.post("/api/share_twitter/",{access_token:fb_session.access_token,status:a,url:b},function(){})}
function attach_nom_share_handlers(){$("#cancel_share").bind("click",function(){close_context_overlay();$("#cancel_share").unbind("click");$("#post_share").unbind("click")});$("#post_share").bind("click",function(){var a=$("#share_nom_comment").val(),b=$("#share_nom_cont").attr("nom"),c=$("#share_nom_cont").attr("crop"),b=HOST+"#!/nomination/"+b+"/";140<a.length&&(a=a.splice(0,136)+"...");if($("#share_facebook").hasClass("switch_on")){var d=me.name.split(" ")[0]+" nominated a photo on Portrit";share_on_facebook(d,
a,b,c)}$("#share_twitter").hasClass("switch_on")&&share_on_twitter(a,b);$("#cancel_share").click()})}
function reset_nomination_overlay(){$("#new_nomination_cont li").removeClass("selected").addClass("unselected");$(".inactive").removeClass("inactive");$("#active_nominations #active_empty").is(":hidden")&&$("#active_nominations #active_empty").show();$("#active_nominations_cont").html("");$("#nomination_comment").text("Add a caption to this nomination.");$("#nom_complete_cont").hide();$("#nom_complete_cont .nom_complete_cat_cont").remove();$("#post_nomination").text("Post Nomination").removeClass("sick_hover_lock");
$("#tagged_users").hide();$("#tagged_users > div").html("")}
function append_profile_html(a){var b=getUrlVars().user,c="";"me"===b?c=me.name:void 0==friends[b]?($("#user_photo_view").remove(),FB.api("/"+b+"/",function(a){c=a.name;$("#title > h3").text(c)})):c=friends[b].name;album_html='<div id="album_wrap"><div id="album_cont"><div id="user_profile_left_cont"><h2>Profile</h2><img id="large_profile_img" src="http://graph.facebook.com/'+b+'/picture?type=large"/><div id="user_profile_trophy_cont"><h3>Trophies</h3><div></div></div><div id="user_profile_follow_cont"></div></div><div id="user_profile_right_cont"><ul><li id="first_profile_nav" class="stream_nav" name="photos"><h3>Photos</h3></li><li class="stream_nav selected" name="stream"><h3>Nominations</h3></li><div class="clear"></div></ul><div id="active_cont" class="stream"></div></div><div class="clear"></div></div></div>';$("#title").html("<h3>"+
c+"</h3>").attr("value",selected_user).show();$("#friend_album_cont").prepend(album_html);$("#friend_album_cont").show();"photos"==a?(view_active="album",profile_albums_view()):"stream"==a&&(view_active="album",get_user_noms())}
function append_wall_html(){var a="";0==$("#profile_wrap").length&&(mobile||(a='<li id="show_upload"><h1>Post Photo</h1></li>'),a=public_view?'<div id="profile_wrap"><ul><li><h1 id="activate_community" class="stream_nav" name="community">Community</h1></li><div class="clear"></div></ul><div class="clear"></div><div id="profile_cont_wrap"></div></div>':'<div id="profile_wrap"><ul><li><h1 id="active_stream_view" class="stream_nav" name="stream">Stream</h1></li><li><h1 id="activate_community" class="stream_nav" name="community">Community</h1></li><li><h1 id="activate_profile" class="stream_nav" name="profile">Profile</h1></li>'+
a+'<div class="clear"></div></ul><div class="clear"></div><div id="profile_cont_wrap"></div></div>',$("#wall_cont").append(a),(!mobile||tablet)&&render_countdown_clock())}
function clear_event_handles(){mobile?$("#profile_stats_cont > div").die("touchend"):$("#profile_stats_cont > div").die("click");$(".user_photo_wrap a").die("click");$(".follow_wrap").die("click");$(".user_photo_wrap").die("mouseover mouseout");$(".follow_wrap").die("mouseover mouseout");$("#gallery_next").die("click");$("#gallery_prev").die("click");$("#gallery_prev_cont").die("click");$("#gallery_next_cont").die("click");$("#nominate").die("click");$(".nom_photo_thumbnail").die("click");$(".won").die("mouseover mouseout");
$("#nom_votes_cont a").die("mouseover mouseout");$("#add_new_comment").die("click");$(".vote_up").die("click",vote_up_handler);$(".vote_down").die("click",vote_down_handler);$(".next_photo").die("click");$(".prev_photo").die("click");$(".top_cat_photo").die("mouseover mouseout")}scroll_pos_stack=[];function push_scroll_pos(){var a=getScrollXY();scroll_pos_stack.push({view:view_active,pos:a[1]})}
function pop_scroll_pos(){var a=scroll_pos_stack.splice(scroll_pos_stack.length-2,1)[0].pos;setTimeout(function(){$("html, body").scrollTop(a)},200)}var view_count=0,prev_view="";attach_main_handlers();
function update_view(){var a=getUrlVars();prev_view=view_active;push_scroll_pos();view_count+=1;view_active="";$("#context_overlay").is(":visible")&&1<view_count&&$("#close_overlay").click();1==view_count&&(render_notifications(notification_data),winning_notification_data&&0<winning_notification_data.length&&render_share_wins(winning_notification_data));clear_event_handles();0<a.length?"photos"==a[0]?("stream"!=stream_view&&$("#profile_cont_wrap").html(""),0==$("#profile_cont_wrap").children().length?
(append_wall_html(),view_active="stream_photos",init_stream_view("photos")):view_active="stream_photos",init_stream_photos()):"winners"==a[0]?("stream"!=stream_view&&$("#profile_cont_wrap").html(""),1<a.length?(selected_user={username:me.username,fid:me.id,name:me.name},0==$("#profile_cont_wrap").children().length&&append_wall_html(),view_active="stream_winners_detail",init_nom_detail("stream_winners")):(view_active="stream_winners",0==$("#profile_cont_wrap").children().length&&append_wall_html(),
0==$("#profile_cont_wrap").children().length&&init_stream_view("winners"),init_stream_winners())):"stream"==a[0]?2<a.length?"nominations"==a[1]&&(append_wall_html(),selected_user={username:me.username,fid:me.id,name:me.name},view_active="stream_active_detail",init_nom_detail("stream_active",a[2])):raise_404():"community"==a[0]?(0==$("#profile_cont_wrap").children().length?append_wall_html():"community"!=stream_view&&$("#profile_cont_wrap").html(""),1<a.length?"photos"==a[1]?(view_active="community_photos",
init_community_view("photos"),init_community_photos(),$(".sub_stream_nav").removeClass("selected"),$("#community_photos").addClass("selected")):"top"==a[1]?2<a.length?3<a.length?(view_active="community_top_detail",init_nom_detail("community_top",a[2])):(view_active="community_top_cat",init_community_view("top"),init_community_top_cat(),$(".sub_stream_nav").removeClass("selected"),$("#community_top").addClass("selected")):(view_active="community_top",init_community_view("top"),init_community_top(),
$(".sub_stream_nav").removeClass("selected"),$("#community_top").addClass("selected")):2<a.length?(view_active="community_active_detail",selected_nom||(selected_nom=a[2]),init_nom_detail("community_active")):raise_404():(view_active="community_active",init_community_view("active"),init_community_active(),$(".sub_stream_nav").removeClass("selected"),$("#community_active").addClass("selected"))):"nomination"==a[0]?1<a.length?(view_active="nom_detail",append_wall_html(),selected_nom=a[1],init_nom_detail()):
raise_404():(0==$("#profile_cont_wrap").children().length?(selected_user={username:a[0],fid:null,name:null},append_wall_html()):"profile"!=stream_view&&"profile_user"!=stream_view?(selected_user={username:a[0],fid:null,name:null},$("#profile_cont_wrap").html("")):a[0]!=selected_user.username&&(selected_user={username:a[0],fid:null,name:null},$("#profile_cont_wrap").html("")),$(".follow_nav").removeClass("selected"),$("#gallery_cont").remove(),1<a.length?"trophies"==a[1]?2<a.length?(view_active="profile_trophies_detail",
init_nom_detail("profile_trophies",a[2])):(view_active="profile_trophies",init_profile_view("trophies"),$(".sub_stream_nav").removeClass("selected"),$("#profile_trophies").addClass("selected")):"active"==a[1]?2<a.length?(view_active="profile_active_detail",init_nom_detail("profile_active",a[2])):(view_active="profile_active",init_profile_view("active"),$(".sub_stream_nav").removeClass("selected"),$("#profile_active").addClass("selected")):"settings"==a[1]?(view_active="profile_settings",init_profile_view("settings"),
$(".sub_stream_nav").removeClass("selected"),$("#profile_settings").addClass("selected")):"following"==a[1]?(view_active="profile_following",init_profile_view("following"),$("#profile_following_count_cont").addClass("selected"),$(".sub_stream_nav").removeClass("selected")):"followers"==a[1]?(view_active="profile_followers",init_profile_view("followers"),$("#profile_followers_count_cont").addClass("selected"),$(".sub_stream_nav").removeClass("selected")):"photos"==a[1]?(view_active="gallery",2<a.length?
init_gallery_view(a[2]):init_gallery_view()):raise_404():2<a.length?raise_404():"about"==a[0]?info_context_delagate("about"):"contact"==a[0]?info_context_delagate("contact"):"terms"==a[0]?info_context_delagate("terms"):"privacy"==a[0]?info_context_delagate("privacy"):"faq"==a[0]?info_context_delagate("faq"):"extensions"==a[0]?info_context_delagate("extensions"):(view_active="profile_photos",init_profile_view("photos"),$(".sub_stream_nav").removeClass("selected"),$("#profile_photos").addClass("selected"))):
public_view?window.location.href="/":(view_active="stream_active",0==$("#profile_cont_wrap").children().length?(append_wall_html("stream"),init_stream_view("active")):"stream"!=stream_view&&($("#profile_cont_wrap").html(""),init_stream_view("active")),init_stream_active());try{scroll_pos_stack[scroll_pos_stack.length-2].view==view_active&&pop_scroll_pos()}catch(b){}}function watch_hashtag(){var a=$(window.location).attr("hash");global_hash_tag!==a&&(global_hash_tag=a,setTimeout(update_view))};